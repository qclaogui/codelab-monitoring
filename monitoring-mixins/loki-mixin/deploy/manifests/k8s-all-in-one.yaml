apiVersion: v1
data:
  loki-chunks.json: |-
    {
          "annotations": {
             "list": [ ]
          },
          "editable": true,
          "gnetId": null,
          "graphTooltip": 0,
          "hideControls": false,
          "links": [
             {
                "asDropdown": true,
                "icon": "external link",
                "includeVars": true,
                "keepTime": true,
                "tags": [
                   "loki"
                ],
                "targetBlank": false,
                "title": "Loki Dashboards",
                "type": "dashboards"
             }
          ],
          "refresh": "10s",
          "rows": [
             {
                "collapse": false,
                "height": "250px",
                "panels": [
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [ ]
                      },
                      "id": 1,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 6,
                      "targets": [
                         {
                            "expr": "sum(loki_ingester_memory_chunks{cluster=\"$cluster\", job=~\"$namespace/ingester.*\"})",
                            "format": "time_series",
                            "legendFormat": "series",
                            "legendLink": null
                         }
                      ],
                      "title": "Series",
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [ ]
                      },
                      "id": 2,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 6,
                      "targets": [
                         {
                            "expr": "sum(loki_ingester_memory_chunks{cluster=\"$cluster\", job=~\"$namespace/ingester.*\"}) / sum(loki_ingester_memory_streams{cluster=\"$cluster\", job=~\"$namespace/ingester.*\"})",
                            "format": "time_series",
                            "legendFormat": "chunks",
                            "legendLink": null
                         }
                      ],
                      "title": "Chunks per series",
                      "type": "timeseries"
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "Active Series / Chunks",
                "titleSize": "h6"
             },
             {
                "collapse": false,
                "height": "250px",
                "panels": [
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "percentunit"
                         },
                         "overrides": [ ]
                      },
                      "id": 3,
                      "links": [ ],
                      "nullPointMode": "null as zero",
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 6,
                      "targets": [
                         {
                            "expr": "histogram_quantile(0.99, sum(rate(loki_ingester_chunk_utilization_bucket{cluster=\"$cluster\", job=~\"$namespace/ingester.*\"}[$__rate_interval])) by (le)) * 1",
                            "format": "time_series",
                            "legendFormat": "99th Percentile",
                            "refId": "A"
                         },
                         {
                            "expr": "histogram_quantile(0.50, sum(rate(loki_ingester_chunk_utilization_bucket{cluster=\"$cluster\", job=~\"$namespace/ingester.*\"}[$__rate_interval])) by (le)) * 1",
                            "format": "time_series",
                            "legendFormat": "50th Percentile",
                            "refId": "B"
                         },
                         {
                            "expr": "sum(rate(loki_ingester_chunk_utilization_sum{cluster=\"$cluster\", job=~\"$namespace/ingester.*\"}[$__rate_interval])) * 1 / sum(rate(loki_ingester_chunk_utilization_count{cluster=\"$cluster\", job=~\"$namespace/ingester.*\"}[$__rate_interval]))",
                            "format": "time_series",
                            "legendFormat": "Average",
                            "refId": "C"
                         }
                      ],
                      "title": "Utilization",
                      "type": "timeseries",
                      "yaxes": [
                         {
                            "format": "ms",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": 0,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": false
                         }
                      ]
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [ ]
                      },
                      "id": 4,
                      "links": [ ],
                      "nullPointMode": "null as zero",
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 6,
                      "targets": [
                         {
                            "expr": "histogram_quantile(0.99, sum(rate(loki_ingester_chunk_age_seconds_bucket{cluster=\"$cluster\", job=~\"$namespace/ingester.*\"}[$__rate_interval])) by (le)) * 1e3",
                            "format": "time_series",
                            "legendFormat": "99th Percentile",
                            "refId": "A"
                         },
                         {
                            "expr": "histogram_quantile(0.50, sum(rate(loki_ingester_chunk_age_seconds_bucket{cluster=\"$cluster\", job=~\"$namespace/ingester.*\"}[$__rate_interval])) by (le)) * 1e3",
                            "format": "time_series",
                            "legendFormat": "50th Percentile",
                            "refId": "B"
                         },
                         {
                            "expr": "sum(rate(loki_ingester_chunk_age_seconds_sum{cluster=\"$cluster\", job=~\"$namespace/ingester.*\"}[$__rate_interval])) * 1e3 / sum(rate(loki_ingester_chunk_age_seconds_count{cluster=\"$cluster\", job=~\"$namespace/ingester.*\"}[$__rate_interval]))",
                            "format": "time_series",
                            "legendFormat": "Average",
                            "refId": "C"
                         }
                      ],
                      "title": "Age",
                      "type": "timeseries",
                      "yaxes": [
                         {
                            "format": "ms",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": 0,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": false
                         }
                      ]
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "Flush Stats",
                "titleSize": "h6"
             },
             {
                "collapse": false,
                "height": "250px",
                "panels": [
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [ ]
                      },
                      "id": 5,
                      "links": [ ],
                      "nullPointMode": "null as zero",
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 6,
                      "targets": [
                         {
                            "expr": "histogram_quantile(0.99, sum(rate(loki_ingester_chunk_entries_bucket{cluster=\"$cluster\", job=~\"$namespace/ingester.*\"}[$__rate_interval])) by (le)) * 1",
                            "format": "time_series",
                            "legendFormat": "99th Percentile",
                            "refId": "A"
                         },
                         {
                            "expr": "histogram_quantile(0.50, sum(rate(loki_ingester_chunk_entries_bucket{cluster=\"$cluster\", job=~\"$namespace/ingester.*\"}[$__rate_interval])) by (le)) * 1",
                            "format": "time_series",
                            "legendFormat": "50th Percentile",
                            "refId": "B"
                         },
                         {
                            "expr": "sum(rate(loki_ingester_chunk_entries_sum{cluster=\"$cluster\", job=~\"$namespace/ingester.*\"}[$__rate_interval])) * 1 / sum(rate(loki_ingester_chunk_entries_count{cluster=\"$cluster\", job=~\"$namespace/ingester.*\"}[$__rate_interval]))",
                            "format": "time_series",
                            "legendFormat": "Average",
                            "refId": "C"
                         }
                      ],
                      "title": "Log Entries Per Chunk",
                      "type": "timeseries",
                      "yaxes": [
                         {
                            "format": "ms",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": 0,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": false
                         }
                      ]
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [ ]
                      },
                      "id": 6,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 6,
                      "targets": [
                         {
                            "expr": "sum(rate(loki_chunk_store_index_entries_per_chunk_sum{cluster=\"$cluster\", job=~\"$namespace/ingester.*\"}[$__rate_interval])) / sum(rate(loki_chunk_store_index_entries_per_chunk_count{cluster=\"$cluster\", job=~\"$namespace/ingester.*\"}[$__rate_interval]))",
                            "format": "time_series",
                            "legendFormat": "Index Entries",
                            "legendLink": null
                         }
                      ],
                      "title": "Index Entries Per Chunk",
                      "type": "timeseries"
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "Flush Stats",
                "titleSize": "h6"
             },
             {
                "collapse": false,
                "height": "250px",
                "panels": [
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [ ]
                      },
                      "id": 7,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 6,
                      "targets": [
                         {
                            "expr": "loki_ingester_flush_queue_length{cluster=\"$cluster\", job=~\"$namespace/ingester.*\"} or cortex_ingester_flush_queue_length{cluster=\"$cluster\", job=~\"$namespace/ingester.*\"}",
                            "format": "time_series",
                            "legendFormat": "{{pod}}",
                            "legendLink": null
                         }
                      ],
                      "title": "Queue Length",
                      "type": "timeseries"
                   },
                   {
                      "aliasColors": {
                         "1xx": "#EAB839",
                         "2xx": "#7EB26D",
                         "3xx": "#6ED0E0",
                         "4xx": "#EF843C",
                         "5xx": "#E24D42",
                         "OK": "#7EB26D",
                         "cancel": "#A9A9A9",
                         "error": "#E24D42",
                         "success": "#7EB26D"
                      },
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 100,
                               "lineWidth": 0,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "normal"
                               }
                            },
                            "min": 0,
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "1xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#EAB839",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "2xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "3xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#6ED0E0",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "4xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#EF843C",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "5xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E24D42",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "OK"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "cancel"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#A9A9A9",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "error"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E24D42",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "success"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            }
                         ]
                      },
                      "fill": 10,
                      "id": 8,
                      "linewidth": 0,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 6,
                      "stack": true,
                      "targets": [
                         {
                            "expr": "sum by (status) (\n  label_replace(label_replace(rate(loki_ingester_chunk_age_seconds_count{cluster=\"$cluster\", job=~\"$namespace/ingester.*\"}[$__rate_interval]),\n  \"status\", \"${1}xx\", \"status_code\", \"([0-9])..\"),\n  \"status\", \"${1}\", \"status_code\", \"([a-zA-Z]+)\"))\n",
                            "format": "time_series",
                            "legendFormat": "{{status}}",
                            "refId": "A"
                         }
                      ],
                      "title": "Flush Rate",
                      "type": "timeseries"
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "Flush Stats",
                "titleSize": "h6"
             },
             {
                "collapse": false,
                "height": "250px",
                "panels": [
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [ ]
                      },
                      "id": 9,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 6,
                      "targets": [
                         {
                            "expr": "sum(rate(loki_ingester_chunks_flushed_total{cluster=\"$cluster\", job=~\"$namespace/ingester.*\"}[$__rate_interval]))",
                            "format": "time_series",
                            "legendFormat": "{{pod}}",
                            "legendLink": null
                         }
                      ],
                      "title": "Chunks Flushed/Second",
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [ ]
                      },
                      "id": 10,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 6,
                      "stack": true,
                      "targets": [
                         {
                            "expr": "sum by (reason) (rate(loki_ingester_chunks_flushed_total{cluster=\"$cluster\", job=~\"$namespace/ingester.*\"}[$__rate_interval])) / ignoring(reason) group_left sum(rate(loki_ingester_chunks_flushed_total{cluster=\"$cluster\", job=~\"$namespace/ingester.*\"}[$__rate_interval]))",
                            "format": "time_series",
                            "legendFormat": "{{reason}}",
                            "legendLink": null
                         }
                      ],
                      "title": "Chunk Flush Reason",
                      "type": "timeseries",
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": 1,
                            "min": 0,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": 1,
                            "min": null,
                            "show": false
                         }
                      ]
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "Flush Stats",
                "titleSize": "h6"
             },
             {
                "collapse": false,
                "height": "250px",
                "panels": [
                   {
                      "cards": {
                         "cardPadding": null,
                         "cardRound": null
                      },
                      "color": {
                         "cardColor": "#b4ff00",
                         "colorScale": "sqrt",
                         "colorScheme": "interpolateSpectral",
                         "exponent": 0.5,
                         "mode": "spectrum"
                      },
                      "dataFormat": "tsbuckets",
                      "datasource": "$datasource",
                      "heatmap": { },
                      "hideZeroBuckets": false,
                      "highlightCards": true,
                      "id": 11,
                      "legend": {
                         "show": true
                      },
                      "span": 12,
                      "targets": [
                         {
                            "expr": "sum by (le) (rate(loki_ingester_chunk_utilization_bucket{cluster=\"$cluster\", job=~\"$namespace/ingester.*\"}[$__rate_interval]))",
                            "format": "heatmap",
                            "intervalFactor": 2,
                            "legendFormat": "{{le}}",
                            "refId": "A"
                         }
                      ],
                      "title": "Chunk Utilization",
                      "tooltip": {
                         "show": true,
                         "showHistogram": true
                      },
                      "type": "heatmap",
                      "xAxis": {
                         "show": true
                      },
                      "xBucketNumber": null,
                      "xBucketSize": null,
                      "yAxis": {
                         "decimals": 0,
                         "format": "percentunit",
                         "show": true,
                         "splitFactor": null
                      },
                      "yBucketBound": "auto"
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "Utilization",
                "titleSize": "h6"
             },
             {
                "collapse": false,
                "height": "250px",
                "panels": [
                   {
                      "cards": {
                         "cardPadding": null,
                         "cardRound": null
                      },
                      "color": {
                         "cardColor": "#b4ff00",
                         "colorScale": "sqrt",
                         "colorScheme": "interpolateSpectral",
                         "exponent": 0.5,
                         "mode": "spectrum"
                      },
                      "dataFormat": "tsbuckets",
                      "datasource": "$datasource",
                      "heatmap": { },
                      "hideZeroBuckets": false,
                      "highlightCards": true,
                      "id": 12,
                      "legend": {
                         "show": true
                      },
                      "span": 12,
                      "targets": [
                         {
                            "expr": "sum(rate(loki_ingester_chunk_size_bytes_bucket{cluster=\"$cluster\", job=~\"$namespace/ingester.*\"}[$__rate_interval])) by (le)",
                            "format": "heatmap",
                            "intervalFactor": 2,
                            "legendFormat": "{{le}}",
                            "refId": "A"
                         }
                      ],
                      "title": "Chunk Size Bytes",
                      "tooltip": {
                         "show": true,
                         "showHistogram": true
                      },
                      "type": "heatmap",
                      "xAxis": {
                         "show": true
                      },
                      "xBucketNumber": null,
                      "xBucketSize": null,
                      "yAxis": {
                         "decimals": 0,
                         "format": "bytes",
                         "show": true,
                         "splitFactor": null
                      },
                      "yBucketBound": "auto"
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "Utilization",
                "titleSize": "h6"
             },
             {
                "collapse": false,
                "height": "250px",
                "panels": [
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "bytes"
                         },
                         "overrides": [ ]
                      },
                      "id": 13,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 12,
                      "targets": [
                         {
                            "expr": "histogram_quantile(0.99, sum(rate(loki_ingester_chunk_size_bytes_bucket{cluster=\"$cluster\", job=~\"$namespace/ingester.*\"}[$__rate_interval])) by (le))",
                            "format": "time_series",
                            "legendFormat": "p99",
                            "legendLink": null
                         },
                         {
                            "expr": "histogram_quantile(0.90, sum(rate(loki_ingester_chunk_size_bytes_bucket{cluster=\"$cluster\", job=~\"$namespace/ingester.*\"}[$__rate_interval])) by (le))",
                            "format": "time_series",
                            "legendFormat": "p90",
                            "legendLink": null
                         },
                         {
                            "expr": "histogram_quantile(0.50, sum(rate(loki_ingester_chunk_size_bytes_bucket{cluster=\"$cluster\", job=~\"$namespace/ingester.*\"}[$__rate_interval])) by (le))",
                            "format": "time_series",
                            "legendFormat": "p50",
                            "legendLink": null
                         }
                      ],
                      "title": "Chunk Size Quantiles",
                      "type": "timeseries"
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "Utilization",
                "titleSize": "h6"
             },
             {
                "collapse": false,
                "height": "250px",
                "panels": [
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [ ]
                      },
                      "id": 14,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 12,
                      "targets": [
                         {
                            "expr": "histogram_quantile(0.5, sum(rate(loki_ingester_chunk_bounds_hours_bucket{cluster=\"$cluster\", job=~\"$namespace/ingester.*\"}[$__rate_interval])) by (le))",
                            "format": "time_series",
                            "legendFormat": "p50",
                            "legendLink": null
                         },
                         {
                            "expr": "histogram_quantile(0.99, sum(rate(loki_ingester_chunk_bounds_hours_bucket{cluster=\"$cluster\", job=~\"$namespace/ingester.*\"}[$__rate_interval])) by (le))",
                            "format": "time_series",
                            "legendFormat": "p99",
                            "legendLink": null
                         },
                         {
                            "expr": "sum(rate(loki_ingester_chunk_bounds_hours_sum{cluster=\"$cluster\", job=~\"$namespace/ingester.*\"}[$__rate_interval])) / sum(rate(loki_ingester_chunk_bounds_hours_count{cluster=\"$cluster\", job=~\"$namespace/ingester.*\"}[$__rate_interval]))",
                            "format": "time_series",
                            "legendFormat": "avg",
                            "legendLink": null
                         }
                      ],
                      "title": "Chunk Duration hours (end-start)",
                      "type": "timeseries"
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "Duration",
                "titleSize": "h6"
             }
          ],
          "schemaVersion": 14,
          "style": "dark",
          "tags": [
             "loki"
          ],
          "templating": {
             "list": [
                {
                   "current": {
                      "text": "default",
                      "value": "default"
                   },
                   "hide": 0,
                   "label": "Data source",
                   "name": "datasource",
                   "options": [ ],
                   "query": "prometheus",
                   "refresh": 1,
                   "regex": "",
                   "type": "datasource"
                },
                {
                   "allValue": null,
                   "current": {
                      "text": "prod",
                      "value": "prod"
                   },
                   "datasource": "$datasource",
                   "hide": 0,
                   "includeAll": false,
                   "label": "cluster",
                   "multi": false,
                   "name": "cluster",
                   "options": [ ],
                   "query": "label_values(loki_build_info, cluster)",
                   "refresh": 1,
                   "regex": "",
                   "sort": 2,
                   "tagValuesQuery": "",
                   "tags": [ ],
                   "tagsQuery": "",
                   "type": "query",
                   "useTags": false
                },
                {
                   "allValue": null,
                   "current": {
                      "text": "prod",
                      "value": "prod"
                   },
                   "datasource": "$datasource",
                   "hide": 0,
                   "includeAll": false,
                   "label": "namespace",
                   "multi": false,
                   "name": "namespace",
                   "options": [ ],
                   "query": "label_values(loki_build_info{cluster=~\"$cluster\"}, namespace)",
                   "refresh": 1,
                   "regex": "",
                   "sort": 2,
                   "tagValuesQuery": "",
                   "tags": [ ],
                   "tagsQuery": "",
                   "type": "query",
                   "useTags": false
                }
             ]
          },
          "time": {
             "from": "now-1h",
             "to": "now"
          },
          "timepicker": {
             "refresh_intervals": [
                "5s",
                "10s",
                "30s",
                "1m",
                "5m",
                "15m",
                "30m",
                "1h",
                "2h",
                "1d"
             ],
             "time_options": [
                "5m",
                "15m",
                "1h",
                "6h",
                "12h",
                "24h",
                "2d",
                "7d",
                "30d"
             ]
          },
          "timezone": "utc",
          "title": "Loki / Chunks",
          "uid": "chunks",
          "version": 0
       }
kind: ConfigMap
metadata:
  annotations:
    grafana_dashboard_folder: /dashboards/Loki Mixin
  labels:
    grafana_dashboard: "1"
  name: loki-chunks.json
  namespace: monitoring-system
---
apiVersion: v1
data:
  loki-deletion.json: |-
    {
          "annotations": {
             "list": [ ]
          },
          "editable": true,
          "gnetId": null,
          "graphTooltip": 0,
          "hideControls": false,
          "links": [
             {
                "asDropdown": true,
                "icon": "external link",
                "includeVars": true,
                "keepTime": true,
                "tags": [
                   "loki"
                ],
                "targetBlank": false,
                "title": "Loki Dashboards",
                "type": "dashboards"
             }
          ],
          "refresh": "10s",
          "rows": [
             {
                "collapse": false,
                "height": "100px",
                "panels": [
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fill": 1,
                      "format": "none",
                      "id": 1,
                      "legend": {
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "show": true,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "links": [ ],
                      "nullPointMode": "null as zero",
                      "percentage": false,
                      "pointradius": 5,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "span": 6,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "sum(loki_compactor_pending_delete_requests_count{cluster=~\"$cluster\", namespace=~\"$namespace\"})",
                            "format": "time_series",
                            "instant": true,
                            "refId": "A"
                         }
                      ],
                      "thresholds": "70,80",
                      "timeFrom": null,
                      "timeShift": null,
                      "title": "Number of Pending Requests",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "singlestat",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": 0,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": false
                         }
                      ]
                   },
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fill": 1,
                      "format": "dtdurations",
                      "id": 2,
                      "legend": {
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "show": true,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "links": [ ],
                      "nullPointMode": "null as zero",
                      "percentage": false,
                      "pointradius": 5,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "span": 6,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "max(loki_compactor_oldest_pending_delete_request_age_seconds{cluster=~\"$cluster\", namespace=~\"$namespace\"})",
                            "format": "time_series",
                            "instant": true,
                            "refId": "A"
                         }
                      ],
                      "thresholds": "70,80",
                      "timeFrom": null,
                      "timeShift": null,
                      "title": "Oldest Pending Request Age",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "singlestat",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": 0,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": false
                         }
                      ]
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": false,
                "title": "Headlines",
                "titleSize": "h6"
             },
             {
                "collapse": false,
                "height": "250px",
                "panels": [
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [ ]
                      },
                      "id": 3,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "(loki_compactor_delete_requests_received_total{cluster=~\"$cluster\", namespace=~\"$namespace\"} or on() vector(0)) - on () (loki_compactor_delete_requests_processed_total{cluster=~\"$cluster\", namespace=~\"$namespace\"} or on () vector(0))",
                            "format": "time_series",
                            "legendFormat": "in progress",
                            "legendLink": null
                         }
                      ],
                      "title": "# of Delete Requests (received - processed) ",
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [ ]
                      },
                      "id": 4,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "sum(increase(loki_compactor_delete_requests_received_total{cluster=~\"$cluster\", namespace=~\"$namespace\"}[1d]))",
                            "format": "time_series",
                            "legendFormat": "received",
                            "legendLink": null
                         }
                      ],
                      "title": "Delete Requests Received / Day",
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [ ]
                      },
                      "id": 5,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "sum(increase(loki_compactor_delete_requests_processed_total{cluster=~\"$cluster\", namespace=~\"$namespace\"}[1d]))",
                            "format": "time_series",
                            "legendFormat": "processed",
                            "legendLink": null
                         }
                      ],
                      "title": "Delete Requests Processed / Day",
                      "type": "timeseries"
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "Churn",
                "titleSize": "h6"
             },
             {
                "collapse": false,
                "height": "250px",
                "panels": [
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [ ]
                      },
                      "id": 6,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "node_namespace_pod_container:container_cpu_usage_seconds_total:sum_irate{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"compactor\"}",
                            "format": "time_series",
                            "legendFormat": "{{pod}}",
                            "legendLink": null
                         }
                      ],
                      "title": "Compactor CPU usage",
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [ ]
                      },
                      "id": 7,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "go_memstats_heap_inuse_bytes{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"compactor\"} / 1024 / 1024 ",
                            "format": "time_series",
                            "legendFormat": " {{pod}} ",
                            "legendLink": null
                         }
                      ],
                      "title": "Compactor memory usage (MiB)",
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [ ]
                      },
                      "id": 8,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "loki_boltdb_shipper_compact_tables_operation_duration_seconds{cluster=~\"$cluster\", namespace=~\"$namespace\"}",
                            "format": "time_series",
                            "legendFormat": "{{pod}}",
                            "legendLink": null
                         }
                      ],
                      "title": "Compaction run duration (seconds)",
                      "type": "timeseries"
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "Compactor",
                "titleSize": "h6"
             },
             {
                "collapse": false,
                "height": "250px",
                "panels": [
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [ ]
                      },
                      "id": 9,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 6,
                      "targets": [
                         {
                            "expr": "sum(increase(loki_compactor_load_pending_requests_attempts_total{status=\"fail\", cluster=~\"$cluster\", namespace=~\"$namespace\"}[1h]))",
                            "format": "time_series",
                            "legendFormat": "failures",
                            "legendLink": null
                         }
                      ],
                      "title": "Failures in Loading Delete Requests / Hour",
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [ ]
                      },
                      "id": 10,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 6,
                      "targets": [
                         {
                            "expr": "sum(rate(loki_compactor_deleted_lines{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"compactor\"}[$__rate_interval])) by (user)",
                            "format": "time_series",
                            "legendFormat": "{{user}}",
                            "legendLink": null
                         }
                      ],
                      "title": "Lines Deleted / Sec",
                      "type": "timeseries"
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "Deletion metrics",
                "titleSize": "h6"
             },
             {
                "collapse": false,
                "height": "250px",
                "panels": [
                   {
                      "datasource": "$loki_datasource",
                      "id": 11,
                      "span": 6,
                      "targets": [
                         {
                            "expr": "{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"compactor\"} |~ \"Started processing delete request|delete request for user marked as processed\" | logfmt | line_format \"{{.ts}} user={{.user}} delete_request_id={{.delete_request_id}} msg={{.msg}}\" ",
                            "refId": "A"
                         }
                      ],
                      "title": "In progress/finished",
                      "type": "logs"
                   },
                   {
                      "datasource": "$loki_datasource",
                      "id": 12,
                      "span": 6,
                      "targets": [
                         {
                            "expr": "{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"compactor\"} |~ \"delete request for user added\" | logfmt | line_format \"{{.ts}} user={{.user}} query='{{.query}}'\"",
                            "refId": "A"
                         }
                      ],
                      "title": "Requests",
                      "type": "logs"
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "List of deletion requests",
                "titleSize": "h6"
             }
          ],
          "schemaVersion": 14,
          "style": "dark",
          "tags": [
             "loki"
          ],
          "templating": {
             "list": [
                {
                   "current": {
                      "text": "default",
                      "value": "default"
                   },
                   "hide": 0,
                   "label": "Data source",
                   "name": "datasource",
                   "options": [ ],
                   "query": "prometheus",
                   "refresh": 1,
                   "regex": "",
                   "type": "datasource"
                },
                {
                   "allValue": null,
                   "current": {
                      "text": "prod",
                      "value": "prod"
                   },
                   "datasource": "$datasource",
                   "hide": 0,
                   "includeAll": false,
                   "label": "cluster",
                   "multi": false,
                   "name": "cluster",
                   "options": [ ],
                   "query": "label_values(loki_build_info, cluster)",
                   "refresh": 1,
                   "regex": "",
                   "sort": 2,
                   "tagValuesQuery": "",
                   "tags": [ ],
                   "tagsQuery": "",
                   "type": "query",
                   "useTags": false
                },
                {
                   "allValue": null,
                   "current": {
                      "text": "prod",
                      "value": "prod"
                   },
                   "datasource": "$datasource",
                   "hide": 0,
                   "includeAll": false,
                   "label": "namespace",
                   "multi": false,
                   "name": "namespace",
                   "options": [ ],
                   "query": "label_values(loki_build_info{cluster=~\"$cluster\"}, namespace)",
                   "refresh": 1,
                   "regex": "",
                   "sort": 2,
                   "tagValuesQuery": "",
                   "tags": [ ],
                   "tagsQuery": "",
                   "type": "query",
                   "useTags": false
                }
             ]
          },
          "time": {
             "from": "now-1h",
             "to": "now"
          },
          "timepicker": {
             "refresh_intervals": [
                "5s",
                "10s",
                "30s",
                "1m",
                "5m",
                "15m",
                "30m",
                "1h",
                "2h",
                "1d"
             ],
             "time_options": [
                "5m",
                "15m",
                "1h",
                "6h",
                "12h",
                "24h",
                "2d",
                "7d",
                "30d"
             ]
          },
          "timezone": "utc",
          "title": "Loki / Deletion",
          "uid": "deletion",
          "version": 0
       }
kind: ConfigMap
metadata:
  annotations:
    grafana_dashboard_folder: /dashboards/Loki Mixin
  labels:
    grafana_dashboard: "1"
  name: loki-deletion.json
  namespace: monitoring-system
---
apiVersion: v1
data:
  loki-logs.json: |-
    {
          "annotations": {
             "list": [ ]
          },
          "editable": true,
          "gnetId": null,
          "graphTooltip": 0,
          "hideControls": false,
          "iteration": 1583185057230,
          "links": [
             {
                "asDropdown": true,
                "icon": "external link",
                "includeVars": true,
                "keepTime": true,
                "tags": [
                   "loki"
                ],
                "targetBlank": false,
                "title": "Loki Dashboards",
                "type": "dashboards"
             }
          ],
          "panels": [
             {
                "aliasColors": { },
                "bars": false,
                "dashLength": 10,
                "dashes": false,
                "datasource": "$datasource",
                "fill": 1,
                "fillGradient": 0,
                "gridPos": {
                   "h": 4,
                   "w": 3,
                   "x": 0,
                   "y": 0
                },
                "hiddenSeries": false,
                "id": 35,
                "legend": {
                   "avg": false,
                   "current": false,
                   "max": false,
                   "min": false,
                   "show": false,
                   "total": false,
                   "values": false
                },
                "lines": true,
                "linewidth": 1,
                "nullPointMode": "null",
                "options": {
                   "dataLinks": [ ]
                },
                "percentage": false,
                "pointradius": 2,
                "points": false,
                "renderer": "flot",
                "seriesOverrides": [ ],
                "spaceLength": 10,
                "stack": false,
                "steppedLine": false,
                "targets": [
                   {
                      "expr": "sum(go_goroutines{cluster=\"$cluster\", namespace=\"$namespace\", pod=~\"$deployment.*\", pod=~\"$pod\"})",
                      "refId": "A"
                   }
                ],
                "thresholds": [ ],
                "timeFrom": null,
                "timeRegions": [ ],
                "timeShift": null,
                "title": "goroutines",
                "tooltip": {
                   "shared": true,
                   "sort": 0,
                   "value_type": "individual"
                },
                "type": "timeseries",
                "xaxis": {
                   "buckets": null,
                   "mode": "time",
                   "name": null,
                   "show": true,
                   "values": [ ]
                },
                "yaxes": [
                   {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   },
                   {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   }
                ],
                "yaxis": {
                   "align": false,
                   "alignLevel": null
                }
             },
             {
                "aliasColors": { },
                "bars": false,
                "dashLength": 10,
                "dashes": false,
                "datasource": "$datasource",
                "fieldConfig": {
                   "defaults": {
                      "unit": "s"
                   }
                },
                "fill": 1,
                "fillGradient": 0,
                "gridPos": {
                   "h": 4,
                   "w": 3,
                   "x": 3,
                   "y": 0
                },
                "hiddenSeries": false,
                "id": 41,
                "legend": {
                   "avg": false,
                   "current": false,
                   "max": false,
                   "min": false,
                   "show": false,
                   "total": false,
                   "values": false
                },
                "lines": true,
                "linewidth": 1,
                "nullPointMode": "null",
                "options": {
                   "dataLinks": [ ]
                },
                "percentage": false,
                "pointradius": 2,
                "points": false,
                "renderer": "flot",
                "seriesOverrides": [ ],
                "spaceLength": 10,
                "stack": false,
                "steppedLine": false,
                "targets": [
                   {
                      "expr": "sum(go_gc_duration_seconds{cluster=\"$cluster\", namespace=\"$namespace\", pod=~\"$deployment.*\", pod=~\"$pod\"}) by (quantile)",
                      "legendFormat": "{{quantile}}",
                      "refId": "A"
                   }
                ],
                "thresholds": [ ],
                "timeFrom": null,
                "timeRegions": [ ],
                "timeShift": null,
                "title": "gc duration",
                "tooltip": {
                   "shared": true,
                   "sort": 0,
                   "value_type": "individual"
                },
                "type": "timeseries",
                "xaxis": {
                   "buckets": null,
                   "mode": "time",
                   "name": null,
                   "show": true,
                   "values": [ ]
                },
                "yaxes": [
                   {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   },
                   {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   }
                ],
                "yaxis": {
                   "align": false,
                   "alignLevel": null
                }
             },
             {
                "aliasColors": { },
                "bars": false,
                "dashLength": 10,
                "dashes": false,
                "datasource": "$datasource",
                "fill": 1,
                "fillGradient": 0,
                "gridPos": {
                   "h": 4,
                   "w": 3,
                   "x": 6,
                   "y": 0
                },
                "hiddenSeries": false,
                "id": 36,
                "legend": {
                   "avg": false,
                   "current": false,
                   "max": false,
                   "min": false,
                   "show": false,
                   "total": false,
                   "values": false
                },
                "lines": true,
                "linewidth": 1,
                "nullPointMode": "null",
                "options": {
                   "dataLinks": [ ]
                },
                "percentage": false,
                "pointradius": 2,
                "points": false,
                "renderer": "flot",
                "seriesOverrides": [ ],
                "spaceLength": 10,
                "stack": false,
                "steppedLine": false,
                "targets": [
                   {
                      "expr": "sum(rate(container_cpu_usage_seconds_total{cluster=\"$cluster\", namespace=\"$namespace\", pod=~\"$deployment.*\", pod=~\"$pod\", container=~\"$container\"}[$__rate_interval]))",
                      "refId": "A"
                   }
                ],
                "thresholds": [ ],
                "timeFrom": null,
                "timeRegions": [ ],
                "timeShift": null,
                "title": "cpu",
                "tooltip": {
                   "shared": true,
                   "sort": 0,
                   "value_type": "individual"
                },
                "type": "timeseries",
                "xaxis": {
                   "buckets": null,
                   "mode": "time",
                   "name": null,
                   "show": true,
                   "values": [ ]
                },
                "yaxes": [
                   {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   },
                   {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   }
                ],
                "yaxis": {
                   "align": false,
                   "alignLevel": null
                }
             },
             {
                "aliasColors": { },
                "bars": false,
                "dashLength": 10,
                "dashes": false,
                "datasource": "$datasource",
                "fieldConfig": {
                   "defaults": {
                      "unit": "bytes"
                   }
                },
                "fill": 1,
                "fillGradient": 0,
                "gridPos": {
                   "h": 4,
                   "w": 3,
                   "x": 9,
                   "y": 0
                },
                "hiddenSeries": false,
                "id": 40,
                "legend": {
                   "avg": false,
                   "current": false,
                   "max": false,
                   "min": false,
                   "show": false,
                   "total": false,
                   "values": false
                },
                "lines": true,
                "linewidth": 1,
                "nullPointMode": "null",
                "options": {
                   "dataLinks": [ ]
                },
                "percentage": false,
                "pointradius": 2,
                "points": false,
                "renderer": "flot",
                "seriesOverrides": [ ],
                "spaceLength": 10,
                "stack": false,
                "steppedLine": false,
                "targets": [
                   {
                      "expr": "sum(container_memory_working_set_bytes{cluster=\"$cluster\", namespace=\"$namespace\", pod=~\"$deployment.*\", pod=~\"$pod\", container=~\"$container\"})",
                      "refId": "A"
                   }
                ],
                "thresholds": [ ],
                "timeFrom": null,
                "timeRegions": [ ],
                "timeShift": null,
                "title": "working set",
                "tooltip": {
                   "shared": true,
                   "sort": 0,
                   "value_type": "individual"
                },
                "type": "timeseries",
                "xaxis": {
                   "buckets": null,
                   "mode": "time",
                   "name": null,
                   "show": true,
                   "values": [ ]
                },
                "yaxes": [
                   {
                      "format": "bytes",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   },
                   {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   }
                ],
                "yaxis": {
                   "align": false,
                   "alignLevel": null
                }
             },
             {
                "aliasColors": { },
                "bars": false,
                "dashLength": 10,
                "dashes": false,
                "datasource": "$datasource",
                "fieldConfig": {
                   "defaults": {
                      "unit": "binBps"
                   }
                },
                "fill": 1,
                "fillGradient": 0,
                "gridPos": {
                   "h": 4,
                   "w": 3,
                   "x": 12,
                   "y": 0
                },
                "hiddenSeries": false,
                "id": 38,
                "legend": {
                   "avg": false,
                   "current": false,
                   "max": false,
                   "min": false,
                   "show": false,
                   "total": false,
                   "values": false
                },
                "lines": true,
                "linewidth": 1,
                "nullPointMode": "null",
                "options": {
                   "dataLinks": [ ]
                },
                "percentage": false,
                "pointradius": 2,
                "points": false,
                "renderer": "flot",
                "seriesOverrides": [ ],
                "spaceLength": 10,
                "stack": false,
                "steppedLine": false,
                "targets": [
                   {
                      "expr": "sum(rate(container_network_transmit_bytes_total{cluster=\"$cluster\", namespace=\"$namespace\", pod=~\"$deployment.*\", pod=~\"$pod\"}[$__rate_interval]))",
                      "refId": "A"
                   }
                ],
                "thresholds": [ ],
                "timeFrom": null,
                "timeRegions": [ ],
                "timeShift": null,
                "title": "tx",
                "tooltip": {
                   "shared": true,
                   "sort": 0,
                   "value_type": "individual"
                },
                "type": "timeseries",
                "xaxis": {
                   "buckets": null,
                   "mode": "time",
                   "name": null,
                   "show": true,
                   "values": [ ]
                },
                "yaxes": [
                   {
                      "format": "bytes",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   },
                   {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   }
                ],
                "yaxis": {
                   "align": false,
                   "alignLevel": null
                }
             },
             {
                "aliasColors": { },
                "bars": false,
                "dashLength": 10,
                "dashes": false,
                "datasource": "$datasource",
                "fieldConfig": {
                   "defaults": {
                      "unit": "binBps"
                   }
                },
                "fill": 1,
                "fillGradient": 0,
                "gridPos": {
                   "h": 4,
                   "w": 3,
                   "x": 15,
                   "y": 0
                },
                "hiddenSeries": false,
                "id": 39,
                "legend": {
                   "avg": false,
                   "current": false,
                   "max": false,
                   "min": false,
                   "show": false,
                   "total": false,
                   "values": false
                },
                "lines": true,
                "linewidth": 1,
                "nullPointMode": "null",
                "options": {
                   "dataLinks": [ ]
                },
                "percentage": false,
                "pointradius": 2,
                "points": false,
                "renderer": "flot",
                "seriesOverrides": [ ],
                "spaceLength": 10,
                "stack": false,
                "steppedLine": false,
                "targets": [
                   {
                      "expr": "sum(rate(container_network_receive_bytes_total{cluster=\"$cluster\", namespace=\"$namespace\", pod=~\"$deployment.*\", pod=~\"$pod\"}[$__rate_interval]))",
                      "refId": "A"
                   }
                ],
                "thresholds": [ ],
                "timeFrom": null,
                "timeRegions": [ ],
                "timeShift": null,
                "title": "rx",
                "tooltip": {
                   "shared": true,
                   "sort": 0,
                   "value_type": "individual"
                },
                "type": "timeseries",
                "xaxis": {
                   "buckets": null,
                   "mode": "time",
                   "name": null,
                   "show": true,
                   "values": [ ]
                },
                "yaxes": [
                   {
                      "format": "decbytes",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   },
                   {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   }
                ],
                "yaxis": {
                   "align": false,
                   "alignLevel": null
                }
             },
             {
                "aliasColors": { },
                "bars": false,
                "dashLength": 10,
                "dashes": false,
                "datasource": "$datasource",
                "fill": 1,
                "fillGradient": 0,
                "gridPos": {
                   "h": 4,
                   "w": 3,
                   "x": 18,
                   "y": 0
                },
                "hiddenSeries": false,
                "id": 37,
                "legend": {
                   "avg": false,
                   "current": false,
                   "max": false,
                   "min": false,
                   "show": false,
                   "total": false,
                   "values": false
                },
                "lines": true,
                "linewidth": 1,
                "nullPointMode": "null",
                "options": {
                   "dataLinks": [ ]
                },
                "percentage": false,
                "pointradius": 2,
                "points": false,
                "renderer": "flot",
                "seriesOverrides": [ ],
                "spaceLength": 10,
                "stack": false,
                "steppedLine": false,
                "targets": [
                   {
                      "expr": "increase(kube_pod_container_status_last_terminated_reason{cluster=\"$cluster\", namespace=\"$namespace\", pod=~\"$deployment.*\", pod=~\"$pod\", container=~\"$container\"}[30m]) > 0",
                      "legendFormat": "{{reason}}",
                      "refId": "A"
                   }
                ],
                "thresholds": [ ],
                "timeFrom": null,
                "timeRegions": [ ],
                "timeShift": null,
                "title": "restarts",
                "tooltip": {
                   "shared": true,
                   "sort": 0,
                   "value_type": "individual"
                },
                "type": "timeseries",
                "xaxis": {
                   "buckets": null,
                   "mode": "time",
                   "name": null,
                   "show": true,
                   "values": [ ]
                },
                "yaxes": [
                   {
                      "format": "bytes",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   },
                   {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   }
                ],
                "yaxis": {
                   "align": false,
                   "alignLevel": null
                }
             },
             {
                "aliasColors": { },
                "bars": false,
                "dashLength": 10,
                "dashes": false,
                "datasource": "$datasource",
                "fieldConfig": {
                   "defaults": {
                      "unit": "ops"
                   }
                },
                "fill": 1,
                "fillGradient": 0,
                "gridPos": {
                   "h": 4,
                   "w": 3,
                   "x": 21,
                   "y": 0
                },
                "hiddenSeries": false,
                "id": 42,
                "legend": {
                   "avg": false,
                   "current": false,
                   "max": false,
                   "min": false,
                   "show": false,
                   "total": false,
                   "values": false
                },
                "lines": true,
                "linewidth": 1,
                "nullPointMode": "null",
                "options": {
                   "dataLinks": [ ]
                },
                "percentage": false,
                "pointradius": 2,
                "points": false,
                "renderer": "flot",
                "seriesOverrides": [ ],
                "spaceLength": 10,
                "stack": false,
                "steppedLine": false,
                "targets": [
                   {
                      "expr": "sum(rate(promtail_custom_bad_words_total{cluster=\"$cluster\", exported_namespace=\"$namespace\", exported_pod=~\"$deployment.*\", exported_pod=~\"$pod\", container=~\"$container\"}[$__rate_interval])) by (level)",
                      "legendFormat": "{{level}}",
                      "refId": "A"
                   }
                ],
                "thresholds": [ ],
                "timeFrom": null,
                "timeRegions": [ ],
                "timeShift": null,
                "title": "bad words",
                "tooltip": {
                   "shared": true,
                   "sort": 0,
                   "value_type": "individual"
                },
                "type": "timeseries",
                "xaxis": {
                   "buckets": null,
                   "mode": "time",
                   "name": null,
                   "show": true,
                   "values": [ ]
                },
                "yaxes": [
                   {
                      "format": "bytes",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   },
                   {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   }
                ],
                "yaxis": {
                   "align": false,
                   "alignLevel": null
                }
             },
             {
                "aliasColors": { },
                "bars": false,
                "dashLength": 10,
                "dashes": false,
                "datasource": "$loki_datasource",
                "fieldConfig": {
                   "defaults": {
                      "unit": "ops"
                   }
                },
                "fill": 1,
                "fillGradient": 0,
                "gridPos": {
                   "h": 7,
                   "w": 24,
                   "x": 0,
                   "y": 4
                },
                "hiddenSeries": false,
                "id": 31,
                "legend": {
                   "avg": false,
                   "current": false,
                   "max": false,
                   "min": false,
                   "show": false,
                   "total": false,
                   "values": false
                },
                "lines": true,
                "linewidth": 1,
                "nullPointMode": "null",
                "options": {
                   "dataLinks": [ ]
                },
                "percentage": false,
                "pointradius": 2,
                "points": false,
                "renderer": "flot",
                "seriesOverrides": [
                   {
                      "alias": "warn",
                      "color": "#FF780A"
                   },
                   {
                      "alias": "error",
                      "color": "#E02F44"
                   },
                   {
                      "alias": "info",
                      "color": "#56A64B"
                   },
                   {
                      "alias": "debug",
                      "color": "#3274D9"
                   }
                ],
                "spaceLength": 10,
                "stack": true,
                "steppedLine": false,
                "targets": [
                   {
                      "expr": "sum(rate({cluster=\"$cluster\", namespace=\"$namespace\", pod=~\"$deployment.*\", pod=~\"$pod\", container=~\"$container\" } |logfmt| level=\"$level\" |= \"$filter\" | __error__=\"\" [$__auto])) by (level)",
                      "intervalFactor": 3,
                      "legendFormat": "{{level}}",
                      "refId": "A"
                   }
                ],
                "thresholds": [ ],
                "timeFrom": null,
                "timeRegions": [ ],
                "timeShift": null,
                "title": "Log Rate",
                "tooltip": {
                   "shared": true,
                   "sort": 2,
                   "value_type": "individual"
                },
                "type": "timeseries",
                "xaxis": {
                   "buckets": null,
                   "mode": "time",
                   "name": null,
                   "show": false,
                   "values": [ ]
                },
                "yaxes": [
                   {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   },
                   {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": false
                   }
                ],
                "yaxis": {
                   "align": false,
                   "alignLevel": null
                }
             },
             {
                "datasource": "$loki_datasource",
                "gridPos": {
                   "h": 19,
                   "w": 24,
                   "x": 0,
                   "y": 6
                },
                "id": 29,
                "maxDataPoints": "",
                "options": {
                   "showLabels": false,
                   "showTime": true,
                   "sortOrder": "Descending",
                   "wrapLogMessage": true
                },
                "targets": [
                   {
                      "expr": "{cluster=\"$cluster\", namespace=\"$namespace\", pod=~\"$deployment.*\", pod=~\"$pod\", container=~\"$container\"} | logfmt | level=\"$level\" |= \"$filter\"",
                      "refId": "A"
                   }
                ],
                "timeFrom": null,
                "timeShift": null,
                "title": "Logs",
                "type": "logs"
             }
          ],
          "refresh": "10s",
          "rows": [ ],
          "schemaVersion": 14,
          "style": "dark",
          "tags": [
             "loki"
          ],
          "templating": {
             "list": [
                {
                   "current": {
                      "text": "default",
                      "value": "default"
                   },
                   "hide": 0,
                   "label": "Data source",
                   "name": "datasource",
                   "options": [ ],
                   "query": "prometheus",
                   "refresh": 1,
                   "regex": "",
                   "type": "datasource"
                },
                {
                   "allValue": null,
                   "current": {
                      "text": "prod",
                      "value": "prod"
                   },
                   "datasource": "$datasource",
                   "hide": 0,
                   "includeAll": false,
                   "label": "cluster",
                   "multi": false,
                   "name": "cluster",
                   "options": [ ],
                   "query": "label_values(loki_build_info, cluster)",
                   "refresh": 1,
                   "regex": "",
                   "sort": 2,
                   "tagValuesQuery": "",
                   "tags": [ ],
                   "tagsQuery": "",
                   "type": "query",
                   "useTags": false
                },
                {
                   "allValue": null,
                   "current": {
                      "text": "prod",
                      "value": "prod"
                   },
                   "datasource": "$datasource",
                   "hide": 0,
                   "includeAll": false,
                   "label": "namespace",
                   "multi": false,
                   "name": "namespace",
                   "options": [ ],
                   "query": "label_values(loki_build_info{cluster=~\"$cluster\"}, namespace)",
                   "refresh": 1,
                   "regex": "",
                   "sort": 2,
                   "tagValuesQuery": "",
                   "tags": [ ],
                   "tagsQuery": "",
                   "type": "query",
                   "useTags": false
                },
                {
                   "hide": 0,
                   "label": null,
                   "name": "loki_datasource",
                   "options": [ ],
                   "query": "loki",
                   "refresh": 1,
                   "regex": "",
                   "type": "datasource"
                },
                {
                   "allValue": null,
                   "current": { },
                   "datasource": "$datasource",
                   "hide": 0,
                   "includeAll": false,
                   "label": null,
                   "multi": false,
                   "name": "deployment",
                   "options": [ ],
                   "query": "label_values(kube_deployment_created{cluster=\"$cluster\", namespace=\"$namespace\"}, deployment)",
                   "refresh": 0,
                   "regex": "",
                   "sort": 1,
                   "tagValuesQuery": "",
                   "tags": [ ],
                   "tagsQuery": "",
                   "type": "query",
                   "useTags": false
                },
                {
                   "allValue": null,
                   "current": { },
                   "datasource": "$datasource",
                   "hide": 0,
                   "includeAll": false,
                   "label": null,
                   "multi": false,
                   "name": "pod",
                   "options": [ ],
                   "query": "label_values(kube_pod_container_info{cluster=\"$cluster\", namespace=\"$namespace\", pod=~\"$deployment.*\"}, pod)",
                   "refresh": 0,
                   "regex": "",
                   "sort": 1,
                   "tagValuesQuery": "",
                   "tags": [ ],
                   "tagsQuery": "",
                   "type": "query",
                   "useTags": false
                },
                {
                   "allValue": null,
                   "current": { },
                   "datasource": "$datasource",
                   "hide": 0,
                   "includeAll": false,
                   "label": null,
                   "multi": false,
                   "name": "container",
                   "options": [ ],
                   "query": "label_values(kube_pod_container_info{cluster=\"$cluster\", namespace=\"$namespace\", pod=~\"$pod\", pod=~\"$deployment.*\"}, container)",
                   "refresh": 0,
                   "regex": "",
                   "sort": 1,
                   "tagValuesQuery": "",
                   "tags": [ ],
                   "tagsQuery": "",
                   "type": "query",
                   "useTags": false
                },
                {
                   "allValue": null,
                   "current": {
                      "selected": true,
                      "text": "",
                      "value": ""
                   },
                   "hide": 0,
                   "includeAll": false,
                   "label": "",
                   "multi": true,
                   "name": "level",
                   "options": [
                      {
                         "selected": false,
                         "text": "debug",
                         "value": "debug"
                      },
                      {
                         "selected": false,
                         "text": "info",
                         "value": "info"
                      },
                      {
                         "selected": false,
                         "text": "warn",
                         "value": "warn"
                      },
                      {
                         "selected": false,
                         "text": "error",
                         "value": "error"
                      }
                   ],
                   "query": "debug,info,warn,error",
                   "refresh": 0,
                   "type": "custom"
                },
                {
                   "current": {
                      "selected": false,
                      "text": "",
                      "value": ""
                   },
                   "label": "LogQL Filter",
                   "name": "filter",
                   "query": "",
                   "type": "textbox"
                }
             ]
          },
          "time": {
             "from": "now-1h",
             "to": "now"
          },
          "timepicker": {
             "refresh_intervals": [
                "5s",
                "10s",
                "30s",
                "1m",
                "5m",
                "15m",
                "30m",
                "1h",
                "2h",
                "1d"
             ],
             "time_options": [
                "5m",
                "15m",
                "1h",
                "6h",
                "12h",
                "24h",
                "2d",
                "7d",
                "30d"
             ]
          },
          "timezone": "utc",
          "title": "Loki / Logs",
          "uid": "logs",
          "version": 0
       }
kind: ConfigMap
metadata:
  annotations:
    grafana_dashboard_folder: /dashboards/Loki Mixin
  labels:
    grafana_dashboard: "1"
  name: loki-logs.json
  namespace: monitoring-system
---
apiVersion: v1
data:
  loki-mixin-recording-rules.json: |-
    {
          "annotations": {
             "list": [ ]
          },
          "editable": true,
          "fiscalYearStartMonth": 0,
          "gnetId": null,
          "graphTooltip": 0,
          "hideControls": false,
          "iteration": 1635347545534,
          "links": [
             {
                "asDropdown": true,
                "icon": "external link",
                "includeVars": true,
                "keepTime": true,
                "tags": [
                   "loki"
                ],
                "targetBlank": false,
                "title": "Loki Dashboards",
                "type": "dashboards"
             }
          ],
          "liveNow": false,
          "panels": [
             {
                "datasource": "${datasource}",
                "fieldConfig": {
                   "defaults": {
                      "color": {
                         "mode": "thresholds"
                      },
                      "mappings": [ ],
                      "noValue": "0",
                      "thresholds": {
                         "mode": "absolute",
                         "steps": [
                            {
                               "color": "green",
                               "value": null
                            },
                            {
                               "color": "red",
                               "value": 1
                            }
                         ]
                      }
                   },
                   "overrides": [ ]
                },
                "gridPos": {
                   "h": 10,
                   "w": 2,
                   "x": 0,
                   "y": 0
                },
                "id": 2,
                "options": {
                   "colorMode": "value",
                   "graphMode": "area",
                   "justifyMode": "auto",
                   "orientation": "auto",
                   "reduceOptions": {
                      "calcs": [
                         "lastNotNull"
                      ],
                      "fields": "",
                      "values": false
                   },
                   "textMode": "auto"
                },
                "pluginVersion": "8.3.0-38205pre",
                "targets": [
                   {
                      "datasource": "${datasource}",
                      "exemplar": false,
                      "expr": "sum(loki_ruler_wal_appender_ready) by (pod, tenant) == 0",
                      "instant": true,
                      "interval": "",
                      "legendFormat": "",
                      "refId": "A"
                   }
                ],
                "title": "Appenders Not Ready",
                "type": "stat"
             },
             {
                "datasource": "${datasource}",
                "description": "",
                "fieldConfig": {
                   "defaults": {
                      "color": {
                         "mode": "palette-classic"
                      },
                      "custom": {
                         "axisLabel": "",
                         "axisPlacement": "auto",
                         "barAlignment": 0,
                         "drawStyle": "line",
                         "fillOpacity": 0,
                         "gradientMode": "none",
                         "hideFrom": {
                            "legend": false,
                            "tooltip": false,
                            "viz": false
                         },
                         "lineInterpolation": "linear",
                         "lineWidth": 1,
                         "pointSize": 5,
                         "scaleDistribution": {
                            "type": "linear"
                         },
                         "showPoints": "auto",
                         "spanNulls": false,
                         "stacking": {
                            "group": "A",
                            "mode": "none"
                         },
                         "thresholdsStyle": {
                            "mode": "off"
                         }
                      },
                      "mappings": [ ],
                      "thresholds": {
                         "mode": "absolute",
                         "steps": [
                            {
                               "color": "green",
                               "value": null
                            },
                            {
                               "color": "red",
                               "value": 80
                            }
                         ]
                      }
                   },
                   "overrides": [ ]
                },
                "gridPos": {
                   "h": 10,
                   "w": 11,
                   "x": 2,
                   "y": 0
                },
                "id": 4,
                "options": {
                   "legend": {
                      "calcs": [ ],
                      "displayMode": "list",
                      "placement": "bottom"
                   },
                   "tooltip": {
                      "mode": "single"
                   }
                },
                "targets": [
                   {
                      "datasource": "${datasource}",
                      "exemplar": true,
                      "expr": "sum(rate(loki_ruler_wal_samples_appended_total{tenant=~\"${tenant}\"}[$__rate_interval])) by (tenant) > 0",
                      "interval": "",
                      "legendFormat": "{{tenant}}",
                      "refId": "A"
                   }
                ],
                "title": "Samples Appended to WAL per Second",
                "type": "timeseries"
             },
             {
                "datasource": "${datasource}",
                "description": "Series are unique combinations of labels",
                "fieldConfig": {
                   "defaults": {
                      "color": {
                         "mode": "palette-classic"
                      },
                      "custom": {
                         "axisLabel": "",
                         "axisPlacement": "auto",
                         "barAlignment": 0,
                         "drawStyle": "line",
                         "fillOpacity": 0,
                         "gradientMode": "none",
                         "hideFrom": {
                            "legend": false,
                            "tooltip": false,
                            "viz": false
                         },
                         "lineInterpolation": "linear",
                         "lineWidth": 1,
                         "pointSize": 5,
                         "scaleDistribution": {
                            "type": "linear"
                         },
                         "showPoints": "auto",
                         "spanNulls": false,
                         "stacking": {
                            "group": "A",
                            "mode": "none"
                         },
                         "thresholdsStyle": {
                            "mode": "off"
                         }
                      },
                      "mappings": [ ],
                      "thresholds": {
                         "mode": "absolute",
                         "steps": [
                            {
                               "color": "green",
                               "value": null
                            },
                            {
                               "color": "red",
                               "value": 80
                            }
                         ]
                      }
                   },
                   "overrides": [ ]
                },
                "gridPos": {
                   "h": 10,
                   "w": 11,
                   "x": 13,
                   "y": 0
                },
                "id": 5,
                "options": {
                   "legend": {
                      "calcs": [ ],
                      "displayMode": "list",
                      "placement": "bottom"
                   },
                   "tooltip": {
                      "mode": "single"
                   }
                },
                "targets": [
                   {
                      "datasource": "${datasource}",
                      "exemplar": true,
                      "expr": "sum(rate(loki_ruler_wal_storage_created_series_total{tenant=~\"${tenant}\"}[$__rate_interval])) by (tenant) > 0",
                      "interval": "",
                      "legendFormat": "{{tenant}}",
                      "refId": "A"
                   }
                ],
                "title": "Series Created per Second",
                "type": "timeseries"
             },
             {
                "datasource": "${datasource}",
                "description": "Difference between highest timestamp appended to WAL and highest timestamp successfully written to remote storage",
                "fieldConfig": {
                   "defaults": {
                      "color": {
                         "mode": "palette-classic"
                      },
                      "custom": {
                         "axisLabel": "",
                         "axisPlacement": "auto",
                         "barAlignment": 0,
                         "drawStyle": "line",
                         "fillOpacity": 0,
                         "gradientMode": "none",
                         "hideFrom": {
                            "legend": false,
                            "tooltip": false,
                            "viz": false
                         },
                         "lineInterpolation": "linear",
                         "lineWidth": 1,
                         "pointSize": 5,
                         "scaleDistribution": {
                            "type": "linear"
                         },
                         "showPoints": "auto",
                         "spanNulls": false,
                         "stacking": {
                            "group": "A",
                            "mode": "none"
                         },
                         "thresholdsStyle": {
                            "mode": "off"
                         }
                      },
                      "mappings": [ ],
                      "thresholds": {
                         "mode": "absolute",
                         "steps": [
                            {
                               "color": "green",
                               "value": null
                            },
                            {
                               "color": "red",
                               "value": 80
                            }
                         ]
                      },
                      "unit": "s"
                   },
                   "overrides": [ ]
                },
                "gridPos": {
                   "h": 10,
                   "w": 12,
                   "x": 0,
                   "y": 10
                },
                "id": 6,
                "options": {
                   "legend": {
                      "calcs": [ ],
                      "displayMode": "list",
                      "placement": "bottom"
                   },
                   "tooltip": {
                      "mode": "single"
                   }
                },
                "targets": [
                   {
                      "datasource": "${datasource}",
                      "exemplar": true,
                      "expr": "loki_ruler_wal_prometheus_remote_storage_highest_timestamp_in_seconds{tenant=~\"${tenant}\"}\n- on (tenant)\n  (\n    loki_ruler_wal_prometheus_remote_storage_queue_highest_sent_timestamp_seconds{tenant=~\"${tenant}\"}\n    or vector(0)\n  )",
                      "interval": "",
                      "legendFormat": "{{tenant}}",
                      "refId": "A"
                   }
                ],
                "title": "Write Behind",
                "type": "timeseries"
             },
             {
                "datasource": "${datasource}",
                "description": "",
                "fieldConfig": {
                   "defaults": {
                      "color": {
                         "mode": "palette-classic"
                      },
                      "custom": {
                         "axisLabel": "",
                         "axisPlacement": "auto",
                         "barAlignment": 0,
                         "drawStyle": "line",
                         "fillOpacity": 0,
                         "gradientMode": "none",
                         "hideFrom": {
                            "legend": false,
                            "tooltip": false,
                            "viz": false
                         },
                         "lineInterpolation": "linear",
                         "lineWidth": 1,
                         "pointSize": 5,
                         "scaleDistribution": {
                            "type": "linear"
                         },
                         "showPoints": "auto",
                         "spanNulls": false,
                         "stacking": {
                            "group": "A",
                            "mode": "none"
                         },
                         "thresholdsStyle": {
                            "mode": "off"
                         }
                      },
                      "mappings": [ ],
                      "thresholds": {
                         "mode": "absolute",
                         "steps": [
                            {
                               "color": "green",
                               "value": null
                            },
                            {
                               "color": "red",
                               "value": 80
                            }
                         ]
                      }
                   },
                   "overrides": [ ]
                },
                "gridPos": {
                   "h": 10,
                   "w": 12,
                   "x": 12,
                   "y": 10
                },
                "id": 7,
                "options": {
                   "legend": {
                      "calcs": [ ],
                      "displayMode": "list",
                      "placement": "bottom"
                   },
                   "tooltip": {
                      "mode": "single"
                   }
                },
                "targets": [
                   {
                      "datasource": "${datasource}",
                      "exemplar": true,
                      "expr": "sum(rate(loki_ruler_wal_prometheus_remote_storage_samples_total{tenant=~\"${tenant}\"}[$__rate_interval])) by (tenant) > 0",
                      "interval": "",
                      "legendFormat": "{{tenant}}",
                      "refId": "A"
                   }
                ],
                "title": "Samples Sent per Second",
                "type": "timeseries"
             },
             {
                "datasource": "${datasource}",
                "description": "\n",
                "fieldConfig": {
                   "defaults": {
                      "color": {
                         "mode": "palette-classic"
                      },
                      "custom": {
                         "axisLabel": "",
                         "axisPlacement": "auto",
                         "barAlignment": 0,
                         "drawStyle": "line",
                         "fillOpacity": 0,
                         "gradientMode": "none",
                         "hideFrom": {
                            "legend": false,
                            "tooltip": false,
                            "viz": false
                         },
                         "lineInterpolation": "linear",
                         "lineWidth": 1,
                         "pointSize": 5,
                         "scaleDistribution": {
                            "type": "linear"
                         },
                         "showPoints": "auto",
                         "spanNulls": false,
                         "stacking": {
                            "group": "A",
                            "mode": "none"
                         },
                         "thresholdsStyle": {
                            "mode": "off"
                         }
                      },
                      "mappings": [ ],
                      "thresholds": {
                         "mode": "absolute",
                         "steps": [
                            {
                               "color": "green",
                               "value": null
                            },
                            {
                               "color": "red",
                               "value": 80
                            }
                         ]
                      },
                      "unit": "bytes"
                   },
                   "overrides": [ ]
                },
                "gridPos": {
                   "h": 10,
                   "w": 12,
                   "x": 0,
                   "y": 20
                },
                "id": 8,
                "options": {
                   "legend": {
                      "calcs": [ ],
                      "displayMode": "list",
                      "placement": "bottom"
                   },
                   "tooltip": {
                      "mode": "single"
                   }
                },
                "targets": [
                   {
                      "datasource": "${datasource}",
                      "exemplar": true,
                      "expr": "sum by (tenant) (loki_ruler_wal_disk_size{tenant=~\"${tenant}\"})",
                      "interval": "",
                      "legendFormat": "{{tenant}}",
                      "refId": "A"
                   }
                ],
                "title": "WAL Disk Size",
                "type": "timeseries"
             },
             {
                "datasource": "${datasource}",
                "description": "Some number of pending samples is expected, but if remote-write is failing this value will remain high",
                "fieldConfig": {
                   "defaults": {
                      "color": {
                         "mode": "palette-classic"
                      },
                      "custom": {
                         "axisLabel": "",
                         "axisPlacement": "auto",
                         "barAlignment": 0,
                         "drawStyle": "line",
                         "fillOpacity": 0,
                         "gradientMode": "none",
                         "hideFrom": {
                            "legend": false,
                            "tooltip": false,
                            "viz": false
                         },
                         "lineInterpolation": "linear",
                         "lineWidth": 1,
                         "pointSize": 5,
                         "scaleDistribution": {
                            "type": "linear"
                         },
                         "showPoints": "auto",
                         "spanNulls": false,
                         "stacking": {
                            "group": "A",
                            "mode": "none"
                         },
                         "thresholdsStyle": {
                            "mode": "off"
                         }
                      },
                      "mappings": [ ],
                      "thresholds": {
                         "mode": "absolute",
                         "steps": [
                            {
                               "color": "green",
                               "value": null
                            },
                            {
                               "color": "red",
                               "value": 80
                            }
                         ]
                      }
                   },
                   "overrides": [ ]
                },
                "gridPos": {
                   "h": 10,
                   "w": 12,
                   "x": 12,
                   "y": 20
                },
                "id": 9,
                "options": {
                   "legend": {
                      "calcs": [ ],
                      "displayMode": "list",
                      "placement": "bottom"
                   },
                   "tooltip": {
                      "mode": "single"
                   }
                },
                "targets": [
                   {
                      "datasource": "${datasource}",
                      "exemplar": true,
                      "expr": "max(loki_ruler_wal_prometheus_remote_storage_samples_pending{tenant=~\"${tenant}\"}) by (tenant,pod) > 0",
                      "interval": "",
                      "legendFormat": "{{tenant}}",
                      "refId": "A"
                   }
                ],
                "title": "Pending Samples",
                "type": "timeseries"
             }
          ],
          "refresh": "10s",
          "rows": [ ],
          "schemaVersion": 14,
          "style": "dark",
          "tags": [
             "loki"
          ],
          "templating": {
             "list": [
                {
                   "current": {
                      "text": "default",
                      "value": "default"
                   },
                   "hide": 0,
                   "label": "Data source",
                   "name": "datasource",
                   "options": [ ],
                   "query": "prometheus",
                   "refresh": 1,
                   "regex": "",
                   "type": "datasource"
                },
                {
                   "allValue": null,
                   "current": {
                      "text": "prod",
                      "value": "prod"
                   },
                   "datasource": "$datasource",
                   "hide": 0,
                   "includeAll": false,
                   "label": "cluster",
                   "multi": false,
                   "name": "cluster",
                   "options": [ ],
                   "query": "label_values(loki_build_info, cluster)",
                   "refresh": 1,
                   "regex": "",
                   "sort": 2,
                   "tagValuesQuery": "",
                   "tags": [ ],
                   "tagsQuery": "",
                   "type": "query",
                   "useTags": false
                },
                {
                   "allValue": null,
                   "current": {
                      "text": "prod",
                      "value": "prod"
                   },
                   "datasource": "$datasource",
                   "hide": 0,
                   "includeAll": false,
                   "label": "namespace",
                   "multi": false,
                   "name": "namespace",
                   "options": [ ],
                   "query": "label_values(loki_build_info{cluster=~\"$cluster\"}, namespace)",
                   "refresh": 1,
                   "regex": "",
                   "sort": 2,
                   "tagValuesQuery": "",
                   "tags": [ ],
                   "tagsQuery": "",
                   "type": "query",
                   "useTags": false
                },
                {
                   "hide": 0,
                   "label": null,
                   "name": "loki_datasource",
                   "options": [ ],
                   "query": "loki",
                   "refresh": 1,
                   "regex": "",
                   "type": "datasource"
                },
                {
                   "allValue": ".+",
                   "current": { },
                   "datasource": "$datasource",
                   "hide": 0,
                   "includeAll": true,
                   "label": null,
                   "multi": false,
                   "name": "tenant",
                   "options": [ ],
                   "query": "query_result(sum by (id) (grafanacloud_logs_instance_info) and sum(label_replace(loki_tenant:active_streams{cluster=\"$cluster\",namespace=\"$namespace\"},\"id\",\"$1\",\"tenant\",\"(.*)\")) by(id))",
                   "refresh": 0,
                   "regex": "/\"([^\"]+)\"/",
                   "sort": 1,
                   "tagValuesQuery": "",
                   "tags": [ ],
                   "tagsQuery": "",
                   "type": "query",
                   "useTags": false
                }
             ]
          },
          "time": {
             "from": "now-1h",
             "to": "now"
          },
          "timepicker": {
             "refresh_intervals": [
                "5s",
                "10s",
                "30s",
                "1m",
                "5m",
                "15m",
                "30m",
                "1h",
                "2h",
                "1d"
             ],
             "time_options": [
                "5m",
                "15m",
                "1h",
                "6h",
                "12h",
                "24h",
                "2d",
                "7d",
                "30d"
             ]
          },
          "timezone": "utc",
          "title": "Loki / Recording Rules",
          "uid": "recording-rules",
          "version": 0,
          "weekStart": ""
       }
kind: ConfigMap
metadata:
  annotations:
    grafana_dashboard_folder: /dashboards/Loki Mixin
  labels:
    grafana_dashboard: "1"
  name: loki-mixin-recording-rules.json
  namespace: monitoring-system
---
apiVersion: v1
data:
  loki-operational.json: |-
    {
          "annotations": {
             "list": [ ]
          },
          "editable": true,
          "gnetId": null,
          "graphTooltip": 0,
          "hideControls": false,
          "iteration": 1588704280892,
          "links": [
             {
                "asDropdown": true,
                "icon": "external link",
                "includeVars": true,
                "keepTime": true,
                "tags": [
                   "loki"
                ],
                "targetBlank": false,
                "title": "Loki Dashboards",
                "type": "dashboards"
             }
          ],
          "panels": [
             {
                "collapsed": false,
                "datasource": null,
                "gridPos": {
                   "h": 1,
                   "w": 24,
                   "x": 0,
                   "y": 0
                },
                "id": 17,
                "panels": [ ],
                "targets": [ ],
                "title": "Main",
                "type": "row"
             },
             {
                "aliasColors": {
                   "5xx": "red"
                },
                "bars": false,
                "dashLength": 10,
                "dashes": false,
                "datasource": "$datasource",
                "fieldConfig": {
                   "defaults": {
                      "custom": { }
                   },
                   "overrides": [ ]
                },
                "fill": 1,
                "fillGradient": 0,
                "gridPos": {
                   "h": 5,
                   "w": 4,
                   "x": 0,
                   "y": 1
                },
                "hiddenSeries": false,
                "id": 6,
                "legend": {
                   "avg": false,
                   "current": false,
                   "max": false,
                   "min": false,
                   "show": true,
                   "total": false,
                   "values": false
                },
                "lines": true,
                "linewidth": 1,
                "nullPointMode": "null",
                "options": {
                   "dataLinks": [ ]
                },
                "panels": [ ],
                "percentage": false,
                "pointradius": 2,
                "points": false,
                "renderer": "flot",
                "seriesOverrides": [ ],
                "spaceLength": 10,
                "stack": false,
                "steppedLine": false,
                "targets": [
                   {
                      "expr": "sum by (status) (\nlabel_replace(\n  label_replace(\n        rate(loki_request_duration_seconds_count{cluster=\"$cluster\", job=~\"($namespace)/query-frontend\", route=~\"api_prom_query|api_prom_label|api_prom_label_name_values|loki_api_v1_query|loki_api_v1_query_range|loki_api_v1_label|loki_api_v1_label_name_values\"}[$__rate_interval]),\n  \"status\", \"${1}xx\", \"status_code\", \"([0-9])..\"),\n\"status\", \"${1}\", \"status_code\", \"([a-z]+)\")\n)",
                      "legendFormat": "{{status}}",
                      "refId": "A"
                   }
                ],
                "thresholds": [ ],
                "timeFrom": null,
                "timeRegions": [ ],
                "timeShift": null,
                "title": "Queries/Second",
                "tooltip": {
                   "shared": true,
                   "sort": 0,
                   "value_type": "individual"
                },
                "type": "timeseries",
                "xaxis": {
                   "buckets": null,
                   "mode": "time",
                   "name": null,
                   "show": true,
                   "values": [ ]
                },
                "yaxes": [
                   {
                      "format": "short",
                      "label": null,
                      "logBase": 10,
                      "max": null,
                      "min": null,
                      "show": true
                   },
                   {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   }
                ],
                "yaxis": {
                   "align": false,
                   "alignLevel": null
                }
             },
             {
                "aliasColors": {
                   "5xx": "red"
                },
                "bars": false,
                "dashLength": 10,
                "dashes": false,
                "datasource": "$datasource",
                "fieldConfig": {
                   "defaults": {
                      "custom": { }
                   },
                   "overrides": [ ]
                },
                "fill": 1,
                "fillGradient": 0,
                "gridPos": {
                   "h": 5,
                   "w": 4,
                   "x": 4,
                   "y": 1
                },
                "hiddenSeries": false,
                "id": 7,
                "legend": {
                   "avg": false,
                   "current": false,
                   "max": false,
                   "min": false,
                   "show": true,
                   "total": false,
                   "values": false
                },
                "lines": true,
                "linewidth": 1,
                "nullPointMode": "null",
                "options": {
                   "dataLinks": [ ]
                },
                "panels": [ ],
                "percentage": false,
                "pointradius": 2,
                "points": false,
                "renderer": "flot",
                "seriesOverrides": [ ],
                "spaceLength": 10,
                "stack": false,
                "steppedLine": false,
                "targets": [
                   {
                      "expr": "sum by (status) (\nlabel_replace(\n  label_replace(\n          rate(loki_request_duration_seconds_count{cluster=\"$cluster\", job=~\"($namespace)/distributor\", route=~\"api_prom_push|loki_api_v1_push\"}[$__rate_interval]),\n   \"status\", \"${1}xx\", \"status_code\", \"([0-9])..\"),\n\"status\", \"${1}\", \"status_code\", \"([a-z]+)\"))",
                      "legendFormat": "{{status}}",
                      "refId": "A"
                   }
                ],
                "thresholds": [ ],
                "timeFrom": null,
                "timeRegions": [ ],
                "timeShift": null,
                "title": "Pushes/Second",
                "tooltip": {
                   "shared": true,
                   "sort": 0,
                   "value_type": "individual"
                },
                "type": "timeseries",
                "xaxis": {
                   "buckets": null,
                   "mode": "time",
                   "name": null,
                   "show": true,
                   "values": [ ]
                },
                "yaxes": [
                   {
                      "format": "short",
                      "label": null,
                      "logBase": 10,
                      "max": null,
                      "min": null,
                      "show": true
                   },
                   {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   }
                ],
                "yaxis": {
                   "align": false,
                   "alignLevel": null
                }
             },
             {
                "aliasColors": { },
                "bars": false,
                "dashLength": 10,
                "dashes": false,
                "datasource": "$datasource",
                "fieldConfig": {
                   "defaults": {
                      "custom": { }
                   },
                   "overrides": [ ]
                },
                "fill": 1,
                "fillGradient": 0,
                "gridPos": {
                   "h": 5,
                   "w": 4,
                   "x": 12,
                   "y": 1
                },
                "hiddenSeries": false,
                "id": 2,
                "interval": "",
                "legend": {
                   "avg": false,
                   "current": false,
                   "max": false,
                   "min": false,
                   "show": false,
                   "total": false,
                   "values": false
                },
                "lines": true,
                "linewidth": 1,
                "nullPointMode": "null",
                "options": {
                   "dataLinks": [ ]
                },
                "panels": [ ],
                "percentage": false,
                "pointradius": 2,
                "points": false,
                "renderer": "flot",
                "seriesOverrides": [ ],
                "spaceLength": 10,
                "stack": false,
                "steppedLine": false,
                "targets": [
                   {
                      "expr": "topk(10, sum(rate(loki_distributor_lines_received_total{cluster=\"$cluster\", namespace=\"$namespace\"}[$__rate_interval])) by (tenant))",
                      "legendFormat": "{{tenant}}",
                      "refId": "A"
                   }
                ],
                "thresholds": [ ],
                "timeFrom": null,
                "timeRegions": [ ],
                "timeShift": null,
                "title": "Lines Per Tenant (top 10)",
                "tooltip": {
                   "shared": false,
                   "sort": 0,
                   "value_type": "individual"
                },
                "type": "timeseries",
                "xaxis": {
                   "buckets": null,
                   "mode": "time",
                   "name": null,
                   "show": true,
                   "values": [ ]
                },
                "yaxes": [
                   {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   },
                   {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   }
                ],
                "yaxis": {
                   "align": false,
                   "alignLevel": null
                }
             },
             {
                "aliasColors": { },
                "bars": false,
                "dashLength": 10,
                "dashes": false,
                "datasource": "$datasource",
                "fieldConfig": {
                   "defaults": {
                      "custom": { },
                      "unit": "MBs"
                   },
                   "overrides": [ ]
                },
                "fill": 1,
                "fillGradient": 0,
                "gridPos": {
                   "h": 5,
                   "w": 4,
                   "x": 16,
                   "y": 1
                },
                "hiddenSeries": false,
                "id": 4,
                "legend": {
                   "avg": false,
                   "current": false,
                   "hideEmpty": true,
                   "hideZero": true,
                   "max": false,
                   "min": false,
                   "show": false,
                   "total": false,
                   "values": false
                },
                "lines": true,
                "linewidth": 1,
                "nullPointMode": "null",
                "options": {
                   "dataLinks": [ ]
                },
                "panels": [ ],
                "percentage": false,
                "pointradius": 2,
                "points": false,
                "renderer": "flot",
                "seriesOverrides": [ ],
                "spaceLength": 10,
                "stack": false,
                "steppedLine": false,
                "targets": [
                   {
                      "expr": "topk(10, sum(rate(loki_distributor_bytes_received_total{cluster=\"$cluster\", namespace=\"$namespace\"}[$__rate_interval])) by (tenant)) / 1024 / 1024",
                      "legendFormat": "{{tenant}}",
                      "refId": "A"
                   }
                ],
                "thresholds": [ ],
                "timeFrom": null,
                "timeRegions": [ ],
                "timeShift": null,
                "title": "MBs Per Tenant (Top 10)",
                "tooltip": {
                   "shared": false,
                   "sort": 0,
                   "value_type": "individual"
                },
                "type": "timeseries",
                "xaxis": {
                   "buckets": null,
                   "mode": "time",
                   "name": null,
                   "show": true,
                   "values": [ ]
                },
                "yaxes": [
                   {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   },
                   {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   }
                ],
                "yaxis": {
                   "align": false,
                   "alignLevel": null
                }
             },
             {
                "aliasColors": { },
                "bars": false,
                "dashLength": 10,
                "dashes": false,
                "datasource": "$datasource",
                "fieldConfig": {
                   "defaults": {
                      "custom": { }
                   },
                   "overrides": [ ]
                },
                "fill": 1,
                "fillGradient": 0,
                "gridPos": {
                   "h": 5,
                   "w": 4,
                   "x": 20,
                   "y": 1
                },
                "hiddenSeries": false,
                "id": 24,
                "legend": {
                   "avg": false,
                   "current": false,
                   "max": false,
                   "min": false,
                   "show": false,
                   "total": false,
                   "values": false
                },
                "lines": true,
                "linewidth": 1,
                "nullPointMode": "null",
                "options": {
                   "dataLinks": [ ]
                },
                "panels": [ ],
                "percentage": false,
                "pointradius": 2,
                "points": false,
                "renderer": "flot",
                "seriesOverrides": [ ],
                "spaceLength": 10,
                "stack": false,
                "steppedLine": false,
                "targets": [
                   {
                      "expr": "increase(kube_pod_container_status_restarts_total{cluster=\"$cluster\", namespace=\"$namespace\"}[10m]) > 0",
                      "hide": false,
                      "interval": "",
                      "legendFormat": "{{container}}-{{pod}}",
                      "refId": "B"
                   }
                ],
                "thresholds": [ ],
                "timeFrom": null,
                "timeRegions": [ ],
                "timeShift": null,
                "title": "Container Restarts",
                "tooltip": {
                   "shared": true,
                   "sort": 2,
                   "value_type": "individual"
                },
                "type": "timeseries",
                "xaxis": {
                   "buckets": null,
                   "mode": "time",
                   "name": null,
                   "show": true,
                   "values": [ ]
                },
                "yaxes": [
                   {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   },
                   {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   }
                ],
                "yaxis": {
                   "align": false,
                   "alignLevel": null
                }
             },
             {
                "aliasColors": { },
                "bars": false,
                "dashLength": 10,
                "dashes": false,
                "datasource": "$datasource",
                "fieldConfig": {
                   "defaults": {
                      "custom": { },
                      "unit": "s"
                   },
                   "overrides": [ ]
                },
                "fill": 1,
                "fillGradient": 0,
                "gridPos": {
                   "h": 10,
                   "w": 12,
                   "x": 0,
                   "y": 6
                },
                "hiddenSeries": false,
                "id": 9,
                "legend": {
                   "alignAsTable": true,
                   "avg": false,
                   "current": false,
                   "max": false,
                   "min": false,
                   "rightSide": true,
                   "show": true,
                   "total": false,
                   "values": false
                },
                "lines": true,
                "linewidth": 1,
                "nullPointMode": "null",
                "options": {
                   "dataLinks": [ ]
                },
                "panels": [ ],
                "percentage": false,
                "pointradius": 2,
                "points": false,
                "renderer": "flot",
                "seriesOverrides": [ ],
                "spaceLength": 10,
                "stack": false,
                "steppedLine": false,
                "targets": [
                   {
                      "expr": "histogram_quantile(0.99, sum by (le) (cluster_job_route:loki_request_duration_seconds_bucket:sum_rate{job=~\"($namespace)/distributor\", route=~\"api_prom_push|loki_api_v1_push\", cluster=~\"$cluster\"})) * 1e3",
                      "legendFormat": ".99",
                      "refId": "A"
                   },
                   {
                      "expr": "histogram_quantile(0.75, sum by (le) (cluster_job_route:loki_request_duration_seconds_bucket:sum_rate{job=~\"($namespace)/distributor\", route=~\"api_prom_push|loki_api_v1_push\", cluster=~\"$cluster\"})) * 1e3",
                      "legendFormat": ".9",
                      "refId": "B"
                   },
                   {
                      "expr": "histogram_quantile(0.5, sum by (le) (cluster_job_route:loki_request_duration_seconds_bucket:sum_rate{job=~\"($namespace)/distributor\", route=~\"api_prom_push|loki_api_v1_push\", cluster=~\"$cluster\"})) * 1e3",
                      "legendFormat": ".5",
                      "refId": "C"
                   }
                ],
                "thresholds": [ ],
                "timeFrom": null,
                "timeRegions": [ ],
                "timeShift": null,
                "title": "Push Latency",
                "tooltip": {
                   "shared": true,
                   "sort": 0,
                   "value_type": "individual"
                },
                "type": "timeseries",
                "xaxis": {
                   "buckets": null,
                   "mode": "time",
                   "name": null,
                   "show": true,
                   "values": [ ]
                },
                "yaxes": [
                   {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   },
                   {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   }
                ],
                "yaxis": {
                   "align": false,
                   "alignLevel": null
                }
             },
             {
                "aliasColors": { },
                "bars": false,
                "dashLength": 10,
                "dashes": false,
                "datasource": "$datasource",
                "fieldConfig": {
                   "defaults": {
                      "custom": { },
                      "unit": "s"
                   },
                   "overrides": [ ]
                },
                "fill": 1,
                "fillGradient": 0,
                "gridPos": {
                   "h": 5,
                   "w": 6,
                   "x": 12,
                   "y": 6
                },
                "hiddenSeries": false,
                "id": 12,
                "legend": {
                   "alignAsTable": true,
                   "avg": false,
                   "current": false,
                   "max": false,
                   "min": false,
                   "rightSide": true,
                   "show": false,
                   "total": false,
                   "values": false
                },
                "lines": true,
                "linewidth": 1,
                "nullPointMode": "null",
                "options": {
                   "dataLinks": [ ]
                },
                "panels": [ ],
                "percentage": false,
                "pointradius": 2,
                "points": false,
                "renderer": "flot",
                "seriesOverrides": [ ],
                "spaceLength": 10,
                "stack": false,
                "steppedLine": false,
                "targets": [
                   {
                      "expr": "histogram_quantile(0.99, sum by (le) (cluster_job:loki_request_duration_seconds_bucket:sum_rate{job=~\"($namespace)/distributor\", cluster=~\"$cluster\"})) * 1e3",
                      "legendFormat": ".99",
                      "refId": "A"
                   },
                   {
                      "expr": "histogram_quantile(0.9, sum by (le) (cluster_job:loki_request_duration_seconds_bucket:sum_rate{job=~\"($namespace)/distributor\", cluster=~\"$cluster\"})) * 1e3",
                      "legendFormat": ".9",
                      "refId": "B"
                   },
                   {
                      "expr": "histogram_quantile(0.5, sum by (le) (cluster_job:loki_request_duration_seconds_bucket:sum_rate{job=~\"($namespace)/distributor\", cluster=~\"$cluster\"})) * 1e3",
                      "legendFormat": ".5",
                      "refId": "C"
                   }
                ],
                "thresholds": [ ],
                "timeFrom": null,
                "timeRegions": [ ],
                "timeShift": null,
                "title": "Distributor Latency",
                "tooltip": {
                   "shared": true,
                   "sort": 0,
                   "value_type": "individual"
                },
                "type": "timeseries",
                "xaxis": {
                   "buckets": null,
                   "mode": "time",
                   "name": null,
                   "show": true,
                   "values": [ ]
                },
                "yaxes": [
                   {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   },
                   {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   }
                ],
                "yaxis": {
                   "align": false,
                   "alignLevel": null
                }
             },
             {
                "aliasColors": { },
                "bars": false,
                "dashLength": 10,
                "dashes": false,
                "datasource": "$datasource",
                "fieldConfig": {
                   "defaults": {
                      "custom": { }
                   },
                   "overrides": [ ]
                },
                "fill": 0,
                "fillGradient": 0,
                "gridPos": {
                   "h": 5,
                   "w": 6,
                   "x": 18,
                   "y": 6
                },
                "hiddenSeries": false,
                "id": 71,
                "legend": {
                   "alignAsTable": true,
                   "avg": false,
                   "current": false,
                   "max": false,
                   "min": false,
                   "rightSide": true,
                   "show": false,
                   "total": false,
                   "values": false
                },
                "lines": true,
                "linewidth": 1,
                "nullPointMode": "null",
                "options": {
                   "dataLinks": [ ]
                },
                "panels": [ ],
                "percentage": false,
                "pointradius": 2,
                "points": false,
                "renderer": "flot",
                "seriesOverrides": [ ],
                "spaceLength": 10,
                "stack": false,
                "steppedLine": false,
                "targets": [
                   {
                      "expr": "sum(rate(loki_request_duration_seconds_count{cluster=\"$cluster\", namespace=\"$namespace\", job=~\"($namespace)/distributor\", status_code!~\"5[0-9]{2}\"}[$__rate_interval])) by (route)\n/\nsum(rate(loki_request_duration_seconds_count{cluster=\"$cluster\", namespace=\"$namespace\", job=~\"($namespace)/distributor\"}[$__rate_interval])) by (route) > 0",
                      "interval": "",
                      "legendFormat": "{{route}}",
                      "refId": "A"
                   }
                ],
                "thresholds": [ ],
                "timeFrom": null,
                "timeRegions": [ ],
                "timeShift": null,
                "title": "Distributor Success Rate",
                "tooltip": {
                   "shared": true,
                   "sort": 0,
                   "value_type": "individual"
                },
                "type": "timeseries",
                "xaxis": {
                   "buckets": null,
                   "mode": "time",
                   "name": null,
                   "show": true,
                   "values": [ ]
                },
                "yaxes": [
                   {
                      "decimals": null,
                      "format": "percentunit",
                      "label": "",
                      "logBase": 1,
                      "max": "1",
                      "min": null,
                      "show": true
                   },
                   {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   }
                ],
                "yaxis": {
                   "align": false,
                   "alignLevel": null
                }
             },
             {
                "aliasColors": { },
                "bars": false,
                "dashLength": 10,
                "dashes": false,
                "datasource": "$datasource",
                "fieldConfig": {
                   "defaults": {
                      "custom": { },
                      "unit": "s"
                   },
                   "overrides": [ ]
                },
                "fill": 1,
                "fillGradient": 0,
                "gridPos": {
                   "h": 5,
                   "w": 6,
                   "x": 12,
                   "y": 11
                },
                "hiddenSeries": false,
                "id": 13,
                "legend": {
                   "alignAsTable": true,
                   "avg": false,
                   "current": false,
                   "max": false,
                   "min": false,
                   "rightSide": true,
                   "show": false,
                   "total": false,
                   "values": false
                },
                "lines": true,
                "linewidth": 1,
                "nullPointMode": "null",
                "options": {
                   "dataLinks": [ ]
                },
                "panels": [ ],
                "percentage": false,
                "pointradius": 2,
                "points": false,
                "renderer": "flot",
                "seriesOverrides": [ ],
                "spaceLength": 10,
                "stack": false,
                "steppedLine": false,
                "targets": [
                   {
                      "expr": "histogram_quantile(0.99, sum by (le) (cluster_job_route:loki_request_duration_seconds_bucket:sum_rate{job=~\"($namespace)/ingester.*\", route=\"/logproto.Pusher/Push\", cluster=~\"$cluster\"})) * 1e3",
                      "legendFormat": ".99",
                      "refId": "A"
                   },
                   {
                      "expr": "histogram_quantile(0.9, sum by (le) (cluster_job_route:loki_request_duration_seconds_bucket:sum_rate{job=~\"($namespace)/ingester.*\", route=\"/logproto.Pusher/Push\", cluster=~\"$cluster\"})) * 1e3",
                      "hide": false,
                      "legendFormat": ".9",
                      "refId": "B"
                   },
                   {
                      "expr": "histogram_quantile(0.5, sum by (le) (cluster_job_route:loki_request_duration_seconds_bucket:sum_rate{job=~\"($namespace)/ingester.*\", route=\"/logproto.Pusher/Push\", cluster=~\"$cluster\"})) * 1e3",
                      "hide": false,
                      "legendFormat": ".5",
                      "refId": "C"
                   }
                ],
                "thresholds": [ ],
                "timeFrom": null,
                "timeRegions": [ ],
                "timeShift": null,
                "title": "Ingester Latency Write",
                "tooltip": {
                   "shared": true,
                   "sort": 0,
                   "value_type": "individual"
                },
                "type": "timeseries",
                "xaxis": {
                   "buckets": null,
                   "mode": "time",
                   "name": null,
                   "show": true,
                   "values": [ ]
                },
                "yaxes": [
                   {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   },
                   {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   }
                ],
                "yaxis": {
                   "align": false,
                   "alignLevel": null
                }
             },
             {
                "aliasColors": { },
                "bars": false,
                "dashLength": 10,
                "dashes": false,
                "datasource": "$datasource",
                "fieldConfig": {
                   "defaults": {
                      "custom": { }
                   },
                   "overrides": [ ]
                },
                "fill": 0,
                "fillGradient": 0,
                "gridPos": {
                   "h": 5,
                   "w": 6,
                   "x": 18,
                   "y": 11
                },
                "hiddenSeries": false,
                "id": 72,
                "legend": {
                   "alignAsTable": true,
                   "avg": false,
                   "current": false,
                   "max": false,
                   "min": false,
                   "rightSide": true,
                   "show": false,
                   "total": false,
                   "values": false
                },
                "lines": true,
                "linewidth": 1,
                "nullPointMode": "null",
                "options": {
                   "dataLinks": [ ]
                },
                "panels": [ ],
                "percentage": false,
                "pointradius": 2,
                "points": false,
                "renderer": "flot",
                "seriesOverrides": [ ],
                "spaceLength": 10,
                "stack": false,
                "steppedLine": false,
                "targets": [
                   {
                      "expr": "sum(rate(loki_request_duration_seconds_count{cluster=\"$cluster\", namespace=\"$namespace\", job=~\"($namespace)/ingester.*\", status_code!~\"5[0-9]{2}\", route=\"/logproto.Pusher/Push\"}[$__rate_interval])) by (route)\n/\nsum(rate(loki_request_duration_seconds_count{cluster=\"$cluster\", namespace=\"$namespace\", job=~\"($namespace)/ingester.*\", route=\"/logproto.Pusher/Push\"}[$__rate_interval])) by (route) > 0",
                      "interval": "",
                      "legendFormat": "{{route}}",
                      "refId": "A"
                   }
                ],
                "thresholds": [ ],
                "timeFrom": null,
                "timeRegions": [ ],
                "timeShift": null,
                "title": "Ingester Success Rate Write",
                "tooltip": {
                   "shared": true,
                   "sort": 0,
                   "value_type": "individual"
                },
                "type": "timeseries",
                "xaxis": {
                   "buckets": null,
                   "mode": "time",
                   "name": null,
                   "show": true,
                   "values": [ ]
                },
                "yaxes": [
                   {
                      "decimals": null,
                      "format": "percentunit",
                      "label": "",
                      "logBase": 1,
                      "max": "1",
                      "min": null,
                      "show": true
                   },
                   {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   }
                ],
                "yaxis": {
                   "align": false,
                   "alignLevel": null
                }
             },
             {
                "aliasColors": { },
                "bars": false,
                "dashLength": 10,
                "dashes": false,
                "datasource": "$datasource",
                "fieldConfig": {
                   "defaults": {
                      "custom": { },
                      "unit": "s"
                   },
                   "overrides": [ ]
                },
                "fill": 1,
                "fillGradient": 0,
                "gridPos": {
                   "h": 10,
                   "w": 12,
                   "x": 0,
                   "y": 16
                },
                "hiddenSeries": false,
                "id": 10,
                "legend": {
                   "alignAsTable": true,
                   "avg": false,
                   "current": false,
                   "hideEmpty": true,
                   "hideZero": false,
                   "max": false,
                   "min": false,
                   "rightSide": true,
                   "show": true,
                   "total": false,
                   "values": false
                },
                "lines": true,
                "linewidth": 1,
                "nullPointMode": "null",
                "options": {
                   "dataLinks": [ ]
                },
                "panels": [ ],
                "percentage": false,
                "pointradius": 2,
                "points": false,
                "renderer": "flot",
                "seriesOverrides": [ ],
                "spaceLength": 10,
                "stack": false,
                "steppedLine": false,
                "targets": [
                   {
                      "expr": "histogram_quantile(0.99, sum by (le,route) (cluster_job_route:loki_request_duration_seconds_bucket:sum_rate{job=~\"($namespace)/querier\", route=~\"api_prom_query|api_prom_labels|api_prom_label_name_values|loki_api_v1_query|loki_api_v1_query_range|loki_api_v1_label|loki_api_v1_label_name_values\", cluster=\"$cluster\"}))",
                      "legendFormat": "{{route}}-.99",
                      "refId": "A"
                   },
                   {
                      "expr": "histogram_quantile(0.9, sum by (le,route) (cluster_job_route:loki_request_duration_seconds_bucket:sum_rate{job=~\"($namespace)/querier\", route=~\"api_prom_query|api_prom_labels|api_prom_label_name_values|loki_api_v1_query|loki_api_v1_query_range|loki_api_v1_label|loki_api_v1_label_name_values\", cluster=\"$cluster\"}))",
                      "legendFormat": "{{route}}-.9",
                      "refId": "B"
                   },
                   {
                      "expr": "histogram_quantile(0.5, sum by (le,route) (cluster_job_route:loki_request_duration_seconds_bucket:sum_rate{job=~\"($namespace)/querier\", route=~\"api_prom_query|api_prom_labels|api_prom_label_name_values|loki_api_v1_query|loki_api_v1_query_range|loki_api_v1_label|loki_api_v1_label_name_values\", cluster=\"$cluster\"}))",
                      "legendFormat": "{{route}}-.5",
                      "refId": "C"
                   }
                ],
                "thresholds": [ ],
                "timeFrom": null,
                "timeRegions": [ ],
                "timeShift": null,
                "title": "Query Latency",
                "tooltip": {
                   "shared": true,
                   "sort": 0,
                   "value_type": "individual"
                },
                "type": "timeseries",
                "xaxis": {
                   "buckets": null,
                   "mode": "time",
                   "name": null,
                   "show": true,
                   "values": [ ]
                },
                "yaxes": [
                   {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   },
                   {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   }
                ],
                "yaxis": {
                   "align": false,
                   "alignLevel": null
                }
             },
             {
                "aliasColors": { },
                "bars": false,
                "dashLength": 10,
                "dashes": false,
                "datasource": "$datasource",
                "fieldConfig": {
                   "defaults": {
                      "custom": { },
                      "unit": "s"
                   },
                   "overrides": [ ]
                },
                "fill": 1,
                "fillGradient": 0,
                "gridPos": {
                   "h": 5,
                   "w": 6,
                   "x": 12,
                   "y": 16
                },
                "hiddenSeries": false,
                "id": 14,
                "legend": {
                   "alignAsTable": true,
                   "avg": false,
                   "current": false,
                   "max": false,
                   "min": false,
                   "rightSide": true,
                   "show": false,
                   "total": false,
                   "values": false
                },
                "lines": true,
                "linewidth": 1,
                "nullPointMode": "null",
                "options": {
                   "dataLinks": [ ]
                },
                "panels": [ ],
                "percentage": false,
                "pointradius": 2,
                "points": false,
                "renderer": "flot",
                "seriesOverrides": [ ],
                "spaceLength": 10,
                "stack": false,
                "steppedLine": false,
                "targets": [
                   {
                      "expr": "histogram_quantile(0.99, sum by (le,route) (cluster_job_route:loki_request_duration_seconds_bucket:sum_rate{job=~\"($namespace)/querier\", route=~\"api_prom_query|api_prom_labels|api_prom_label_name_values|loki_api_v1_query|loki_api_v1_query_range|loki_api_v1_label|loki_api_v1_label_name_values\", cluster=\"$cluster\"})) * 1e3",
                      "legendFormat": ".99-{{route}}",
                      "refId": "A"
                   },
                   {
                      "expr": "histogram_quantile(0.9, sum by (le,route) (cluster_job_route:loki_request_duration_seconds_bucket:sum_rate{job=~\"($namespace)/querier\", route=~\"api_prom_query|api_prom_labels|api_prom_label_name_values|loki_api_v1_query|loki_api_v1_query_range|loki_api_v1_label|loki_api_v1_label_name_values\", cluster=\"$cluster\"})) * 1e3",
                      "legendFormat": ".9-{{route}}",
                      "refId": "B"
                   },
                   {
                      "expr": "histogram_quantile(0.5, sum by (le,route) (cluster_job_route:loki_request_duration_seconds_bucket:sum_rate{job=~\"($namespace)/querier\", route=~\"api_prom_query|api_prom_labels|api_prom_label_name_values|loki_api_v1_query|loki_api_v1_query_range|loki_api_v1_label|loki_api_v1_label_name_values\", cluster=\"$cluster\"})) * 1e3",
                      "legendFormat": ".5-{{route}}",
                      "refId": "C"
                   }
                ],
                "thresholds": [ ],
                "timeFrom": null,
                "timeRegions": [ ],
                "timeShift": null,
                "title": "Querier Latency",
                "tooltip": {
                   "shared": true,
                   "sort": 0,
                   "value_type": "individual"
                },
                "type": "timeseries",
                "xaxis": {
                   "buckets": null,
                   "mode": "time",
                   "name": null,
                   "show": true,
                   "values": [ ]
                },
                "yaxes": [
                   {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   },
                   {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   }
                ],
                "yaxis": {
                   "align": false,
                   "alignLevel": null
                }
             },
             {
                "aliasColors": { },
                "bars": false,
                "dashLength": 10,
                "dashes": false,
                "datasource": "$datasource",
                "fieldConfig": {
                   "defaults": {
                      "custom": { }
                   },
                   "overrides": [ ]
                },
                "fill": 0,
                "fillGradient": 0,
                "gridPos": {
                   "h": 5,
                   "w": 6,
                   "x": 18,
                   "y": 16
                },
                "hiddenSeries": false,
                "id": 73,
                "legend": {
                   "alignAsTable": true,
                   "avg": false,
                   "current": false,
                   "max": false,
                   "min": false,
                   "rightSide": true,
                   "show": false,
                   "total": false,
                   "values": false
                },
                "lines": true,
                "linewidth": 1,
                "nullPointMode": "null",
                "options": {
                   "dataLinks": [ ]
                },
                "panels": [ ],
                "percentage": false,
                "pointradius": 2,
                "points": false,
                "renderer": "flot",
                "seriesOverrides": [ ],
                "spaceLength": 10,
                "stack": false,
                "steppedLine": false,
                "targets": [
                   {
                      "expr": "sum(rate(loki_request_duration_seconds_count{cluster=\"$cluster\", namespace=\"$namespace\", job=~\"($namespace)/querier\", status_code!~\"5[0-9]{2}\"}[$__rate_interval])) by (route)\n/\nsum(rate(loki_request_duration_seconds_count{cluster=\"$cluster\", namespace=\"$namespace\", job=~\"($namespace)/querier\"}[$__rate_interval])) by (route) > 0",
                      "interval": "",
                      "legendFormat": "{{route}}",
                      "refId": "A"
                   }
                ],
                "thresholds": [ ],
                "timeFrom": null,
                "timeRegions": [ ],
                "timeShift": null,
                "title": "Querier Success Rate",
                "tooltip": {
                   "shared": true,
                   "sort": 0,
                   "value_type": "individual"
                },
                "type": "timeseries",
                "xaxis": {
                   "buckets": null,
                   "mode": "time",
                   "name": null,
                   "show": true,
                   "values": [ ]
                },
                "yaxes": [
                   {
                      "decimals": null,
                      "format": "percentunit",
                      "label": "",
                      "logBase": 1,
                      "max": "1",
                      "min": null,
                      "show": true
                   },
                   {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   }
                ],
                "yaxis": {
                   "align": false,
                   "alignLevel": null
                }
             },
             {
                "aliasColors": { },
                "bars": false,
                "dashLength": 10,
                "dashes": false,
                "datasource": "$datasource",
                "description": "",
                "fieldConfig": {
                   "defaults": {
                      "custom": { },
                      "unit": "s"
                   },
                   "overrides": [ ]
                },
                "fill": 1,
                "fillGradient": 0,
                "gridPos": {
                   "h": 5,
                   "w": 6,
                   "x": 12,
                   "y": 21
                },
                "hiddenSeries": false,
                "id": 15,
                "legend": {
                   "alignAsTable": true,
                   "avg": false,
                   "current": false,
                   "max": false,
                   "min": false,
                   "rightSide": true,
                   "show": false,
                   "total": false,
                   "values": false
                },
                "lines": true,
                "linewidth": 1,
                "nullPointMode": "null",
                "options": {
                   "dataLinks": [ ]
                },
                "panels": [ ],
                "percentage": false,
                "pointradius": 2,
                "points": false,
                "renderer": "flot",
                "seriesOverrides": [ ],
                "spaceLength": 10,
                "stack": false,
                "steppedLine": false,
                "targets": [
                   {
                      "expr": "histogram_quantile(0.99, sum by (le,route) (cluster_job_route:loki_request_duration_seconds_bucket:sum_rate{job=~\"($namespace)/ingester.*\", route=~\"/logproto.Querier/Query|/logproto.Querier/Label|/logproto.Querier/Series|/logproto.Querier/QuerySample|/logproto.Querier/GetChunkIDs\", cluster=\"$cluster\"})) * 1e3",
                      "legendFormat": ".99-{{route}}",
                      "refId": "A"
                   },
                   {
                      "expr": "histogram_quantile(0.9, sum by (le,route) (cluster_job_route:loki_request_duration_seconds_bucket:sum_rate{job=~\"($namespace)/ingester.*\", route=~\"/logproto.Querier/Query|/logproto.Querier/Label|/logproto.Querier/Series|/logproto.Querier/QuerySample|/logproto.Querier/GetChunkIDs\", cluster=\"$cluster\"})) * 1e3",
                      "legendFormat": ".9-{{route}}",
                      "refId": "B"
                   },
                   {
                      "expr": "histogram_quantile(0.5, sum by (le,route) (cluster_job_route:loki_request_duration_seconds_bucket:sum_rate{job=~\"($namespace)/ingester.*\", route=~\"/logproto.Querier/Query|/logproto.Querier/Label|/logproto.Querier/Series|/logproto.Querier/QuerySample|/logproto.Querier/GetChunkIDs\", cluster=\"$cluster\"})) * 1e3",
                      "legendFormat": ".5-{{route}}",
                      "refId": "C"
                   }
                ],
                "thresholds": [ ],
                "timeFrom": null,
                "timeRegions": [ ],
                "timeShift": null,
                "title": "Ingester Latency Read",
                "tooltip": {
                   "shared": true,
                   "sort": 0,
                   "value_type": "individual"
                },
                "type": "timeseries",
                "xaxis": {
                   "buckets": null,
                   "mode": "time",
                   "name": null,
                   "show": true,
                   "values": [ ]
                },
                "yaxes": [
                   {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   },
                   {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   }
                ],
                "yaxis": {
                   "align": false,
                   "alignLevel": null
                }
             },
             {
                "aliasColors": { },
                "bars": false,
                "dashLength": 10,
                "dashes": false,
                "datasource": "$datasource",
                "fieldConfig": {
                   "defaults": {
                      "custom": { }
                   },
                   "overrides": [ ]
                },
                "fill": 0,
                "fillGradient": 0,
                "gridPos": {
                   "h": 5,
                   "w": 6,
                   "x": 18,
                   "y": 21
                },
                "hiddenSeries": false,
                "id": 74,
                "legend": {
                   "alignAsTable": true,
                   "avg": false,
                   "current": false,
                   "max": false,
                   "min": false,
                   "rightSide": true,
                   "show": false,
                   "total": false,
                   "values": false
                },
                "lines": true,
                "linewidth": 1,
                "nullPointMode": "null",
                "options": {
                   "dataLinks": [ ]
                },
                "panels": [ ],
                "percentage": false,
                "pointradius": 2,
                "points": false,
                "renderer": "flot",
                "seriesOverrides": [ ],
                "spaceLength": 10,
                "stack": false,
                "steppedLine": false,
                "targets": [
                   {
                      "expr": "sum(rate(loki_request_duration_seconds_count{cluster=\"$cluster\", namespace=\"$namespace\", job=~\"($namespace)/ingester.*\", status_code!~\"5[0-9]{2}\", route=~\"/logproto.Querier/Query|/logproto.Querier/Label|/logproto.Querier/Series|/logproto.Querier/QuerySample|/logproto.Querier/GetChunkIDs\"}[$__rate_interval])) by (route)\n/\nsum(rate(loki_request_duration_seconds_count{cluster=\"$cluster\", namespace=\"$namespace\", job=~\"($namespace)/ingester.*\", route=~\"/logproto.Querier/Query|/logproto.Querier/Label|/logproto.Querier/Series|/logproto.Querier/QuerySample|/logproto.Querier/GetChunkIDs\"}[$__rate_interval])) by (route) > 0",
                      "interval": "",
                      "legendFormat": "{{route}}",
                      "refId": "A"
                   }
                ],
                "thresholds": [ ],
                "timeFrom": null,
                "timeRegions": [ ],
                "timeShift": null,
                "title": "Ingester Success Rate Read",
                "tooltip": {
                   "shared": true,
                   "sort": 0,
                   "value_type": "individual"
                },
                "type": "timeseries",
                "xaxis": {
                   "buckets": null,
                   "mode": "time",
                   "name": null,
                   "show": true,
                   "values": [ ]
                },
                "yaxes": [
                   {
                      "decimals": null,
                      "format": "percentunit",
                      "label": "",
                      "logBase": 1,
                      "max": "1",
                      "min": null,
                      "show": true
                   },
                   {
                      "format": "short",
                      "label": null,
                      "logBase": 1,
                      "max": null,
                      "min": null,
                      "show": true
                   }
                ],
                "yaxis": {
                   "align": false,
                   "alignLevel": null
                }
             },
             {
                "collapsed": true,
                "datasource": null,
                "gridPos": {
                   "h": 1,
                   "w": 24,
                   "x": 0,
                   "y": 26
                },
                "id": 110,
                "panels": [
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 8,
                         "w": 12,
                         "x": 0,
                         "y": 27
                      },
                      "hiddenSeries": false,
                      "id": 112,
                      "legend": {
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "show": false,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 2,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "topk(10,sum by (tenant, reason) (rate(loki_discarded_samples_total{cluster=\"$cluster\",namespace=\"$namespace\"}[$__rate_interval])))",
                            "interval": "",
                            "legendFormat": "{{ tenant }} - {{ reason }}",
                            "refId": "A"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "Discarded Lines",
                      "tooltip": {
                         "shared": false,
                         "sort": 0,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   },
                   {
                      "columns": [ ],
                      "datasource": "$datasource",
                      "fontSize": "100%",
                      "gridPos": {
                         "h": 8,
                         "w": 12,
                         "x": 12,
                         "y": 27
                      },
                      "id": 113,
                      "pageSize": null,
                      "panels": [ ],
                      "showHeader": true,
                      "sort": {
                         "col": 3,
                         "desc": true
                      },
                      "styles": [
                         {
                            "alias": "Time",
                            "align": "auto",
                            "dateFormat": "YYYY-MM-DD HH:mm:ss",
                            "pattern": "Time",
                            "type": "hidden"
                         },
                         {
                            "alias": "",
                            "align": "auto",
                            "colorMode": null,
                            "colors": [
                               "rgba(245, 54, 54, 0.9)",
                               "rgba(237, 129, 40, 0.89)",
                               "rgba(50, 172, 45, 0.97)"
                            ],
                            "dateFormat": "YYYY-MM-DD HH:mm:ss",
                            "decimals": 2,
                            "mappingType": 1,
                            "pattern": "tenant",
                            "thresholds": [ ],
                            "type": "string",
                            "unit": "short"
                         },
                         {
                            "alias": "",
                            "align": "auto",
                            "colorMode": null,
                            "colors": [
                               "rgba(245, 54, 54, 0.9)",
                               "rgba(237, 129, 40, 0.89)",
                               "rgba(50, 172, 45, 0.97)"
                            ],
                            "dateFormat": "YYYY-MM-DD HH:mm:ss",
                            "decimals": 2,
                            "mappingType": 1,
                            "pattern": "reason",
                            "thresholds": [ ],
                            "type": "number",
                            "unit": "short"
                         },
                         {
                            "alias": "",
                            "align": "right",
                            "colorMode": null,
                            "colors": [
                               "rgba(245, 54, 54, 0.9)",
                               "rgba(237, 129, 40, 0.89)",
                               "rgba(50, 172, 45, 0.97)"
                            ],
                            "decimals": 2,
                            "pattern": "/.*/",
                            "thresholds": [ ],
                            "type": "number",
                            "unit": "short"
                         }
                      ],
                      "targets": [
                         {
                            "expr": "topk(10, sum by (tenant, reason) (sum_over_time(increase(loki_discarded_samples_total{cluster=\"$cluster\",namespace=\"$namespace\"}[$__rate_interval])[$__range:$__rate_interval])))",
                            "format": "table",
                            "instant": true,
                            "interval": "",
                            "legendFormat": "{{ tenant }} - {{ reason }}",
                            "refId": "A"
                         }
                      ],
                      "timeFrom": null,
                      "timeShift": null,
                      "title": "Discarded Lines Per Interval",
                      "transform": "table",
                      "type": "table-old"
                   }
                ],
                "targets": [ ],
                "title": "Limits",
                "type": "row"
             },
             {
                "collapsed": true,
                "datasource": null,
                "gridPos": {
                   "h": 1,
                   "w": 24,
                   "x": 0,
                   "y": 27
                },
                "id": 23,
                "panels": [
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 7,
                         "w": 6,
                         "x": 0,
                         "y": 28
                      },
                      "hiddenSeries": false,
                      "id": 26,
                      "legend": {
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "show": false,
                         "total": false,
                         "values": false
                      },
                      "lines": false,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 1,
                      "points": true,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "sum by(pod) (rate(container_cpu_usage_seconds_total{cluster=~\"$cluster\", namespace=~\"$namespace\", pod=~\"distributor.*\"}[$__rate_interval]))",
                            "intervalFactor": 3,
                            "legendFormat": "{{pod}}",
                            "refId": "A"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "CPU Usage",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   },
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "unit": "binBps"
                         }
                      },
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 7,
                         "w": 6,
                         "x": 6,
                         "y": 28
                      },
                      "hiddenSeries": false,
                      "id": 27,
                      "legend": {
                         "avg": false,
                         "current": false,
                         "hideEmpty": false,
                         "hideZero": false,
                         "max": false,
                         "min": false,
                         "show": false,
                         "total": false,
                         "values": false
                      },
                      "lines": false,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 1,
                      "points": true,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "go_memstats_heap_inuse_bytes{cluster=\"$cluster\", namespace=\"$namespace\", pod=~\"distributor.*\"}",
                            "instant": false,
                            "intervalFactor": 3,
                            "legendFormat": "{{pod}}",
                            "refId": "A"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "Memory Usage",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "bytes",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   },
                   {
                      "aliasColors": { },
                      "bars": true,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$loki_datasource",
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 4,
                         "w": 12,
                         "x": 12,
                         "y": 28
                      },
                      "hiddenSeries": false,
                      "id": 31,
                      "legend": {
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "show": false,
                         "total": false,
                         "values": false
                      },
                      "lines": false,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 2,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [
                         {
                            "alias": "{}",
                            "color": "#C4162A"
                         }
                      ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "sum(rate({cluster=\"$cluster\", namespace=\"$namespace\", job=~\"($namespace)/distributor\"} | logfmt | level=\"error\"[$__auto]))",
                            "refId": "A"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "Error Log Rate",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": false,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": false
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   },
                   {
                      "datasource": "$loki_datasource",
                      "gridPos": {
                         "h": 18,
                         "w": 12,
                         "x": 12,
                         "y": 32
                      },
                      "id": 29,
                      "options": {
                         "showLabels": false,
                         "showTime": false,
                         "sortOrder": "Descending",
                         "wrapLogMessage": true
                      },
                      "panels": [ ],
                      "targets": [
                         {
                            "expr": "{cluster=\"$cluster\", namespace=\"$namespace\", job=~\"($namespace)/distributor\"} |= \"level=error\"",
                            "refId": "A"
                         }
                      ],
                      "timeFrom": null,
                      "timeShift": null,
                      "title": "Logs",
                      "type": "logs"
                   },
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fill": 0,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 7,
                         "w": 6,
                         "x": 0,
                         "y": 35
                      },
                      "hiddenSeries": false,
                      "id": 33,
                      "legend": {
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "show": false,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 1,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "sum(rate(loki_request_duration_seconds_count{cluster=\"$cluster\", namespace=\"$namespace\", job=~\"($namespace)/distributor\", status_code!~\"5[0-9]{2}\"}[$__rate_interval])) by (route)\n/\nsum(rate(loki_request_duration_seconds_count{cluster=\"$cluster\", namespace=\"$namespace\", job=~\"($namespace)/distributor\"}[$__rate_interval])) by (route) > 0",
                            "interval": "",
                            "intervalFactor": 1,
                            "legendFormat": "{{route}}",
                            "refId": "A"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "Success Rate",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   },
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "unit": "binBps"
                         }
                      },
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 7,
                         "w": 6,
                         "x": 6,
                         "y": 35
                      },
                      "hiddenSeries": false,
                      "id": 32,
                      "legend": {
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "show": false,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 1,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "sum(rate(loki_distributor_ingester_append_failures_total{cluster=\"$cluster\", namespace=\"$namespace\"}[$__rate_interval])) by (pod)",
                            "intervalFactor": 1,
                            "legendFormat": "{{pod}}",
                            "refId": "A"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "Append Failures By Ingester",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   },
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "unit": "binBps"
                         }
                      },
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 7,
                         "w": 6,
                         "x": 0,
                         "y": 42
                      },
                      "hiddenSeries": false,
                      "id": 34,
                      "legend": {
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "show": false,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 1,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "sum(rate(loki_distributor_bytes_received_total{cluster=\"$cluster\", namespace=\"$namespace\"}[$__rate_interval])) by (pod)",
                            "intervalFactor": 1,
                            "legendFormat": "{{pod}}",
                            "refId": "A"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "Bytes Received/Second",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   },
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "unit": "ops"
                         }
                      },
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 7,
                         "w": 6,
                         "x": 6,
                         "y": 42
                      },
                      "hiddenSeries": false,
                      "id": 35,
                      "legend": {
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "show": false,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 1,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "sum(rate(loki_distributor_lines_received_total{cluster=\"$cluster\", namespace=\"$namespace\"}[$__rate_interval])) by (pod)",
                            "intervalFactor": 1,
                            "legendFormat": "{{pod}}",
                            "refId": "A"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "Lines Received/Second",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   }
                ],
                "targets": [ ],
                "title": "Distributor",
                "type": "row"
             },
             {
                "collapsed": true,
                "datasource": null,
                "gridPos": {
                   "h": 1,
                   "w": 24,
                   "x": 0,
                   "y": 28
                },
                "id": 19,
                "panels": [
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 7,
                         "w": 6,
                         "x": 0,
                         "y": 29
                      },
                      "hiddenSeries": false,
                      "id": 36,
                      "legend": {
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "show": false,
                         "total": false,
                         "values": false
                      },
                      "lines": false,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 1,
                      "points": true,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "sum by(pod) (rate(container_cpu_usage_seconds_total{cluster=~\"$cluster\", namespace=~\"$namespace\", pod=~\"ingester.*\"}[$__rate_interval]))",
                            "intervalFactor": 3,
                            "legendFormat": "{{pod}}",
                            "refId": "A"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "CPU Usage",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   },
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "unit": "binBps"
                         }
                      },
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 7,
                         "w": 6,
                         "x": 0,
                         "y": 36
                      },
                      "hiddenSeries": false,
                      "id": 37,
                      "legend": {
                         "avg": false,
                         "current": false,
                         "hideEmpty": false,
                         "hideZero": false,
                         "max": false,
                         "min": false,
                         "show": false,
                         "total": false,
                         "values": false
                      },
                      "lines": false,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 1,
                      "points": true,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "go_memstats_heap_inuse_bytes{cluster=\"$cluster\", namespace=\"$namespace\", pod=~\"ingester.*\"}",
                            "instant": false,
                            "intervalFactor": 3,
                            "legendFormat": "{{pod}}",
                            "refId": "A"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "Memory Usage",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "bytes",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   },
                   {
                      "aliasColors": { },
                      "bars": true,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$loki_datasource",
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 3,
                         "w": 18,
                         "x": 12,
                         "y": 29
                      },
                      "hiddenSeries": false,
                      "id": 38,
                      "legend": {
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "show": false,
                         "total": false,
                         "values": false
                      },
                      "lines": false,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 2,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [
                         {
                            "alias": "{}",
                            "color": "#F2495C"
                         }
                      ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "sum(rate({cluster=\"$cluster\", namespace=\"$namespace\", job=~\"($namespace)/ingester.*\"} | logfmt | level=\"error\"[$__auto]))",
                            "refId": "A"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "Error Log Rate",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": false,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": false
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   },
                   {
                      "datasource": "$loki_datasource",
                      "gridPos": {
                         "h": 18,
                         "w": 18,
                         "x": 12,
                         "y": 32
                      },
                      "id": 39,
                      "options": {
                         "showLabels": false,
                         "showTime": false,
                         "sortOrder": "Descending",
                         "wrapLogMessage": true
                      },
                      "panels": [ ],
                      "targets": [
                         {
                            "expr": "{cluster=\"$cluster\", namespace=\"$namespace\", job=~\"($namespace)/ingester.*\"} |= \"level=error\"",
                            "refId": "A"
                         }
                      ],
                      "timeFrom": null,
                      "timeShift": null,
                      "title": "Logs",
                      "type": "logs"
                   },
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fill": 0,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 7,
                         "w": 6,
                         "x": 0,
                         "y": 41
                      },
                      "hiddenSeries": false,
                      "id": 67,
                      "legend": {
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "show": false,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 1,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "sum(rate(loki_request_duration_seconds_count{cluster=\"$cluster\", namespace=\"$namespace\", job=~\"($namespace)/ingester.*\", status_code!~\"5[0-9]{2}\"}[$__rate_interval])) by (route)\n/\nsum(rate(loki_request_duration_seconds_count{cluster=\"$cluster\", namespace=\"$namespace\", job=~\"($namespace)/ingester.*\"}[$__rate_interval])) by (route) > 0",
                            "interval": "",
                            "intervalFactor": 1,
                            "legendFormat": "{{route}}",
                            "refId": "A"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "Success Rate",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   }
                ],
                "targets": [ ],
                "title": "Ingester",
                "type": "row"
             },
             {
                "collapsed": true,
                "datasource": null,
                "gridPos": {
                   "h": 1,
                   "w": 24,
                   "x": 0,
                   "y": 29
                },
                "id": 104,
                "panels": [
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 8,
                         "w": 12,
                         "x": 0,
                         "y": 30
                      },
                      "hiddenSeries": false,
                      "id": 106,
                      "legend": {
                         "avg": false,
                         "current": false,
                         "hideEmpty": true,
                         "hideZero": true,
                         "max": false,
                         "min": false,
                         "show": false,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 2,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "topk(10,sum by (tenant) (loki_ingester_memory_streams{cluster=\"$cluster\",job=~\"($namespace)/ingester.*\"}))",
                            "interval": "",
                            "legendFormat": "{{ tenant }}",
                            "refId": "A"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "Active Streams",
                      "tooltip": {
                         "shared": false,
                         "sort": 0,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   },
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 8,
                         "w": 12,
                         "x": 12,
                         "y": 30
                      },
                      "hiddenSeries": false,
                      "id": 108,
                      "legend": {
                         "avg": false,
                         "current": false,
                         "hideEmpty": true,
                         "hideZero": true,
                         "max": false,
                         "min": false,
                         "show": false,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 2,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "topk(10, sum by (tenant) (rate(loki_ingester_streams_created_total{cluster=\"$cluster\",job=~\"($namespace)/ingester.*\"}[$__rate_interval]) > 0))",
                            "interval": "",
                            "legendFormat": "{{ tenant }}",
                            "refId": "A"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "Streams Created/Sec",
                      "tooltip": {
                         "shared": false,
                         "sort": 0,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   }
                ],
                "targets": [ ],
                "title": "Streams",
                "type": "row"
             },
             {
                "collapsed": true,
                "datasource": null,
                "gridPos": {
                   "h": 1,
                   "w": 24,
                   "x": 0,
                   "y": 30
                },
                "id": 94,
                "panels": [
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 8,
                         "w": 12,
                         "x": 0,
                         "y": 31
                      },
                      "hiddenSeries": false,
                      "id": 102,
                      "legend": {
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "show": true,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 2,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [
                         {
                            "alias": "De-Dupe Ratio",
                            "yaxis": 2
                         }
                      ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "sum(rate(loki_ingester_chunks_flushed_total{cluster=\"$cluster\",job=~\"($namespace)/ingester.*\"}[$__rate_interval]))",
                            "interval": "",
                            "legendFormat": "Chunks",
                            "refId": "A"
                         },
                         {
                            "expr": "sum(increase(loki_chunk_store_deduped_chunks_total{cluster=\"$cluster\", job=~\"($namespace)/ingester.*\"}[$__rate_interval]))/sum(increase(loki_ingester_chunks_flushed_total{cluster=\"$cluster\", job=~\"($namespace)/ingester.*\"}[$__rate_interval])) < 1",
                            "interval": "",
                            "legendFormat": "De-Dupe Ratio",
                            "refId": "B"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "Chunks Flushed/Sec",
                      "tooltip": {
                         "shared": true,
                         "sort": 0,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   },
                   {
                      "cards": {
                         "cardPadding": null,
                         "cardRound": null
                      },
                      "color": {
                         "cardColor": "#b4ff00",
                         "colorScale": "sqrt",
                         "colorScheme": "interpolateSpectral",
                         "exponent": 0.5,
                         "mode": "spectrum"
                      },
                      "dataFormat": "tsbuckets",
                      "datasource": "$datasource",
                      "gridPos": {
                         "h": 8,
                         "w": 12,
                         "x": 12,
                         "y": 31
                      },
                      "heatmap": { },
                      "hideZeroBuckets": false,
                      "highlightCards": true,
                      "id": 100,
                      "legend": {
                         "show": true
                      },
                      "panels": [ ],
                      "reverseYBuckets": false,
                      "targets": [
                         {
                            "expr": "sum(rate(loki_ingester_chunk_size_bytes_bucket{cluster=\"$cluster\",job=~\"($namespace)/ingester.*\"}[$__rate_interval])) by (le)",
                            "format": "heatmap",
                            "instant": false,
                            "interval": "",
                            "legendFormat": "{{ le }}",
                            "refId": "A"
                         }
                      ],
                      "timeFrom": null,
                      "timeShift": null,
                      "title": "Chunk Size Bytes",
                      "tooltip": {
                         "show": true,
                         "showHistogram": false
                      },
                      "type": "heatmap",
                      "xAxis": {
                         "show": true
                      },
                      "xBucketNumber": null,
                      "xBucketSize": null,
                      "yAxis": {
                         "decimals": 0,
                         "format": "bytes",
                         "logBase": 1,
                         "max": null,
                         "min": null,
                         "show": true,
                         "splitFactor": null
                      },
                      "yBucketBound": "auto",
                      "yBucketNumber": null,
                      "yBucketSize": null
                   },
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fill": 7,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 9,
                         "w": 12,
                         "x": 0,
                         "y": 39
                      },
                      "hiddenSeries": false,
                      "id": 96,
                      "legend": {
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "show": true,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 2,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": true,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "sum by(reason) (rate(loki_ingester_chunks_flushed_total{cluster=~\"$cluster\",job=~\"$namespace/ingester\", namespace=~\"$namespace\"}[$__rate_interval])) / ignoring(reason) group_left sum(rate(loki_ingester_chunks_flushed_total{cluster=~\"$cluster\",job=~\"$namespace/ingester\", namespace=~\"$namespace\"}[$__rate_interval]))",
                            "interval": "",
                            "legendFormat": "{{ reason }}"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "Chunk Flush Reason %",
                      "tooltip": {
                         "shared": true,
                         "sort": 0,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "percentunit",
                            "label": null,
                            "logBase": 1,
                            "max": "1",
                            "min": "0",
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   },
                   {
                      "cards": {
                         "cardPadding": null,
                         "cardRound": null
                      },
                      "color": {
                         "cardColor": "#b4ff00",
                         "colorScale": "sqrt",
                         "colorScheme": "interpolateSpectral",
                         "exponent": 0.5,
                         "max": null,
                         "min": null,
                         "mode": "spectrum"
                      },
                      "dataFormat": "tsbuckets",
                      "datasource": "$datasource",
                      "gridPos": {
                         "h": 9,
                         "w": 12,
                         "x": 12,
                         "y": 39
                      },
                      "heatmap": { },
                      "hideZeroBuckets": true,
                      "highlightCards": true,
                      "id": 98,
                      "legend": {
                         "show": true
                      },
                      "panels": [ ],
                      "reverseYBuckets": false,
                      "targets": [
                         {
                            "expr": "sum by (le) (rate(loki_ingester_chunk_utilization_bucket{cluster=\"$cluster\", job=~\"($namespace)/ingester.*\"}[$__rate_interval]))",
                            "format": "heatmap",
                            "instant": false,
                            "interval": "",
                            "legendFormat": "{{ le }}",
                            "refId": "A"
                         }
                      ],
                      "timeFrom": null,
                      "timeShift": null,
                      "title": "Chunk Utilization",
                      "tooltip": {
                         "show": true,
                         "showHistogram": false
                      },
                      "type": "heatmap",
                      "xAxis": {
                         "show": true
                      },
                      "xBucketNumber": null,
                      "xBucketSize": null,
                      "yAxis": {
                         "decimals": 0,
                         "format": "percentunit",
                         "logBase": 1,
                         "max": null,
                         "min": null,
                         "show": true,
                         "splitFactor": null
                      },
                      "yBucketBound": "auto",
                      "yBucketNumber": null,
                      "yBucketSize": null
                   }
                ],
                "targets": [ ],
                "title": "Chunks",
                "type": "row"
             },
             {
                "collapsed": true,
                "datasource": null,
                "gridPos": {
                   "h": 1,
                   "w": 24,
                   "x": 0,
                   "y": 31
                },
                "id": 64,
                "panels": [
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 7,
                         "w": 6,
                         "x": 0,
                         "y": 32
                      },
                      "hiddenSeries": false,
                      "id": 68,
                      "legend": {
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "show": false,
                         "total": false,
                         "values": false
                      },
                      "lines": false,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 1,
                      "points": true,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "sum by(pod) (rate(container_cpu_usage_seconds_total{cluster=~\"$cluster\", namespace=~\"$namespace\", pod=~\"querier.*\"}[$__rate_interval]))",
                            "intervalFactor": 3,
                            "legendFormat": "{{pod}}",
                            "refId": "A"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "CPU Usage",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   },
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "unit": "binBps"
                         }
                      },
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 7,
                         "w": 6,
                         "x": 0,
                         "y": 39
                      },
                      "hiddenSeries": false,
                      "id": 69,
                      "legend": {
                         "avg": false,
                         "current": false,
                         "hideEmpty": false,
                         "hideZero": false,
                         "max": false,
                         "min": false,
                         "show": false,
                         "total": false,
                         "values": false
                      },
                      "lines": false,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 1,
                      "points": true,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "go_memstats_heap_inuse_bytes{cluster=\"$cluster\", namespace=\"$namespace\", pod=~\"querier.*\"}",
                            "instant": false,
                            "intervalFactor": 3,
                            "legendFormat": "{{pod}}",
                            "refId": "A"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "Memory Usage",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "bytes",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   },
                   {
                      "aliasColors": { },
                      "bars": true,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$loki_datasource",
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 3,
                         "w": 18,
                         "x": 12,
                         "y": 32
                      },
                      "hiddenSeries": false,
                      "id": 65,
                      "legend": {
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "show": false,
                         "total": false,
                         "values": false
                      },
                      "lines": false,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 2,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [
                         {
                            "alias": "{}",
                            "color": "#F2495C"
                         }
                      ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "sum(rate({cluster=\"$cluster\", namespace=\"$namespace\", job=~\"($namespace)/querier\"} | logfmt |  level=\"error\"[$__auto]))",
                            "refId": "A"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "Error Log Rate",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": false,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": false
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   },
                   {
                      "datasource": "$loki_datasource",
                      "gridPos": {
                         "h": 18,
                         "w": 18,
                         "x": 12,
                         "y": 35
                      },
                      "id": 66,
                      "options": {
                         "showLabels": false,
                         "showTime": false,
                         "sortOrder": "Descending",
                         "wrapLogMessage": true
                      },
                      "panels": [ ],
                      "targets": [
                         {
                            "expr": "{cluster=\"$cluster\", namespace=\"$namespace\", job=~\"($namespace)/querier\"} |= \"level=error\"",
                            "refId": "A"
                         }
                      ],
                      "timeFrom": null,
                      "timeShift": null,
                      "title": "Logs",
                      "type": "logs"
                   },
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fill": 0,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 7,
                         "w": 6,
                         "x": 0,
                         "y": 46
                      },
                      "hiddenSeries": false,
                      "id": 70,
                      "legend": {
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "show": false,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 1,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "sum(rate(loki_request_duration_seconds_count{cluster=\"$cluster\", namespace=\"$namespace\", job=~\"($namespace)/querier\", status_code!~\"5[0-9]{2}\"}[$__rate_interval])) by (route)\n/\nsum(rate(loki_request_duration_seconds_count{cluster=\"$cluster\", namespace=\"$namespace\", job=~\"($namespace)/querier\"}[$__rate_interval])) by (route) > 0",
                            "interval": "",
                            "intervalFactor": 1,
                            "legendFormat": "{{route}}",
                            "refId": "A"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "Success Rate",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   }
                ],
                "targets": [ ],
                "title": "Querier",
                "type": "row"
             },
             {
                "collapsed": true,
                "datasource": null,
                "gridPos": {
                   "h": 1,
                   "w": 24,
                   "x": 0,
                   "y": 32
                },
                "id": 52,
                "panels": [
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "unit": "s"
                         }
                      },
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 8,
                         "w": 24,
                         "x": 0,
                         "y": 30
                      },
                      "hiddenSeries": false,
                      "id": 53,
                      "interval": "",
                      "legend": {
                         "alignAsTable": true,
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "rightSide": true,
                         "show": true,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 1,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "histogram_quantile(.99, sum(rate(loki_memcache_request_duration_seconds_bucket{cluster=\"$cluster\", namespace=\"$namespace\"}[$__rate_interval])) by (method, name, le, container))",
                            "intervalFactor": 1,
                            "legendFormat": "{{container}}: .99-{{method}}-{{name}}",
                            "refId": "A"
                         },
                         {
                            "expr": "histogram_quantile(.9, sum(rate(loki_memcache_request_duration_seconds_bucket{cluster=\"$cluster\", namespace=\"$namespace\"}[$__rate_interval])) by (method, name, le, container))",
                            "hide": false,
                            "legendFormat": "{{container}}: .9-{{method}}-{{name}}",
                            "refId": "B"
                         },
                         {
                            "expr": "histogram_quantile(.5, sum(rate(loki_memcache_request_duration_seconds_bucket{cluster=\"$cluster\", namespace=\"$namespace\"}[$__rate_interval])) by (method, name, le, container))",
                            "hide": false,
                            "legendFormat": "{{container}}: .5-{{method}}-{{name}}",
                            "refId": "C"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "Latency By Method",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   },
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 8,
                         "w": 24,
                         "x": 0,
                         "y": 38
                      },
                      "hiddenSeries": false,
                      "id": 54,
                      "interval": "",
                      "legend": {
                         "alignAsTable": true,
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "rightSide": true,
                         "show": true,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 1,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "sum(rate(loki_memcache_request_duration_seconds_count{cluster=\"$cluster\", namespace=\"$namespace\"}[$__rate_interval])) by (status_code, method, name, container)",
                            "intervalFactor": 1,
                            "legendFormat": "{{container}}: {{status_code}}-{{method}}-{{name}}",
                            "refId": "A"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "Status By Method",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   }
                ],
                "targets": [ ],
                "title": "Memcached",
                "type": "row"
             },
             {
                "collapsed": true,
                "datasource": null,
                "gridPos": {
                   "h": 1,
                   "w": 24,
                   "x": 0,
                   "y": 33
                },
                "id": 57,
                "panels": [
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "unit": "s"
                         }
                      },
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 8,
                         "w": 24,
                         "x": 0,
                         "y": 31
                      },
                      "hiddenSeries": false,
                      "id": 55,
                      "interval": "",
                      "legend": {
                         "alignAsTable": true,
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "rightSide": true,
                         "show": true,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 1,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "histogram_quantile(.99, sum(rate(loki_consul_request_duration_seconds_bucket{cluster=\"$cluster\", namespace=\"$namespace\"}[$__rate_interval])) by (operation, le))",
                            "intervalFactor": 1,
                            "legendFormat": ".99-{{operation}}",
                            "refId": "A"
                         },
                         {
                            "expr": "histogram_quantile(.9, sum(rate(loki_consul_request_duration_seconds_bucket{cluster=\"$cluster\", namespace=\"$namespace\"}[$__rate_interval])) by (operation, le))",
                            "hide": false,
                            "legendFormat": ".9-{{operation}}",
                            "refId": "B"
                         },
                         {
                            "expr": "histogram_quantile(.5, sum(rate(loki_consul_request_duration_seconds_bucket{cluster=\"$cluster\", namespace=\"$namespace\"}[$__rate_interval])) by (operation, le))",
                            "hide": false,
                            "legendFormat": ".5-{{operation}}",
                            "refId": "C"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "Latency By Operation",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   },
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "unit": "ops"
                         }
                      },
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 8,
                         "w": 24,
                         "x": 0,
                         "y": 39
                      },
                      "hiddenSeries": false,
                      "id": 58,
                      "interval": "",
                      "legend": {
                         "alignAsTable": true,
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "rightSide": true,
                         "show": true,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 1,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "sum(rate(loki_consul_request_duration_seconds_bucket{cluster=\"$cluster\", namespace=\"$namespace\"}[$__rate_interval])) by (operation, status_code, method)",
                            "intervalFactor": 1,
                            "legendFormat": "{{status_code}}-{{operation}}",
                            "refId": "A"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "Status By Operation",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   }
                ],
                "targets": [ ],
                "title": "Consul",
                "type": "row"
             },
             {
                "collapsed": true,
                "datasource": null,
                "gridPos": {
                   "h": 1,
                   "w": 24,
                   "x": 0,
                   "y": 34
                },
                "id": 43,
                "panels": [
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "unit": "s"
                         }
                      },
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 7,
                         "w": 6,
                         "x": 0,
                         "y": 9
                      },
                      "hiddenSeries": false,
                      "id": 41,
                      "interval": "",
                      "legend": {
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "show": false,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 1,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "histogram_quantile(.99, sum(rate(loki_bigtable_request_duration_seconds_bucket{cluster=\"$cluster\", namespace=\"$namespace\", operation=\"/google.bigtable.v2.Bigtable/MutateRows\"}[$__rate_interval])) by (operation, le))",
                            "intervalFactor": 1,
                            "legendFormat": ".9",
                            "refId": "A"
                         },
                         {
                            "expr": "histogram_quantile(.9, sum(rate(loki_bigtable_request_duration_seconds_bucket{cluster=\"$cluster\", namespace=\"$namespace\", operation=\"/google.bigtable.v2.Bigtable/MutateRows\"}[$__rate_interval])) by (operation, le))",
                            "refId": "B"
                         },
                         {
                            "expr": "histogram_quantile(.5, sum(rate(loki_bigtable_request_duration_seconds_bucket{cluster=\"$cluster\", namespace=\"$namespace\", operation=\"/google.bigtable.v2.Bigtable/MutateRows\"}[$__rate_interval])) by (operation, le))",
                            "refId": "C"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "MutateRows Latency",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   },
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "unit": "s"
                         }
                      },
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 7,
                         "w": 6,
                         "x": 6,
                         "y": 9
                      },
                      "hiddenSeries": false,
                      "id": 46,
                      "interval": "",
                      "legend": {
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "show": false,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 1,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "histogram_quantile(.99, sum(rate(loki_bigtable_request_duration_seconds_bucket{cluster=\"$cluster\", namespace=\"$namespace\", operation=\"/google.bigtable.v2.Bigtable/ReadRows\"}[$__rate_interval])) by (operation, le))",
                            "interval": "",
                            "intervalFactor": 1,
                            "legendFormat": "99%",
                            "refId": "A"
                         },
                         {
                            "expr": "histogram_quantile(.9, sum(rate(loki_bigtable_request_duration_seconds_bucket{cluster=\"$cluster\", namespace=\"$namespace\", operation=\"/google.bigtable.v2.Bigtable/ReadRows\"}[$__rate_interval])) by (operation, le))",
                            "interval": "",
                            "legendFormat": "90%",
                            "refId": "B"
                         },
                         {
                            "expr": "histogram_quantile(.5, sum(rate(loki_bigtable_request_duration_seconds_bucket{cluster=\"$cluster\", namespace=\"$namespace\", operation=\"/google.bigtable.v2.Bigtable/ReadRows\"}[$__rate_interval])) by (operation, le))",
                            "interval": "",
                            "legendFormat": "50%",
                            "refId": "C"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "ReadRows Latency",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   },
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "unit": "s"
                         }
                      },
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 7,
                         "w": 6,
                         "x": 12,
                         "y": 9
                      },
                      "hiddenSeries": false,
                      "id": 44,
                      "interval": "",
                      "legend": {
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "show": false,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 1,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "histogram_quantile(.99, sum(rate(loki_bigtable_request_duration_seconds_bucket{cluster=\"$cluster\", namespace=\"$namespace\", operation=\"/google.bigtable.admin.v2.BigtableTableAdmin/GetTable\"}[$__rate_interval])) by (operation, le))",
                            "interval": "",
                            "intervalFactor": 1,
                            "legendFormat": "99%",
                            "refId": "A"
                         },
                         {
                            "expr": "histogram_quantile(.9, sum(rate(loki_bigtable_request_duration_seconds_bucket{cluster=\"$cluster\", namespace=\"$namespace\", operation=\"/google.bigtable.admin.v2.BigtableTableAdmin/GetTable\"}[$__rate_interval])) by (operation, le))",
                            "interval": "",
                            "legendFormat": "90%",
                            "refId": "B"
                         },
                         {
                            "expr": "histogram_quantile(.5, sum(rate(loki_bigtable_request_duration_seconds_bucket{cluster=\"$cluster\", namespace=\"$namespace\", operation=\"/google.bigtable.admin.v2.BigtableTableAdmin/GetTable\"}[$__rate_interval])) by (operation, le))",
                            "interval": "",
                            "legendFormat": "50%",
                            "refId": "C"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "GetTable Latency",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   },
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "unit": "s"
                         }
                      },
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 7,
                         "w": 6,
                         "x": 18,
                         "y": 9
                      },
                      "hiddenSeries": false,
                      "id": 45,
                      "interval": "",
                      "legend": {
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "show": false,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 1,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "histogram_quantile(.99, sum(rate(loki_bigtable_request_duration_seconds_bucket{cluster=\"$cluster\", namespace=\"$namespace\", operation=\"/google.bigtable.admin.v2.BigtableTableAdmin/ListTables\"}[$__rate_interval])) by (operation, le))",
                            "intervalFactor": 1,
                            "legendFormat": ".9",
                            "refId": "A"
                         },
                         {
                            "expr": "histogram_quantile(.9, sum(rate(loki_bigtable_request_duration_seconds_bucket{cluster=\"$cluster\", namespace=\"$namespace\", operation=\"/google.bigtable.admin.v2.BigtableTableAdmin/ListTables\"}[$__rate_interval])) by (operation, le))",
                            "refId": "B"
                         },
                         {
                            "expr": "histogram_quantile(.5, sum(rate(loki_bigtable_request_duration_seconds_bucket{cluster=\"$cluster\", namespace=\"$namespace\", operation=\"/google.bigtable.admin.v2.BigtableTableAdmin/ListTables\"}[$__rate_interval])) by (operation, le))",
                            "refId": "C"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "ListTables Latency",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   },
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "unit": "ops"
                         }
                      },
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 7,
                         "w": 6,
                         "x": 0,
                         "y": 16
                      },
                      "hiddenSeries": false,
                      "id": 47,
                      "interval": "",
                      "legend": {
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "show": false,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 1,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "sum(rate(loki_bigtable_request_duration_seconds_count{cluster=\"$cluster\", namespace=\"$namespace\", operation=\"/google.bigtable.v2.Bigtable/MutateRows\"}[$__rate_interval])) by (status_code)",
                            "intervalFactor": 1,
                            "legendFormat": "{{status_code}}",
                            "refId": "A"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "MutateRows Status",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   },
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "unit": "ops"
                         }
                      },
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 7,
                         "w": 6,
                         "x": 6,
                         "y": 16
                      },
                      "hiddenSeries": false,
                      "id": 50,
                      "interval": "",
                      "legend": {
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "show": false,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 1,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "sum(rate(loki_bigtable_request_duration_seconds_count{cluster=\"$cluster\", namespace=\"$namespace\", operation=\"/google.bigtable.v2.Bigtable/ReadRows\"}[$__rate_interval])) by (status_code)",
                            "intervalFactor": 1,
                            "legendFormat": "{{status_code}}",
                            "refId": "A"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "ReadRows Status",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   },
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "unit": "ops"
                         }
                      },
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 7,
                         "w": 6,
                         "x": 12,
                         "y": 16
                      },
                      "hiddenSeries": false,
                      "id": 48,
                      "interval": "",
                      "legend": {
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "show": false,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 1,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "sum(rate(loki_bigtable_request_duration_seconds_count{cluster=\"$cluster\", namespace=\"$namespace\", operation=\"/google.bigtable.admin.v2.BigtableTableAdmin/GetTable\"}[$__rate_interval])) by (status_code)",
                            "intervalFactor": 1,
                            "legendFormat": "{{status_code}}",
                            "refId": "A"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "GetTable Status",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   },
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "unit": "ops"
                         }
                      },
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 7,
                         "w": 6,
                         "x": 18,
                         "y": 16
                      },
                      "hiddenSeries": false,
                      "id": 49,
                      "interval": "",
                      "legend": {
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "show": false,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 1,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "sum(rate(loki_bigtable_request_duration_seconds_count{cluster=\"$cluster\", namespace=\"$namespace\", operation=\"/google.bigtable.admin.v2.BigtableTableAdmin/ListTables\"}[$__rate_interval])) by (status_code)",
                            "intervalFactor": 1,
                            "legendFormat": "{{status_code}}",
                            "refId": "A"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "ListTables Status",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   }
                ],
                "targets": [ ],
                "title": "Big Table",
                "type": "row"
             },
             {
                "collapsed": true,
                "datasource": null,
                "gridPos": {
                   "h": 1,
                   "w": 24,
                   "x": 0,
                   "y": 35
                },
                "id": 60,
                "panels": [
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "unit": "s"
                         }
                      },
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 8,
                         "w": 24,
                         "x": 0,
                         "y": 33
                      },
                      "hiddenSeries": false,
                      "id": 61,
                      "interval": "",
                      "legend": {
                         "alignAsTable": true,
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "rightSide": true,
                         "show": true,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 1,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "histogram_quantile(.99, sum(rate(loki_gcs_request_duration_seconds_bucket{cluster=\"$cluster\", namespace=\"$namespace\"}[$__rate_interval])) by (operation, le))",
                            "intervalFactor": 1,
                            "legendFormat": ".99-{{operation}}",
                            "refId": "A"
                         },
                         {
                            "expr": "histogram_quantile(.9, sum(rate(loki_gcs_request_duration_seconds_bucket{cluster=\"$cluster\", namespace=\"$namespace\"}[$__rate_interval])) by (operation, le))",
                            "hide": false,
                            "legendFormat": ".9-{{operation}}",
                            "refId": "B"
                         },
                         {
                            "expr": "histogram_quantile(.5, sum(rate(loki_gcs_request_duration_seconds_bucket{cluster=\"$cluster\", namespace=\"$namespace\"}[$__rate_interval])) by (operation, le))",
                            "hide": false,
                            "legendFormat": ".5-{{operation}}",
                            "refId": "C"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "Latency By Operation",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   },
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 8,
                         "w": 24,
                         "x": 0,
                         "y": 41
                      },
                      "hiddenSeries": false,
                      "id": 62,
                      "interval": "",
                      "legend": {
                         "alignAsTable": true,
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "rightSide": true,
                         "show": true,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 1,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "sum(rate(loki_gcs_request_duration_seconds_count{cluster=\"$cluster\", namespace=\"$namespace\"}[$__rate_interval])) by (status_code, operation)",
                            "intervalFactor": 1,
                            "legendFormat": "{{status_code}}-{{operation}}",
                            "refId": "A"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "Status By Method",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   }
                ],
                "targets": [ ],
                "title": "GCS",
                "type": "row"
             },
             {
                "collapsed": true,
                "datasource": null,
                "gridPos": {
                   "h": 1,
                   "w": 24,
                   "x": 0,
                   "y": 36
                },
                "id": 76,
                "panels": [
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": null,
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 6,
                         "w": 6,
                         "x": 0,
                         "y": 9
                      },
                      "id": 82,
                      "legend": {
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "show": true,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 2,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "sum(rate(loki_dynamo_failures_total{cluster=\"$cluster\", namespace=\"$namespace\"}[$__rate_interval]))",
                            "refId": "A"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "Failure Rate",
                      "tooltip": {
                         "shared": true,
                         "sort": 0,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   },
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": null,
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 6,
                         "w": 6,
                         "x": 6,
                         "y": 9
                      },
                      "id": 83,
                      "legend": {
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "show": true,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 2,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "sum(rate(loki_dynamo_consumed_capacity_total{cluster=\"$cluster\", namespace=\"$namespace\"}[$__rate_interval]))",
                            "refId": "A"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "Consumed Capacity Rate",
                      "tooltip": {
                         "shared": true,
                         "sort": 0,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   },
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": null,
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 6,
                         "w": 6,
                         "x": 12,
                         "y": 9
                      },
                      "id": 84,
                      "legend": {
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "show": true,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 2,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "sum(rate(loki_dynamo_throttled_total{cluster=\"$cluster\", namespace=\"$namespace\"}[$__rate_interval]))",
                            "refId": "A"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "Throttled Rate",
                      "tooltip": {
                         "shared": true,
                         "sort": 0,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   },
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": null,
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 6,
                         "w": 6,
                         "x": 18,
                         "y": 9
                      },
                      "id": 85,
                      "legend": {
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "show": true,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 2,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "sum(rate(loki_dynamo_dropped_requests_total{cluster=\"$cluster\", namespace=\"$namespace\"}[$__rate_interval]))",
                            "refId": "A"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "Dropped Rate",
                      "tooltip": {
                         "shared": true,
                         "sort": 0,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   },
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": null,
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 6,
                         "w": 6,
                         "x": 0,
                         "y": 15
                      },
                      "id": 86,
                      "legend": {
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "show": true,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 2,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "histogram_quantile(.99, sum(rate(loki_dynamo_query_pages_count{cluster=\"$cluster\", namespace=\"$namespace\"}[$__rate_interval])))",
                            "legendFormat": ".99",
                            "refId": "A"
                         },
                         {
                            "expr": "histogram_quantile(.9, sum(rate(loki_dynamo_query_pages_count{cluster=\"$cluster\", namespace=\"$namespace\"}[$__rate_interval])))",
                            "legendFormat": ".9",
                            "refId": "B"
                         },
                         {
                            "expr": "histogram_quantile(.5, sum(rate(loki_dynamo_query_pages_count{cluster=\"$cluster\", namespace=\"$namespace\"}[$__rate_interval])))",
                            "legendFormat": ".5",
                            "refId": "C"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "Query Pages",
                      "tooltip": {
                         "shared": true,
                         "sort": 0,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   },
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "unit": "s"
                         }
                      },
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 6,
                         "w": 9,
                         "x": 6,
                         "y": 15
                      },
                      "id": 87,
                      "interval": "",
                      "legend": {
                         "alignAsTable": true,
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "rightSide": true,
                         "show": true,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 1,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "histogram_quantile(.99, sum(rate(loki_dynamo_request_duration_seconds_bucket{cluster=\"$cluster\", namespace=\"$namespace\"}[$__rate_interval])) by (operation, le))",
                            "intervalFactor": 1,
                            "legendFormat": ".99-{{operation}}",
                            "refId": "A"
                         },
                         {
                            "expr": "histogram_quantile(.9, sum(rate(loki_dynamo_request_duration_seconds_bucket{cluster=\"$cluster\", namespace=\"$namespace\"}[$__rate_interval])) by (operation, le))",
                            "hide": false,
                            "legendFormat": ".9-{{operation}}",
                            "refId": "B"
                         },
                         {
                            "expr": "histogram_quantile(.5, sum(rate(loki_dynamo_request_duration_seconds_bucket{cluster=\"$cluster\", namespace=\"$namespace\"}[$__rate_interval])) by (operation, le))",
                            "hide": false,
                            "legendFormat": ".5-{{operation}}",
                            "refId": "C"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "Latency By Operation",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   },
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 6,
                         "w": 9,
                         "x": 15,
                         "y": 15
                      },
                      "id": 88,
                      "interval": "",
                      "legend": {
                         "alignAsTable": true,
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "rightSide": true,
                         "show": true,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 1,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "sum(rate(loki_dynamo_request_duration_seconds_count{cluster=\"$cluster\", namespace=\"$namespace\"}[$__rate_interval])) by (status_code, operation)",
                            "intervalFactor": 1,
                            "legendFormat": "{{status_code}}-{{operation}}",
                            "refId": "A"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "Status By Method",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   }
                ],
                "targets": [ ],
                "title": "Dynamo",
                "type": "row"
             },
             {
                "collapsed": true,
                "datasource": null,
                "gridPos": {
                   "h": 1,
                   "w": 24,
                   "x": 0,
                   "y": 37
                },
                "id": 78,
                "panels": [
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "unit": "s"
                         }
                      },
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 8,
                         "w": 24,
                         "x": 0,
                         "y": 10
                      },
                      "id": 79,
                      "interval": "",
                      "legend": {
                         "alignAsTable": true,
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "rightSide": true,
                         "show": true,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 1,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "histogram_quantile(.99, sum(rate(loki_s3_request_duration_seconds_bucket{cluster=\"$cluster\", namespace=\"$namespace\"}[$__rate_interval])) by (operation, le))",
                            "intervalFactor": 1,
                            "legendFormat": ".99-{{operation}}",
                            "refId": "A"
                         },
                         {
                            "expr": "histogram_quantile(.9, sum(rate(loki_s3_request_duration_seconds_bucket{cluster=\"$cluster\", namespace=\"$namespace\"}[$__rate_interval])) by (operation, le))",
                            "hide": false,
                            "legendFormat": ".9-{{operation}}",
                            "refId": "B"
                         },
                         {
                            "expr": "histogram_quantile(.5, sum(rate(loki_s3_request_duration_seconds_bucket{cluster=\"$cluster\", namespace=\"$namespace\"}[$__rate_interval])) by (operation, le))",
                            "hide": false,
                            "legendFormat": ".5-{{operation}}",
                            "refId": "C"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "Latency By Operation",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   },
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 8,
                         "w": 24,
                         "x": 0,
                         "y": 18
                      },
                      "id": 80,
                      "interval": "",
                      "legend": {
                         "alignAsTable": true,
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "rightSide": true,
                         "show": true,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 1,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "sum(rate(loki_s3_request_duration_seconds_count{cluster=\"$cluster\", namespace=\"$namespace\"}[$__rate_interval])) by (status_code, operation)",
                            "intervalFactor": 1,
                            "legendFormat": "{{status_code}}-{{operation}}",
                            "refId": "A"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "Status By Method",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   }
                ],
                "targets": [ ],
                "title": "S3",
                "type": "row"
             },
             {
                "collapsed": true,
                "datasource": null,
                "gridPos": {
                   "h": 1,
                   "w": 24,
                   "x": 0,
                   "y": 37
                },
                "id": 78,
                "panels": [
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "unit": "s"
                         }
                      },
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 8,
                         "w": 24,
                         "x": 0,
                         "y": 10
                      },
                      "id": 79,
                      "interval": "",
                      "legend": {
                         "alignAsTable": true,
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "rightSide": true,
                         "show": true,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 1,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "histogram_quantile(.99, sum(rate(loki_azure_blob_request_duration_seconds_bucket{cluster=\"$cluster\", namespace=\"$namespace\"}[$__rate_interval])) by (operation, le))",
                            "intervalFactor": 1,
                            "legendFormat": ".99-{{operation}}",
                            "refId": "A"
                         },
                         {
                            "expr": "histogram_quantile(.9, sum(rate(loki_azure_blob_request_duration_seconds_bucket{cluster=\"$cluster\", namespace=\"$namespace\"}[$__rate_interval])) by (operation, le))",
                            "hide": false,
                            "legendFormat": ".9-{{operation}}",
                            "refId": "B"
                         },
                         {
                            "expr": "histogram_quantile(.5, sum(rate(loki_azure_blob_request_duration_seconds_bucket{cluster=\"$cluster\", namespace=\"$namespace\"}[$__rate_interval])) by (operation, le))",
                            "hide": false,
                            "legendFormat": ".5-{{operation}}",
                            "refId": "C"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "Latency By Operation",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   },
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 8,
                         "w": 24,
                         "x": 0,
                         "y": 18
                      },
                      "id": 80,
                      "interval": "",
                      "legend": {
                         "alignAsTable": true,
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "rightSide": true,
                         "show": true,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 1,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "sum(rate(loki_azure_blob_request_duration_seconds_count{cluster=\"$cluster\", namespace=\"$namespace\"}[$__rate_interval])) by (status_code, operation)",
                            "intervalFactor": 1,
                            "legendFormat": "{{status_code}}-{{operation}}",
                            "refId": "A"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "Status By Method",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   }
                ],
                "targets": [ ],
                "title": "Azure Blob",
                "type": "row"
             },
             {
                "collapsed": true,
                "datasource": null,
                "gridPos": {
                   "h": 1,
                   "w": 24,
                   "x": 0,
                   "y": 37
                },
                "id": 114,
                "panels": [
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "unit": "s"
                         }
                      },
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 8,
                         "w": 24,
                         "x": 0,
                         "y": 10
                      },
                      "id": 115,
                      "interval": "",
                      "legend": {
                         "alignAsTable": true,
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "rightSide": true,
                         "show": true,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 1,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "histogram_quantile(.99, sum(rate(loki_boltdb_shipper_request_duration_seconds_bucket{cluster=\"$cluster\", namespace=\"$namespace\"}[$__rate_interval])) by (operation, le))",
                            "intervalFactor": 1,
                            "legendFormat": ".99-{{operation}}",
                            "refId": "A"
                         },
                         {
                            "expr": "histogram_quantile(.9, sum(rate(loki_boltdb_shipper_request_duration_seconds_bucket{cluster=\"$cluster\", namespace=\"$namespace\"}[$__rate_interval])) by (operation, le))",
                            "hide": false,
                            "legendFormat": ".9-{{operation}}",
                            "refId": "B"
                         },
                         {
                            "expr": "histogram_quantile(.5, sum(rate(loki_boltdb_shipper_request_duration_seconds_bucket{cluster=\"$cluster\", namespace=\"$namespace\"}[$__rate_interval])) by (operation, le))",
                            "hide": false,
                            "legendFormat": ".5-{{operation}}",
                            "refId": "C"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "Latency By Operation",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   },
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fill": 1,
                      "fillGradient": 0,
                      "gridPos": {
                         "h": 8,
                         "w": 24,
                         "x": 0,
                         "y": 18
                      },
                      "id": 116,
                      "interval": "",
                      "legend": {
                         "alignAsTable": true,
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "rightSide": true,
                         "show": true,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "nullPointMode": "null",
                      "options": {
                         "dataLinks": [ ]
                      },
                      "panels": [ ],
                      "percentage": false,
                      "pointradius": 1,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "sum(rate(loki_boltdb_shipper_request_duration_seconds_count{cluster=\"$cluster\", namespace=\"$namespace\"}[$__rate_interval])) by (status_code, operation)",
                            "intervalFactor": 1,
                            "legendFormat": "{{status_code}}-{{operation}}",
                            "refId": "A"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeRegions": [ ],
                      "timeShift": null,
                      "title": "Status By Method",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "timeseries",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": true
                         }
                      ],
                      "yaxis": {
                         "align": false,
                         "alignLevel": null
                      }
                   }
                ],
                "targets": [ ],
                "title": "BoltDB Shipper",
                "type": "row"
             }
          ],
          "refresh": "10s",
          "rows": [ ],
          "schemaVersion": 14,
          "style": "dark",
          "tags": [
             "loki"
          ],
          "templating": {
             "list": [
                {
                   "current": {
                      "text": "default",
                      "value": "default"
                   },
                   "hide": 0,
                   "label": "Data source",
                   "name": "datasource",
                   "options": [ ],
                   "query": "prometheus",
                   "refresh": 1,
                   "regex": "",
                   "type": "datasource"
                },
                {
                   "hide": 0,
                   "label": null,
                   "name": "loki_datasource",
                   "options": [ ],
                   "query": "loki",
                   "refresh": 1,
                   "regex": "",
                   "type": "datasource"
                },
                {
                   "allValue": null,
                   "current": {
                      "text": "prod",
                      "value": "prod"
                   },
                   "datasource": "$datasource",
                   "hide": 0,
                   "includeAll": false,
                   "label": "cluster",
                   "multi": false,
                   "name": "cluster",
                   "options": [ ],
                   "query": "label_values(loki_build_info, cluster)",
                   "refresh": 1,
                   "regex": "",
                   "sort": 2,
                   "tagValuesQuery": "",
                   "tags": [ ],
                   "tagsQuery": "",
                   "type": "query",
                   "useTags": false
                },
                {
                   "allValue": null,
                   "current": {
                      "text": "prod",
                      "value": "prod"
                   },
                   "datasource": "$datasource",
                   "hide": 0,
                   "includeAll": false,
                   "label": "namespace",
                   "multi": false,
                   "name": "namespace",
                   "options": [ ],
                   "query": "label_values(loki_build_info{cluster=~\"$cluster\"}, namespace)",
                   "refresh": 1,
                   "regex": "",
                   "sort": 2,
                   "tagValuesQuery": "",
                   "tags": [ ],
                   "tagsQuery": "",
                   "type": "query",
                   "useTags": false
                }
             ]
          },
          "time": {
             "from": "now-1h",
             "to": "now"
          },
          "timepicker": {
             "refresh_intervals": [
                "5s",
                "10s",
                "30s",
                "1m",
                "5m",
                "15m",
                "30m",
                "1h",
                "2h",
                "1d"
             ],
             "time_options": [
                "5m",
                "15m",
                "1h",
                "6h",
                "12h",
                "24h",
                "2d",
                "7d",
                "30d"
             ]
          },
          "timezone": "utc",
          "title": "Loki / Operational",
          "uid": "operational",
          "version": 0
       }
kind: ConfigMap
metadata:
  annotations:
    grafana_dashboard_folder: /dashboards/Loki Mixin
  labels:
    grafana_dashboard: "1"
  name: loki-operational.json
  namespace: monitoring-system
---
apiVersion: v1
data:
  loki-reads-resources.json: |-
    {
          "annotations": {
             "list": [ ]
          },
          "editable": true,
          "gnetId": null,
          "graphTooltip": 0,
          "hideControls": false,
          "links": [
             {
                "asDropdown": true,
                "icon": "external link",
                "includeVars": true,
                "keepTime": true,
                "tags": [
                   "loki"
                ],
                "targetBlank": false,
                "title": "Loki Dashboards",
                "type": "dashboards"
             }
          ],
          "refresh": "10s",
          "rows": [
             {
                "collapse": false,
                "height": "250px",
                "panels": [
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "request"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#FFC000",
                                        "mode": "fixed"
                                     }
                                  },
                                  {
                                     "id": "custom.fillOpacity",
                                     "value": 0
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "limit"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E02F44",
                                        "mode": "fixed"
                                     }
                                  },
                                  {
                                     "id": "custom.fillOpacity",
                                     "value": 0
                                  }
                               ]
                            }
                         ]
                      },
                      "id": 1,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "sum by(pod) (rate(container_cpu_usage_seconds_total{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"query-frontend\"}[$__rate_interval]))",
                            "format": "time_series",
                            "legendFormat": "{{pod}}",
                            "legendLink": null
                         },
                         {
                            "expr": "min(kube_pod_container_resource_requests{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"query-frontend\", resource=\"cpu\"} > 0)",
                            "format": "time_series",
                            "legendFormat": "request",
                            "legendLink": null
                         },
                         {
                            "expr": "min(container_spec_cpu_quota{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"query-frontend\"} / container_spec_cpu_period{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"query-frontend\"})",
                            "format": "time_series",
                            "legendFormat": "limit",
                            "legendLink": null
                         }
                      ],
                      "title": "CPU",
                      "tooltip": {
                         "sort": 2
                      },
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "bytes"
                         },
                         "overrides": [
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "request"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#FFC000",
                                        "mode": "fixed"
                                     }
                                  },
                                  {
                                     "id": "custom.fillOpacity",
                                     "value": 0
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "limit"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E02F44",
                                        "mode": "fixed"
                                     }
                                  },
                                  {
                                     "id": "custom.fillOpacity",
                                     "value": 0
                                  }
                               ]
                            }
                         ]
                      },
                      "id": 2,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "max by(pod) (container_memory_working_set_bytes{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"query-frontend\"})",
                            "format": "time_series",
                            "legendFormat": "{{pod}}",
                            "legendLink": null
                         },
                         {
                            "expr": "min(kube_pod_container_resource_requests{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"query-frontend\", resource=\"memory\"} > 0)",
                            "format": "time_series",
                            "legendFormat": "request",
                            "legendLink": null
                         },
                         {
                            "expr": "min(container_spec_memory_limit_bytes{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"query-frontend\"} > 0)",
                            "format": "time_series",
                            "legendFormat": "limit",
                            "legendLink": null
                         }
                      ],
                      "title": "Memory (workingset)",
                      "tooltip": {
                         "sort": 2
                      },
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "bytes"
                         },
                         "overrides": [ ]
                      },
                      "id": 3,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "sum by(pod) (go_memstats_heap_inuse_bytes{cluster=~\"$cluster\", job=~\"($namespace)/query-frontend\"})",
                            "format": "time_series",
                            "legendFormat": "{{pod}}",
                            "legendLink": null
                         }
                      ],
                      "title": "Memory (go heap inuse)",
                      "tooltip": {
                         "sort": 2
                      },
                      "type": "timeseries"
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "Query Frontend",
                "titleSize": "h6"
             },
             {
                "collapse": false,
                "height": "250px",
                "panels": [
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "request"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#FFC000",
                                        "mode": "fixed"
                                     }
                                  },
                                  {
                                     "id": "custom.fillOpacity",
                                     "value": 0
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "limit"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E02F44",
                                        "mode": "fixed"
                                     }
                                  },
                                  {
                                     "id": "custom.fillOpacity",
                                     "value": 0
                                  }
                               ]
                            }
                         ]
                      },
                      "id": 4,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "sum by(pod) (rate(container_cpu_usage_seconds_total{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"query-scheduler\"}[$__rate_interval]))",
                            "format": "time_series",
                            "legendFormat": "{{pod}}",
                            "legendLink": null
                         },
                         {
                            "expr": "min(kube_pod_container_resource_requests{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"query-scheduler\", resource=\"cpu\"} > 0)",
                            "format": "time_series",
                            "legendFormat": "request",
                            "legendLink": null
                         },
                         {
                            "expr": "min(container_spec_cpu_quota{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"query-scheduler\"} / container_spec_cpu_period{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"query-scheduler\"})",
                            "format": "time_series",
                            "legendFormat": "limit",
                            "legendLink": null
                         }
                      ],
                      "title": "CPU",
                      "tooltip": {
                         "sort": 2
                      },
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "bytes"
                         },
                         "overrides": [
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "request"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#FFC000",
                                        "mode": "fixed"
                                     }
                                  },
                                  {
                                     "id": "custom.fillOpacity",
                                     "value": 0
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "limit"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E02F44",
                                        "mode": "fixed"
                                     }
                                  },
                                  {
                                     "id": "custom.fillOpacity",
                                     "value": 0
                                  }
                               ]
                            }
                         ]
                      },
                      "id": 5,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "max by(pod) (container_memory_working_set_bytes{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"query-scheduler\"})",
                            "format": "time_series",
                            "legendFormat": "{{pod}}",
                            "legendLink": null
                         },
                         {
                            "expr": "min(kube_pod_container_resource_requests{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"query-scheduler\", resource=\"memory\"} > 0)",
                            "format": "time_series",
                            "legendFormat": "request",
                            "legendLink": null
                         },
                         {
                            "expr": "min(container_spec_memory_limit_bytes{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"query-scheduler\"} > 0)",
                            "format": "time_series",
                            "legendFormat": "limit",
                            "legendLink": null
                         }
                      ],
                      "title": "Memory (workingset)",
                      "tooltip": {
                         "sort": 2
                      },
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "bytes"
                         },
                         "overrides": [ ]
                      },
                      "id": 6,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "sum by(pod) (go_memstats_heap_inuse_bytes{cluster=~\"$cluster\", job=~\"($namespace)/query-scheduler\"})",
                            "format": "time_series",
                            "legendFormat": "{{pod}}",
                            "legendLink": null
                         }
                      ],
                      "title": "Memory (go heap inuse)",
                      "tooltip": {
                         "sort": 2
                      },
                      "type": "timeseries"
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "Query Scheduler",
                "titleSize": "h6"
             },
             {
                "collapse": false,
                "collapsed": false,
                "panels": [
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "request"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#FFC000",
                                        "mode": "fixed"
                                     }
                                  },
                                  {
                                     "id": "custom.fillOpacity",
                                     "value": 0
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "limit"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E02F44",
                                        "mode": "fixed"
                                     }
                                  },
                                  {
                                     "id": "custom.fillOpacity",
                                     "value": 0
                                  }
                               ]
                            }
                         ]
                      },
                      "gridPos": { },
                      "id": 7,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "targets": [
                         {
                            "expr": "sum by(pod) (rate(container_cpu_usage_seconds_total{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"querier\"}[$__rate_interval]))",
                            "format": "time_series",
                            "legendFormat": "{{pod}}",
                            "legendLink": null
                         },
                         {
                            "expr": "min(kube_pod_container_resource_requests{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"querier\", resource=\"cpu\"} > 0)",
                            "format": "time_series",
                            "legendFormat": "request",
                            "legendLink": null
                         },
                         {
                            "expr": "min(container_spec_cpu_quota{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"querier\"} / container_spec_cpu_period{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"querier\"})",
                            "format": "time_series",
                            "legendFormat": "limit",
                            "legendLink": null
                         }
                      ],
                      "title": "CPU",
                      "tooltip": {
                         "sort": 2
                      },
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "bytes"
                         },
                         "overrides": [
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "request"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#FFC000",
                                        "mode": "fixed"
                                     }
                                  },
                                  {
                                     "id": "custom.fillOpacity",
                                     "value": 0
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "limit"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E02F44",
                                        "mode": "fixed"
                                     }
                                  },
                                  {
                                     "id": "custom.fillOpacity",
                                     "value": 0
                                  }
                               ]
                            }
                         ]
                      },
                      "gridPos": { },
                      "id": 8,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "targets": [
                         {
                            "expr": "max by(pod) (container_memory_working_set_bytes{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"querier\"})",
                            "format": "time_series",
                            "legendFormat": "{{pod}}",
                            "legendLink": null
                         },
                         {
                            "expr": "min(kube_pod_container_resource_requests{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"querier\", resource=\"memory\"} > 0)",
                            "format": "time_series",
                            "legendFormat": "request",
                            "legendLink": null
                         },
                         {
                            "expr": "min(container_spec_memory_limit_bytes{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"querier\"} > 0)",
                            "format": "time_series",
                            "legendFormat": "limit",
                            "legendLink": null
                         }
                      ],
                      "title": "Memory (workingset)",
                      "tooltip": {
                         "sort": 2
                      },
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "bytes"
                         },
                         "overrides": [ ]
                      },
                      "gridPos": { },
                      "id": 9,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "targets": [
                         {
                            "expr": "sum by(pod) (go_memstats_heap_inuse_bytes{cluster=~\"$cluster\", job=~\"($namespace)/querier\"})",
                            "format": "time_series",
                            "legendFormat": "{{pod}}",
                            "legendLink": null
                         }
                      ],
                      "title": "Memory (go heap inuse)",
                      "tooltip": {
                         "sort": 2
                      },
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 100,
                               "lineWidth": 0,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "normal"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "Bps"
                         },
                         "overrides": [ ]
                      },
                      "gridPos": { },
                      "id": 10,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "targets": [
                         {
                            "expr": "sum by(instance, pod, device) (rate(node_disk_written_bytes_total[$__rate_interval])) + ignoring(pod) group_right() (label_replace(count by(instance, pod, device) (container_fs_writes_bytes_total{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"querier\", device!~\".*sda.*\"}), \"device\", \"$1\", \"device\", \"/dev/(.*)\") * 0)\n",
                            "format": "time_series",
                            "legendFormat": "{{pod}} - {{device}}",
                            "legendLink": null
                         }
                      ],
                      "title": "Disk Writes",
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 100,
                               "lineWidth": 0,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "normal"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "Bps"
                         },
                         "overrides": [ ]
                      },
                      "gridPos": { },
                      "id": 11,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "targets": [
                         {
                            "expr": "sum by(instance, pod, device) (rate(node_disk_read_bytes_total[$__rate_interval])) + ignoring(pod) group_right() (label_replace(count by(instance, pod, device) (container_fs_writes_bytes_total{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"querier\", device!~\".*sda.*\"}), \"device\", \"$1\", \"device\", \"/dev/(.*)\") * 0)\n",
                            "format": "time_series",
                            "legendFormat": "{{pod}} - {{device}}",
                            "legendLink": null
                         }
                      ],
                      "title": "Disk Reads",
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "percentunit"
                         },
                         "overrides": [ ]
                      },
                      "gridPos": { },
                      "id": 12,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "targets": [
                         {
                            "expr": "max by(persistentvolumeclaim) (kubelet_volume_stats_used_bytes{cluster=~\"$cluster\", namespace=~\"$namespace\"} / kubelet_volume_stats_capacity_bytes{cluster=~\"$cluster\", namespace=~\"$namespace\"}) and count by(persistentvolumeclaim) (kube_persistentvolumeclaim_labels{cluster=~\"$cluster\", namespace=~\"$namespace\",label_name=~\"querier.*\"})",
                            "format": "time_series",
                            "legendFormat": "{{persistentvolumeclaim}}",
                            "legendLink": null
                         }
                      ],
                      "title": "Disk Space Utilization",
                      "type": "timeseries"
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "Querier",
                "titleSize": "h6",
                "type": "row"
             },
             {
                "collapse": false,
                "collapsed": false,
                "panels": [
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "request"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#FFC000",
                                        "mode": "fixed"
                                     }
                                  },
                                  {
                                     "id": "custom.fillOpacity",
                                     "value": 0
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "limit"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E02F44",
                                        "mode": "fixed"
                                     }
                                  },
                                  {
                                     "id": "custom.fillOpacity",
                                     "value": 0
                                  }
                               ]
                            }
                         ]
                      },
                      "gridPos": { },
                      "id": 13,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "targets": [
                         {
                            "expr": "sum by(pod) (rate(container_cpu_usage_seconds_total{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"index-gateway\"}[$__rate_interval]))",
                            "format": "time_series",
                            "legendFormat": "{{pod}}",
                            "legendLink": null
                         },
                         {
                            "expr": "min(kube_pod_container_resource_requests{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"index-gateway\", resource=\"cpu\"} > 0)",
                            "format": "time_series",
                            "legendFormat": "request",
                            "legendLink": null
                         },
                         {
                            "expr": "min(container_spec_cpu_quota{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"index-gateway\"} / container_spec_cpu_period{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"index-gateway\"})",
                            "format": "time_series",
                            "legendFormat": "limit",
                            "legendLink": null
                         }
                      ],
                      "title": "CPU",
                      "tooltip": {
                         "sort": 2
                      },
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "bytes"
                         },
                         "overrides": [
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "request"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#FFC000",
                                        "mode": "fixed"
                                     }
                                  },
                                  {
                                     "id": "custom.fillOpacity",
                                     "value": 0
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "limit"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E02F44",
                                        "mode": "fixed"
                                     }
                                  },
                                  {
                                     "id": "custom.fillOpacity",
                                     "value": 0
                                  }
                               ]
                            }
                         ]
                      },
                      "gridPos": { },
                      "id": 14,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "targets": [
                         {
                            "expr": "max by(pod) (container_memory_working_set_bytes{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"index-gateway\"})",
                            "format": "time_series",
                            "legendFormat": "{{pod}}",
                            "legendLink": null
                         },
                         {
                            "expr": "min(kube_pod_container_resource_requests{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"index-gateway\", resource=\"memory\"} > 0)",
                            "format": "time_series",
                            "legendFormat": "request",
                            "legendLink": null
                         },
                         {
                            "expr": "min(container_spec_memory_limit_bytes{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"index-gateway\"} > 0)",
                            "format": "time_series",
                            "legendFormat": "limit",
                            "legendLink": null
                         }
                      ],
                      "title": "Memory (workingset)",
                      "tooltip": {
                         "sort": 2
                      },
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "bytes"
                         },
                         "overrides": [ ]
                      },
                      "gridPos": { },
                      "id": 15,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "targets": [
                         {
                            "expr": "sum by(pod) (go_memstats_heap_inuse_bytes{cluster=~\"$cluster\", job=~\"($namespace)/index-gateway\"})",
                            "format": "time_series",
                            "legendFormat": "{{pod}}",
                            "legendLink": null
                         }
                      ],
                      "title": "Memory (go heap inuse)",
                      "tooltip": {
                         "sort": 2
                      },
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 100,
                               "lineWidth": 0,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "normal"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "Bps"
                         },
                         "overrides": [ ]
                      },
                      "gridPos": { },
                      "id": 16,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "targets": [
                         {
                            "expr": "sum by(instance, pod, device) (rate(node_disk_written_bytes_total[$__rate_interval])) + ignoring(pod) group_right() (label_replace(count by(instance, pod, device) (container_fs_writes_bytes_total{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"index-gateway\", device!~\".*sda.*\"}), \"device\", \"$1\", \"device\", \"/dev/(.*)\") * 0)\n",
                            "format": "time_series",
                            "legendFormat": "{{pod}} - {{device}}",
                            "legendLink": null
                         }
                      ],
                      "title": "Disk Writes",
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 100,
                               "lineWidth": 0,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "normal"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "Bps"
                         },
                         "overrides": [ ]
                      },
                      "gridPos": { },
                      "id": 17,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "targets": [
                         {
                            "expr": "sum by(instance, pod, device) (rate(node_disk_read_bytes_total[$__rate_interval])) + ignoring(pod) group_right() (label_replace(count by(instance, pod, device) (container_fs_writes_bytes_total{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"index-gateway\", device!~\".*sda.*\"}), \"device\", \"$1\", \"device\", \"/dev/(.*)\") * 0)\n",
                            "format": "time_series",
                            "legendFormat": "{{pod}} - {{device}}",
                            "legendLink": null
                         }
                      ],
                      "title": "Disk Reads",
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "percentunit"
                         },
                         "overrides": [ ]
                      },
                      "gridPos": { },
                      "id": 18,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "targets": [
                         {
                            "expr": "max by(persistentvolumeclaim) (kubelet_volume_stats_used_bytes{cluster=~\"$cluster\", namespace=~\"$namespace\"} / kubelet_volume_stats_capacity_bytes{cluster=~\"$cluster\", namespace=~\"$namespace\"}) and count by(persistentvolumeclaim) (kube_persistentvolumeclaim_labels{cluster=~\"$cluster\", namespace=~\"$namespace\",label_name=~\"index-gateway.*\"})",
                            "format": "time_series",
                            "legendFormat": "{{persistentvolumeclaim}}",
                            "legendLink": null
                         }
                      ],
                      "title": "Disk Space Utilization",
                      "type": "timeseries"
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "Index Gateway",
                "titleSize": "h6",
                "type": "row"
             },
             {
                "collapse": false,
                "collapsed": false,
                "panels": [
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "request"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#FFC000",
                                        "mode": "fixed"
                                     }
                                  },
                                  {
                                     "id": "custom.fillOpacity",
                                     "value": 0
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "limit"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E02F44",
                                        "mode": "fixed"
                                     }
                                  },
                                  {
                                     "id": "custom.fillOpacity",
                                     "value": 0
                                  }
                               ]
                            }
                         ]
                      },
                      "gridPos": { },
                      "id": 19,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "targets": [
                         {
                            "expr": "sum by(pod) (rate(container_cpu_usage_seconds_total{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"bloom-gateway\"}[$__rate_interval]))",
                            "format": "time_series",
                            "legendFormat": "{{pod}}",
                            "legendLink": null
                         },
                         {
                            "expr": "min(kube_pod_container_resource_requests{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"bloom-gateway\", resource=\"cpu\"} > 0)",
                            "format": "time_series",
                            "legendFormat": "request",
                            "legendLink": null
                         },
                         {
                            "expr": "min(container_spec_cpu_quota{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"bloom-gateway\"} / container_spec_cpu_period{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"bloom-gateway\"})",
                            "format": "time_series",
                            "legendFormat": "limit",
                            "legendLink": null
                         }
                      ],
                      "title": "CPU",
                      "tooltip": {
                         "sort": 2
                      },
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "bytes"
                         },
                         "overrides": [
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "request"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#FFC000",
                                        "mode": "fixed"
                                     }
                                  },
                                  {
                                     "id": "custom.fillOpacity",
                                     "value": 0
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "limit"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E02F44",
                                        "mode": "fixed"
                                     }
                                  },
                                  {
                                     "id": "custom.fillOpacity",
                                     "value": 0
                                  }
                               ]
                            }
                         ]
                      },
                      "gridPos": { },
                      "id": 20,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "targets": [
                         {
                            "expr": "max by(pod) (container_memory_working_set_bytes{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"bloom-gateway\"})",
                            "format": "time_series",
                            "legendFormat": "{{pod}}",
                            "legendLink": null
                         },
                         {
                            "expr": "min(kube_pod_container_resource_requests{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"bloom-gateway\", resource=\"memory\"} > 0)",
                            "format": "time_series",
                            "legendFormat": "request",
                            "legendLink": null
                         },
                         {
                            "expr": "min(container_spec_memory_limit_bytes{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"bloom-gateway\"} > 0)",
                            "format": "time_series",
                            "legendFormat": "limit",
                            "legendLink": null
                         }
                      ],
                      "title": "Memory (workingset)",
                      "tooltip": {
                         "sort": 2
                      },
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "bytes"
                         },
                         "overrides": [ ]
                      },
                      "gridPos": { },
                      "id": 21,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "targets": [
                         {
                            "expr": "sum by(pod) (go_memstats_heap_inuse_bytes{cluster=~\"$cluster\", job=~\"($namespace)/bloom-gateway\"})",
                            "format": "time_series",
                            "legendFormat": "{{pod}}",
                            "legendLink": null
                         }
                      ],
                      "title": "Memory (go heap inuse)",
                      "tooltip": {
                         "sort": 2
                      },
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 100,
                               "lineWidth": 0,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "normal"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "Bps"
                         },
                         "overrides": [ ]
                      },
                      "gridPos": { },
                      "id": 22,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "targets": [
                         {
                            "expr": "sum by(instance, pod, device) (rate(node_disk_written_bytes_total[$__rate_interval])) + ignoring(pod) group_right() (label_replace(count by(instance, pod, device) (container_fs_writes_bytes_total{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"bloom-gateway\", device!~\".*sda.*\"}), \"device\", \"$1\", \"device\", \"/dev/(.*)\") * 0)\n",
                            "format": "time_series",
                            "legendFormat": "{{pod}} - {{device}}",
                            "legendLink": null
                         }
                      ],
                      "title": "Disk Writes",
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 100,
                               "lineWidth": 0,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "normal"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "Bps"
                         },
                         "overrides": [ ]
                      },
                      "gridPos": { },
                      "id": 23,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "targets": [
                         {
                            "expr": "sum by(instance, pod, device) (rate(node_disk_read_bytes_total[$__rate_interval])) + ignoring(pod) group_right() (label_replace(count by(instance, pod, device) (container_fs_writes_bytes_total{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"bloom-gateway\", device!~\".*sda.*\"}), \"device\", \"$1\", \"device\", \"/dev/(.*)\") * 0)\n",
                            "format": "time_series",
                            "legendFormat": "{{pod}} - {{device}}",
                            "legendLink": null
                         }
                      ],
                      "title": "Disk Reads",
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "percentunit"
                         },
                         "overrides": [ ]
                      },
                      "gridPos": { },
                      "id": 24,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "targets": [
                         {
                            "expr": "max by(persistentvolumeclaim) (kubelet_volume_stats_used_bytes{cluster=~\"$cluster\", namespace=~\"$namespace\"} / kubelet_volume_stats_capacity_bytes{cluster=~\"$cluster\", namespace=~\"$namespace\"}) and count by(persistentvolumeclaim) (kube_persistentvolumeclaim_labels{cluster=~\"$cluster\", namespace=~\"$namespace\",label_name=~\"bloom-gateway.*\"})",
                            "format": "time_series",
                            "legendFormat": "{{persistentvolumeclaim}}",
                            "legendLink": null
                         }
                      ],
                      "title": "Disk Space Utilization",
                      "type": "timeseries"
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "Bloom Gateway",
                "titleSize": "h6",
                "type": "row"
             },
             {
                "collapse": false,
                "height": "250px",
                "panels": [
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "request"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#FFC000",
                                        "mode": "fixed"
                                     }
                                  },
                                  {
                                     "id": "custom.fillOpacity",
                                     "value": 0
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "limit"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E02F44",
                                        "mode": "fixed"
                                     }
                                  },
                                  {
                                     "id": "custom.fillOpacity",
                                     "value": 0
                                  }
                               ]
                            }
                         ]
                      },
                      "id": 25,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "sum by(pod) (rate(container_cpu_usage_seconds_total{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"ingester\"}[$__rate_interval]))",
                            "format": "time_series",
                            "legendFormat": "{{pod}}",
                            "legendLink": null
                         },
                         {
                            "expr": "min(kube_pod_container_resource_requests{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"ingester\", resource=\"cpu\"} > 0)",
                            "format": "time_series",
                            "legendFormat": "request",
                            "legendLink": null
                         },
                         {
                            "expr": "min(container_spec_cpu_quota{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"ingester\"} / container_spec_cpu_period{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"ingester\"})",
                            "format": "time_series",
                            "legendFormat": "limit",
                            "legendLink": null
                         }
                      ],
                      "title": "CPU",
                      "tooltip": {
                         "sort": 2
                      },
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "bytes"
                         },
                         "overrides": [
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "request"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#FFC000",
                                        "mode": "fixed"
                                     }
                                  },
                                  {
                                     "id": "custom.fillOpacity",
                                     "value": 0
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "limit"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E02F44",
                                        "mode": "fixed"
                                     }
                                  },
                                  {
                                     "id": "custom.fillOpacity",
                                     "value": 0
                                  }
                               ]
                            }
                         ]
                      },
                      "id": 26,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "max by(pod) (container_memory_working_set_bytes{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"ingester\"})",
                            "format": "time_series",
                            "legendFormat": "{{pod}}",
                            "legendLink": null
                         },
                         {
                            "expr": "min(kube_pod_container_resource_requests{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"ingester\", resource=\"memory\"} > 0)",
                            "format": "time_series",
                            "legendFormat": "request",
                            "legendLink": null
                         },
                         {
                            "expr": "min(container_spec_memory_limit_bytes{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"ingester\"} > 0)",
                            "format": "time_series",
                            "legendFormat": "limit",
                            "legendLink": null
                         }
                      ],
                      "title": "Memory (workingset)",
                      "tooltip": {
                         "sort": 2
                      },
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "bytes"
                         },
                         "overrides": [ ]
                      },
                      "id": 27,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "sum by(pod) (go_memstats_heap_inuse_bytes{cluster=~\"$cluster\", job=~\"($namespace)/ingester.+\"})",
                            "format": "time_series",
                            "legendFormat": "{{pod}}",
                            "legendLink": null
                         }
                      ],
                      "title": "Memory (go heap inuse)",
                      "tooltip": {
                         "sort": 2
                      },
                      "type": "timeseries"
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "Ingester",
                "titleSize": "h6"
             },
             {
                "collapse": false,
                "collapsed": false,
                "panels": [
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [ ]
                      },
                      "gridPos": { },
                      "id": 28,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "targets": [
                         {
                            "expr": "sum by(pod) (loki_prometheus_rule_group_rules{cluster=~\"$cluster\", job=~\"($namespace)/ruler\"}) or sum by(pod) (cortex_prometheus_rule_group_rules{cluster=~\"$cluster\", job=~\"($namespace)/ruler\"})",
                            "format": "time_series",
                            "legendFormat": "{{pod}}",
                            "legendLink": null
                         }
                      ],
                      "title": "Rules",
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "request"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#FFC000",
                                        "mode": "fixed"
                                     }
                                  },
                                  {
                                     "id": "custom.fillOpacity",
                                     "value": 0
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "limit"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E02F44",
                                        "mode": "fixed"
                                     }
                                  },
                                  {
                                     "id": "custom.fillOpacity",
                                     "value": 0
                                  }
                               ]
                            }
                         ]
                      },
                      "gridPos": { },
                      "id": 29,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "targets": [
                         {
                            "expr": "sum by(pod) (rate(container_cpu_usage_seconds_total{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"ruler\"}[$__rate_interval]))",
                            "format": "time_series",
                            "legendFormat": "{{pod}}",
                            "legendLink": null
                         },
                         {
                            "expr": "min(kube_pod_container_resource_requests{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"ruler\", resource=\"cpu\"} > 0)",
                            "format": "time_series",
                            "legendFormat": "request",
                            "legendLink": null
                         },
                         {
                            "expr": "min(container_spec_cpu_quota{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"ruler\"} / container_spec_cpu_period{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"ruler\"})",
                            "format": "time_series",
                            "legendFormat": "limit",
                            "legendLink": null
                         }
                      ],
                      "title": "CPU",
                      "tooltip": {
                         "sort": 2
                      },
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "bytes"
                         },
                         "overrides": [
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "request"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#FFC000",
                                        "mode": "fixed"
                                     }
                                  },
                                  {
                                     "id": "custom.fillOpacity",
                                     "value": 0
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "limit"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E02F44",
                                        "mode": "fixed"
                                     }
                                  },
                                  {
                                     "id": "custom.fillOpacity",
                                     "value": 0
                                  }
                               ]
                            }
                         ]
                      },
                      "gridPos": { },
                      "id": 30,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "targets": [
                         {
                            "expr": "max by(pod) (container_memory_working_set_bytes{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"ruler\"})",
                            "format": "time_series",
                            "legendFormat": "{{pod}}",
                            "legendLink": null
                         },
                         {
                            "expr": "min(kube_pod_container_resource_requests{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"ruler\", resource=\"memory\"} > 0)",
                            "format": "time_series",
                            "legendFormat": "request",
                            "legendLink": null
                         },
                         {
                            "expr": "min(container_spec_memory_limit_bytes{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"ruler\"} > 0)",
                            "format": "time_series",
                            "legendFormat": "limit",
                            "legendLink": null
                         }
                      ],
                      "title": "Memory (workingset)",
                      "tooltip": {
                         "sort": 2
                      },
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "bytes"
                         },
                         "overrides": [ ]
                      },
                      "gridPos": { },
                      "id": 31,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "targets": [
                         {
                            "expr": "sum by(pod) (go_memstats_heap_inuse_bytes{cluster=~\"$cluster\", job=~\"($namespace)/ruler\"})",
                            "format": "time_series",
                            "legendFormat": "{{pod}}",
                            "legendLink": null
                         }
                      ],
                      "title": "Memory (go heap inuse)",
                      "tooltip": {
                         "sort": 2
                      },
                      "type": "timeseries"
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "Ruler",
                "titleSize": "h6",
                "type": "row"
             }
          ],
          "schemaVersion": 14,
          "style": "dark",
          "tags": [
             "loki"
          ],
          "templating": {
             "list": [
                {
                   "current": {
                      "text": "default",
                      "value": "default"
                   },
                   "hide": 0,
                   "label": "Data source",
                   "name": "datasource",
                   "options": [ ],
                   "query": "prometheus",
                   "refresh": 1,
                   "regex": "",
                   "type": "datasource"
                },
                {
                   "allValue": null,
                   "current": {
                      "text": "prod",
                      "value": "prod"
                   },
                   "datasource": "$datasource",
                   "hide": 0,
                   "includeAll": false,
                   "label": "cluster",
                   "multi": false,
                   "name": "cluster",
                   "options": [ ],
                   "query": "label_values(loki_build_info, cluster)",
                   "refresh": 1,
                   "regex": "",
                   "sort": 2,
                   "tagValuesQuery": "",
                   "tags": [ ],
                   "tagsQuery": "",
                   "type": "query",
                   "useTags": false
                },
                {
                   "allValue": null,
                   "current": {
                      "text": "prod",
                      "value": "prod"
                   },
                   "datasource": "$datasource",
                   "hide": 0,
                   "includeAll": false,
                   "label": "namespace",
                   "multi": false,
                   "name": "namespace",
                   "options": [ ],
                   "query": "label_values(loki_build_info{cluster=~\"$cluster\"}, namespace)",
                   "refresh": 1,
                   "regex": "",
                   "sort": 2,
                   "tagValuesQuery": "",
                   "tags": [ ],
                   "tagsQuery": "",
                   "type": "query",
                   "useTags": false
                }
             ]
          },
          "time": {
             "from": "now-1h",
             "to": "now"
          },
          "timepicker": {
             "refresh_intervals": [
                "5s",
                "10s",
                "30s",
                "1m",
                "5m",
                "15m",
                "30m",
                "1h",
                "2h",
                "1d"
             ],
             "time_options": [
                "5m",
                "15m",
                "1h",
                "6h",
                "12h",
                "24h",
                "2d",
                "7d",
                "30d"
             ]
          },
          "timezone": "utc",
          "title": "Loki / Reads Resources",
          "uid": "reads-resources",
          "version": 0
       }
kind: ConfigMap
metadata:
  annotations:
    grafana_dashboard_folder: /dashboards/Loki Mixin
  labels:
    grafana_dashboard: "1"
  name: loki-reads-resources.json
  namespace: monitoring-system
---
apiVersion: v1
data:
  loki-reads.json: |-
    {
          "annotations": {
             "list": [ ]
          },
          "editable": true,
          "gnetId": null,
          "graphTooltip": 0,
          "hideControls": false,
          "links": [
             {
                "asDropdown": true,
                "icon": "external link",
                "includeVars": true,
                "keepTime": true,
                "tags": [
                   "loki"
                ],
                "targetBlank": false,
                "title": "Loki Dashboards",
                "type": "dashboards"
             }
          ],
          "refresh": "10s",
          "rows": [
             {
                "collapse": false,
                "height": "250px",
                "panels": [
                   {
                      "aliasColors": {
                         "1xx": "#EAB839",
                         "2xx": "#7EB26D",
                         "3xx": "#6ED0E0",
                         "4xx": "#EF843C",
                         "5xx": "#E24D42",
                         "OK": "#7EB26D",
                         "cancel": "#A9A9A9",
                         "error": "#E24D42",
                         "success": "#7EB26D"
                      },
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 100,
                               "lineWidth": 0,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "normal"
                               }
                            },
                            "min": 0,
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "1xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#EAB839",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "2xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "3xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#6ED0E0",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "4xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#EF843C",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "5xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E24D42",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "OK"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "cancel"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#A9A9A9",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "error"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E24D42",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "success"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            }
                         ]
                      },
                      "fill": 10,
                      "id": 1,
                      "linewidth": 0,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "stack": true,
                      "targets": [
                         {
                            "expr": "sum by (status) (\n  label_replace(label_replace(rate(loki_request_duration_seconds_count{cluster=~\"$cluster\",job=~\"($namespace)/query-frontend\", route=~\"(api_prom_rules|api_prom_rules_namespace_groupname|api_v1_rules|loki_api_v1_delete|loki_api_v1_detected_labels|loki_api_v1_index_stats|loki_api_v1_index_volume|loki_api_v1_index_volume_range|loki_api_v1_label_name_values|loki_api_v1_label_values|loki_api_v1_labels|loki_api_v1_patterns|loki_api_v1_query|loki_api_v1_query_range|loki_api_v1_series|otlp_v1_logs|prometheus_api_v1_rules)\"}[$__rate_interval]),\n  \"status\", \"${1}xx\", \"status_code\", \"([0-9])..\"),\n  \"status\", \"${1}\", \"status_code\", \"([a-zA-Z]+)\"))\n",
                            "format": "time_series",
                            "legendFormat": "{{status}}",
                            "refId": "A"
                         }
                      ],
                      "title": "QPS",
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "ms"
                         },
                         "overrides": [ ]
                      },
                      "id": 2,
                      "links": [ ],
                      "nullPointMode": "null as zero",
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "histogram_quantile(0.99, sum by (le,route) (cluster_job_route:loki_request_duration_seconds_bucket:sum_rate{cluster=~\"$cluster\", job=~\"($namespace)/query-frontend\", route=~\"(api_prom_rules|api_prom_rules_namespace_groupname|api_v1_rules|loki_api_v1_delete|loki_api_v1_detected_labels|loki_api_v1_index_stats|loki_api_v1_index_volume|loki_api_v1_index_volume_range|loki_api_v1_label_name_values|loki_api_v1_label_values|loki_api_v1_labels|loki_api_v1_patterns|loki_api_v1_query|loki_api_v1_query_range|loki_api_v1_series|otlp_v1_logs|prometheus_api_v1_rules)\"})) * 1e3",
                            "format": "time_series",
                            "legendFormat": "{{ route }} 99th percentile",
                            "refId": "A"
                         },
                         {
                            "expr": "histogram_quantile(0.50, sum by (le,route) (cluster_job_route:loki_request_duration_seconds_bucket:sum_rate{cluster=~\"$cluster\", job=~\"($namespace)/query-frontend\", route=~\"(api_prom_rules|api_prom_rules_namespace_groupname|api_v1_rules|loki_api_v1_delete|loki_api_v1_detected_labels|loki_api_v1_index_stats|loki_api_v1_index_volume|loki_api_v1_index_volume_range|loki_api_v1_label_name_values|loki_api_v1_label_values|loki_api_v1_labels|loki_api_v1_patterns|loki_api_v1_query|loki_api_v1_query_range|loki_api_v1_series|otlp_v1_logs|prometheus_api_v1_rules)\"})) * 1e3",
                            "format": "time_series",
                            "legendFormat": "{{ route }} 50th percentile",
                            "refId": "B"
                         },
                         {
                            "expr": "1e3 * sum(cluster_job_route:loki_request_duration_seconds_sum:sum_rate{cluster=~\"$cluster\", job=~\"($namespace)/query-frontend\", route=~\"(api_prom_rules|api_prom_rules_namespace_groupname|api_v1_rules|loki_api_v1_delete|loki_api_v1_detected_labels|loki_api_v1_index_stats|loki_api_v1_index_volume|loki_api_v1_index_volume_range|loki_api_v1_label_name_values|loki_api_v1_label_values|loki_api_v1_labels|loki_api_v1_patterns|loki_api_v1_query|loki_api_v1_query_range|loki_api_v1_series|otlp_v1_logs|prometheus_api_v1_rules)\"}) by (route)  / sum(cluster_job_route:loki_request_duration_seconds_count:sum_rate{cluster=~\"$cluster\", job=~\"($namespace)/query-frontend\", route=~\"(api_prom_rules|api_prom_rules_namespace_groupname|api_v1_rules|loki_api_v1_delete|loki_api_v1_detected_labels|loki_api_v1_index_stats|loki_api_v1_index_volume|loki_api_v1_index_volume_range|loki_api_v1_label_name_values|loki_api_v1_label_values|loki_api_v1_labels|loki_api_v1_patterns|loki_api_v1_query|loki_api_v1_query_range|loki_api_v1_series|otlp_v1_logs|prometheus_api_v1_rules)\"}) by (route) ",
                            "format": "time_series",
                            "legendFormat": "{{ route }} Average",
                            "refId": "C"
                         }
                      ],
                      "title": "Latency",
                      "type": "timeseries",
                      "yaxes": [
                         {
                            "format": "ms",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": 0,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": false
                         }
                      ]
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "ms"
                         },
                         "overrides": [ ]
                      },
                      "id": 3,
                      "links": [ ],
                      "nullPointMode": "null as zero",
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "histogram_quantile(0.99, sum(rate(loki_request_duration_seconds_bucket{cluster=~\"$cluster\", job=~\"($namespace)/query-frontend\", route=~\"(api_prom_rules|api_prom_rules_namespace_groupname|api_v1_rules|loki_api_v1_delete|loki_api_v1_detected_labels|loki_api_v1_index_stats|loki_api_v1_index_volume|loki_api_v1_index_volume_range|loki_api_v1_label_name_values|loki_api_v1_label_values|loki_api_v1_labels|loki_api_v1_patterns|loki_api_v1_query|loki_api_v1_query_range|loki_api_v1_series|otlp_v1_logs|prometheus_api_v1_rules)\"}[$__rate_interval])) by (le,pod)) * 1e3",
                            "format": "time_series",
                            "interval": "1m",
                            "intervalFactor": 2,
                            "legendFormat": "__auto",
                            "refId": "A",
                            "step": 10
                         }
                      ],
                      "title": "Per Pod Latency (p99)",
                      "type": "timeseries"
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "Frontend (query-frontend)",
                "titleSize": "h6"
             },
             {
                "collapse": false,
                "height": "250px",
                "panels": [
                   {
                      "aliasColors": {
                         "1xx": "#EAB839",
                         "2xx": "#7EB26D",
                         "3xx": "#6ED0E0",
                         "4xx": "#EF843C",
                         "5xx": "#E24D42",
                         "OK": "#7EB26D",
                         "cancel": "#A9A9A9",
                         "error": "#E24D42",
                         "success": "#7EB26D"
                      },
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 100,
                               "lineWidth": 0,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "normal"
                               }
                            },
                            "min": 0,
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "1xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#EAB839",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "2xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "3xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#6ED0E0",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "4xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#EF843C",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "5xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E24D42",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "OK"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "cancel"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#A9A9A9",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "error"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E24D42",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "success"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            }
                         ]
                      },
                      "fill": 10,
                      "id": 4,
                      "linewidth": 0,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "stack": true,
                      "targets": [
                         {
                            "expr": "sum by (status) (\n  label_replace(label_replace(rate(loki_request_duration_seconds_count{cluster=~\"$cluster\",job=~\"($namespace)/querier\", route=~\"(api_prom_rules|api_prom_rules_namespace_groupname|api_v1_rules|loki_api_v1_delete|loki_api_v1_detected_labels|loki_api_v1_index_stats|loki_api_v1_index_volume|loki_api_v1_index_volume_range|loki_api_v1_label_name_values|loki_api_v1_label_values|loki_api_v1_labels|loki_api_v1_patterns|loki_api_v1_query|loki_api_v1_query_range|loki_api_v1_series|otlp_v1_logs|prometheus_api_v1_rules)\"}[$__rate_interval]),\n  \"status\", \"${1}xx\", \"status_code\", \"([0-9])..\"),\n  \"status\", \"${1}\", \"status_code\", \"([a-zA-Z]+)\"))\n",
                            "format": "time_series",
                            "legendFormat": "{{status}}",
                            "refId": "A"
                         }
                      ],
                      "title": "QPS",
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "ms"
                         },
                         "overrides": [ ]
                      },
                      "id": 5,
                      "links": [ ],
                      "nullPointMode": "null as zero",
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "histogram_quantile(0.99, sum by (le,route) (cluster_job_route:loki_request_duration_seconds_bucket:sum_rate{cluster=~\"$cluster\", job=~\"($namespace)/querier\", route=~\"(api_prom_rules|api_prom_rules_namespace_groupname|api_v1_rules|loki_api_v1_delete|loki_api_v1_detected_labels|loki_api_v1_index_stats|loki_api_v1_index_volume|loki_api_v1_index_volume_range|loki_api_v1_label_name_values|loki_api_v1_label_values|loki_api_v1_labels|loki_api_v1_patterns|loki_api_v1_query|loki_api_v1_query_range|loki_api_v1_series|otlp_v1_logs|prometheus_api_v1_rules)\"})) * 1e3",
                            "format": "time_series",
                            "legendFormat": "{{ route }} 99th percentile",
                            "refId": "A"
                         },
                         {
                            "expr": "histogram_quantile(0.50, sum by (le,route) (cluster_job_route:loki_request_duration_seconds_bucket:sum_rate{cluster=~\"$cluster\", job=~\"($namespace)/querier\", route=~\"(api_prom_rules|api_prom_rules_namespace_groupname|api_v1_rules|loki_api_v1_delete|loki_api_v1_detected_labels|loki_api_v1_index_stats|loki_api_v1_index_volume|loki_api_v1_index_volume_range|loki_api_v1_label_name_values|loki_api_v1_label_values|loki_api_v1_labels|loki_api_v1_patterns|loki_api_v1_query|loki_api_v1_query_range|loki_api_v1_series|otlp_v1_logs|prometheus_api_v1_rules)\"})) * 1e3",
                            "format": "time_series",
                            "legendFormat": "{{ route }} 50th percentile",
                            "refId": "B"
                         },
                         {
                            "expr": "1e3 * sum(cluster_job_route:loki_request_duration_seconds_sum:sum_rate{cluster=~\"$cluster\", job=~\"($namespace)/querier\", route=~\"(api_prom_rules|api_prom_rules_namespace_groupname|api_v1_rules|loki_api_v1_delete|loki_api_v1_detected_labels|loki_api_v1_index_stats|loki_api_v1_index_volume|loki_api_v1_index_volume_range|loki_api_v1_label_name_values|loki_api_v1_label_values|loki_api_v1_labels|loki_api_v1_patterns|loki_api_v1_query|loki_api_v1_query_range|loki_api_v1_series|otlp_v1_logs|prometheus_api_v1_rules)\"}) by (route)  / sum(cluster_job_route:loki_request_duration_seconds_count:sum_rate{cluster=~\"$cluster\", job=~\"($namespace)/querier\", route=~\"(api_prom_rules|api_prom_rules_namespace_groupname|api_v1_rules|loki_api_v1_delete|loki_api_v1_detected_labels|loki_api_v1_index_stats|loki_api_v1_index_volume|loki_api_v1_index_volume_range|loki_api_v1_label_name_values|loki_api_v1_label_values|loki_api_v1_labels|loki_api_v1_patterns|loki_api_v1_query|loki_api_v1_query_range|loki_api_v1_series|otlp_v1_logs|prometheus_api_v1_rules)\"}) by (route) ",
                            "format": "time_series",
                            "legendFormat": "{{ route }} Average",
                            "refId": "C"
                         }
                      ],
                      "title": "Latency",
                      "type": "timeseries",
                      "yaxes": [
                         {
                            "format": "ms",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": 0,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": false
                         }
                      ]
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "ms"
                         },
                         "overrides": [ ]
                      },
                      "id": 6,
                      "links": [ ],
                      "nullPointMode": "null as zero",
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "histogram_quantile(0.99, sum(rate(loki_request_duration_seconds_bucket{cluster=~\"$cluster\", job=~\"($namespace)/querier\", route=~\"(api_prom_rules|api_prom_rules_namespace_groupname|api_v1_rules|loki_api_v1_delete|loki_api_v1_detected_labels|loki_api_v1_index_stats|loki_api_v1_index_volume|loki_api_v1_index_volume_range|loki_api_v1_label_name_values|loki_api_v1_label_values|loki_api_v1_labels|loki_api_v1_patterns|loki_api_v1_query|loki_api_v1_query_range|loki_api_v1_series|otlp_v1_logs|prometheus_api_v1_rules)\"}[$__rate_interval])) by (le,pod)) * 1e3",
                            "format": "time_series",
                            "interval": "1m",
                            "intervalFactor": 2,
                            "legendFormat": "__auto",
                            "refId": "A",
                            "step": 10
                         }
                      ],
                      "title": "Per Pod Latency (p99)",
                      "type": "timeseries"
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "Querier",
                "titleSize": "h6"
             },
             {
                "collapse": false,
                "height": "250px",
                "panels": [
                   {
                      "aliasColors": {
                         "1xx": "#EAB839",
                         "2xx": "#7EB26D",
                         "3xx": "#6ED0E0",
                         "4xx": "#EF843C",
                         "5xx": "#E24D42",
                         "OK": "#7EB26D",
                         "cancel": "#A9A9A9",
                         "error": "#E24D42",
                         "success": "#7EB26D"
                      },
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 100,
                               "lineWidth": 0,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "normal"
                               }
                            },
                            "min": 0,
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "1xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#EAB839",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "2xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "3xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#6ED0E0",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "4xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#EF843C",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "5xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E24D42",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "OK"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "cancel"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#A9A9A9",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "error"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E24D42",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "success"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            }
                         ]
                      },
                      "fill": 10,
                      "id": 7,
                      "linewidth": 0,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "stack": true,
                      "targets": [
                         {
                            "expr": "sum by (status) (\n  label_replace(label_replace(rate(loki_request_duration_seconds_count{cluster=~\"$cluster\",job=~\"($namespace)/ingester\", route=~\"(/base.Ruler/Rules|/indexgatewaypb.IndexGateway/GetChunkRef|/indexgatewaypb.IndexGateway/GetSeries|/indexgatewaypb.IndexGateway/GetShards|/indexgatewaypb.IndexGateway/GetStats|/indexgatewaypb.IndexGateway/GetVolume|/indexgatewaypb.IndexGateway/LabelNamesForMetricName|/indexgatewaypb.IndexGateway/LabelValuesForMetricName|/indexgatewaypb.IndexGateway/QueryIndex|/logproto.BloomGateway/FilterChunkRefs|/logproto.Pattern/Query|/logproto.Querier/GetChunkIDs|/logproto.Querier/GetDetectedLabels|/logproto.Querier/GetStats|/logproto.Querier/GetVolume|/logproto.Querier/Label|/logproto.Querier/Query|/logproto.Querier/QuerySample|/logproto.Querier/Series|/logproto.StreamData/GetStreamRates)\"}[$__rate_interval]),\n  \"status\", \"${1}xx\", \"status_code\", \"([0-9])..\"),\n  \"status\", \"${1}\", \"status_code\", \"([a-zA-Z]+)\"))\n",
                            "format": "time_series",
                            "legendFormat": "{{status}}",
                            "refId": "A"
                         }
                      ],
                      "title": "QPS",
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "ms"
                         },
                         "overrides": [ ]
                      },
                      "id": 8,
                      "links": [ ],
                      "nullPointMode": "null as zero",
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "histogram_quantile(0.99, sum by (le,route) (cluster_job_route:loki_request_duration_seconds_bucket:sum_rate{cluster=~\"$cluster\", job=~\"($namespace)/ingester\", route=~\"(/base.Ruler/Rules|/indexgatewaypb.IndexGateway/GetChunkRef|/indexgatewaypb.IndexGateway/GetSeries|/indexgatewaypb.IndexGateway/GetShards|/indexgatewaypb.IndexGateway/GetStats|/indexgatewaypb.IndexGateway/GetVolume|/indexgatewaypb.IndexGateway/LabelNamesForMetricName|/indexgatewaypb.IndexGateway/LabelValuesForMetricName|/indexgatewaypb.IndexGateway/QueryIndex|/logproto.BloomGateway/FilterChunkRefs|/logproto.Pattern/Query|/logproto.Querier/GetChunkIDs|/logproto.Querier/GetDetectedLabels|/logproto.Querier/GetStats|/logproto.Querier/GetVolume|/logproto.Querier/Label|/logproto.Querier/Query|/logproto.Querier/QuerySample|/logproto.Querier/Series|/logproto.StreamData/GetStreamRates)\"})) * 1e3",
                            "format": "time_series",
                            "legendFormat": "{{ route }} 99th percentile",
                            "refId": "A"
                         },
                         {
                            "expr": "histogram_quantile(0.50, sum by (le,route) (cluster_job_route:loki_request_duration_seconds_bucket:sum_rate{cluster=~\"$cluster\", job=~\"($namespace)/ingester\", route=~\"(/base.Ruler/Rules|/indexgatewaypb.IndexGateway/GetChunkRef|/indexgatewaypb.IndexGateway/GetSeries|/indexgatewaypb.IndexGateway/GetShards|/indexgatewaypb.IndexGateway/GetStats|/indexgatewaypb.IndexGateway/GetVolume|/indexgatewaypb.IndexGateway/LabelNamesForMetricName|/indexgatewaypb.IndexGateway/LabelValuesForMetricName|/indexgatewaypb.IndexGateway/QueryIndex|/logproto.BloomGateway/FilterChunkRefs|/logproto.Pattern/Query|/logproto.Querier/GetChunkIDs|/logproto.Querier/GetDetectedLabels|/logproto.Querier/GetStats|/logproto.Querier/GetVolume|/logproto.Querier/Label|/logproto.Querier/Query|/logproto.Querier/QuerySample|/logproto.Querier/Series|/logproto.StreamData/GetStreamRates)\"})) * 1e3",
                            "format": "time_series",
                            "legendFormat": "{{ route }} 50th percentile",
                            "refId": "B"
                         },
                         {
                            "expr": "1e3 * sum(cluster_job_route:loki_request_duration_seconds_sum:sum_rate{cluster=~\"$cluster\", job=~\"($namespace)/ingester\", route=~\"(/base.Ruler/Rules|/indexgatewaypb.IndexGateway/GetChunkRef|/indexgatewaypb.IndexGateway/GetSeries|/indexgatewaypb.IndexGateway/GetShards|/indexgatewaypb.IndexGateway/GetStats|/indexgatewaypb.IndexGateway/GetVolume|/indexgatewaypb.IndexGateway/LabelNamesForMetricName|/indexgatewaypb.IndexGateway/LabelValuesForMetricName|/indexgatewaypb.IndexGateway/QueryIndex|/logproto.BloomGateway/FilterChunkRefs|/logproto.Pattern/Query|/logproto.Querier/GetChunkIDs|/logproto.Querier/GetDetectedLabels|/logproto.Querier/GetStats|/logproto.Querier/GetVolume|/logproto.Querier/Label|/logproto.Querier/Query|/logproto.Querier/QuerySample|/logproto.Querier/Series|/logproto.StreamData/GetStreamRates)\"}) by (route)  / sum(cluster_job_route:loki_request_duration_seconds_count:sum_rate{cluster=~\"$cluster\", job=~\"($namespace)/ingester\", route=~\"(/base.Ruler/Rules|/indexgatewaypb.IndexGateway/GetChunkRef|/indexgatewaypb.IndexGateway/GetSeries|/indexgatewaypb.IndexGateway/GetShards|/indexgatewaypb.IndexGateway/GetStats|/indexgatewaypb.IndexGateway/GetVolume|/indexgatewaypb.IndexGateway/LabelNamesForMetricName|/indexgatewaypb.IndexGateway/LabelValuesForMetricName|/indexgatewaypb.IndexGateway/QueryIndex|/logproto.BloomGateway/FilterChunkRefs|/logproto.Pattern/Query|/logproto.Querier/GetChunkIDs|/logproto.Querier/GetDetectedLabels|/logproto.Querier/GetStats|/logproto.Querier/GetVolume|/logproto.Querier/Label|/logproto.Querier/Query|/logproto.Querier/QuerySample|/logproto.Querier/Series|/logproto.StreamData/GetStreamRates)\"}) by (route) ",
                            "format": "time_series",
                            "legendFormat": "{{ route }} Average",
                            "refId": "C"
                         }
                      ],
                      "title": "Latency",
                      "type": "timeseries",
                      "yaxes": [
                         {
                            "format": "ms",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": 0,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": false
                         }
                      ]
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "ms"
                         },
                         "overrides": [ ]
                      },
                      "id": 9,
                      "links": [ ],
                      "nullPointMode": "null as zero",
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "histogram_quantile(0.99, sum(rate(loki_request_duration_seconds_bucket{cluster=~\"$cluster\", job=~\"($namespace)/ingester\", route=~\"(/base.Ruler/Rules|/indexgatewaypb.IndexGateway/GetChunkRef|/indexgatewaypb.IndexGateway/GetSeries|/indexgatewaypb.IndexGateway/GetShards|/indexgatewaypb.IndexGateway/GetStats|/indexgatewaypb.IndexGateway/GetVolume|/indexgatewaypb.IndexGateway/LabelNamesForMetricName|/indexgatewaypb.IndexGateway/LabelValuesForMetricName|/indexgatewaypb.IndexGateway/QueryIndex|/logproto.BloomGateway/FilterChunkRefs|/logproto.Pattern/Query|/logproto.Querier/GetChunkIDs|/logproto.Querier/GetDetectedLabels|/logproto.Querier/GetStats|/logproto.Querier/GetVolume|/logproto.Querier/Label|/logproto.Querier/Query|/logproto.Querier/QuerySample|/logproto.Querier/Series|/logproto.StreamData/GetStreamRates)\"}[$__rate_interval])) by (le,pod)) * 1e3",
                            "format": "time_series",
                            "interval": "1m",
                            "intervalFactor": 2,
                            "legendFormat": "__auto",
                            "refId": "A",
                            "step": 10
                         }
                      ],
                      "title": "Per Pod Latency (p99)",
                      "type": "timeseries"
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "Ingester",
                "titleSize": "h6"
             },
             {
                "collapse": false,
                "height": "250px",
                "panels": [
                   {
                      "aliasColors": {
                         "1xx": "#EAB839",
                         "2xx": "#7EB26D",
                         "3xx": "#6ED0E0",
                         "4xx": "#EF843C",
                         "5xx": "#E24D42",
                         "OK": "#7EB26D",
                         "cancel": "#A9A9A9",
                         "error": "#E24D42",
                         "success": "#7EB26D"
                      },
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 100,
                               "lineWidth": 0,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "normal"
                               }
                            },
                            "min": 0,
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "1xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#EAB839",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "2xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "3xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#6ED0E0",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "4xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#EF843C",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "5xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E24D42",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "OK"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "cancel"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#A9A9A9",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "error"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E24D42",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "success"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            }
                         ]
                      },
                      "fill": 10,
                      "id": 10,
                      "linewidth": 0,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "stack": true,
                      "targets": [
                         {
                            "expr": "sum by (status) (\n  label_replace(label_replace(rate(loki_request_duration_seconds_count{cluster=~\"$cluster\",job=~\"($namespace)/ingester-zone.*\", route=~\"(/base.Ruler/Rules|/indexgatewaypb.IndexGateway/GetChunkRef|/indexgatewaypb.IndexGateway/GetSeries|/indexgatewaypb.IndexGateway/GetShards|/indexgatewaypb.IndexGateway/GetStats|/indexgatewaypb.IndexGateway/GetVolume|/indexgatewaypb.IndexGateway/LabelNamesForMetricName|/indexgatewaypb.IndexGateway/LabelValuesForMetricName|/indexgatewaypb.IndexGateway/QueryIndex|/logproto.BloomGateway/FilterChunkRefs|/logproto.Pattern/Query|/logproto.Querier/GetChunkIDs|/logproto.Querier/GetDetectedLabels|/logproto.Querier/GetStats|/logproto.Querier/GetVolume|/logproto.Querier/Label|/logproto.Querier/Query|/logproto.Querier/QuerySample|/logproto.Querier/Series|/logproto.StreamData/GetStreamRates)\"}[$__rate_interval]),\n  \"status\", \"${1}xx\", \"status_code\", \"([0-9])..\"),\n  \"status\", \"${1}\", \"status_code\", \"([a-zA-Z]+)\"))\n",
                            "format": "time_series",
                            "legendFormat": "{{status}}",
                            "refId": "A"
                         }
                      ],
                      "title": "QPS",
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "ms"
                         },
                         "overrides": [ ]
                      },
                      "id": 11,
                      "links": [ ],
                      "nullPointMode": "null as zero",
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "histogram_quantile(0.99, sum by (le,route) (cluster_job_route:loki_request_duration_seconds_bucket:sum_rate{cluster=~\"$cluster\", job=~\"($namespace)/ingester-zone.*\", route=~\"(/base.Ruler/Rules|/indexgatewaypb.IndexGateway/GetChunkRef|/indexgatewaypb.IndexGateway/GetSeries|/indexgatewaypb.IndexGateway/GetShards|/indexgatewaypb.IndexGateway/GetStats|/indexgatewaypb.IndexGateway/GetVolume|/indexgatewaypb.IndexGateway/LabelNamesForMetricName|/indexgatewaypb.IndexGateway/LabelValuesForMetricName|/indexgatewaypb.IndexGateway/QueryIndex|/logproto.BloomGateway/FilterChunkRefs|/logproto.Pattern/Query|/logproto.Querier/GetChunkIDs|/logproto.Querier/GetDetectedLabels|/logproto.Querier/GetStats|/logproto.Querier/GetVolume|/logproto.Querier/Label|/logproto.Querier/Query|/logproto.Querier/QuerySample|/logproto.Querier/Series|/logproto.StreamData/GetStreamRates)\"})) * 1e3",
                            "format": "time_series",
                            "legendFormat": "{{ route }} 99th percentile",
                            "refId": "A"
                         },
                         {
                            "expr": "histogram_quantile(0.50, sum by (le,route) (cluster_job_route:loki_request_duration_seconds_bucket:sum_rate{cluster=~\"$cluster\", job=~\"($namespace)/ingester-zone.*\", route=~\"(/base.Ruler/Rules|/indexgatewaypb.IndexGateway/GetChunkRef|/indexgatewaypb.IndexGateway/GetSeries|/indexgatewaypb.IndexGateway/GetShards|/indexgatewaypb.IndexGateway/GetStats|/indexgatewaypb.IndexGateway/GetVolume|/indexgatewaypb.IndexGateway/LabelNamesForMetricName|/indexgatewaypb.IndexGateway/LabelValuesForMetricName|/indexgatewaypb.IndexGateway/QueryIndex|/logproto.BloomGateway/FilterChunkRefs|/logproto.Pattern/Query|/logproto.Querier/GetChunkIDs|/logproto.Querier/GetDetectedLabels|/logproto.Querier/GetStats|/logproto.Querier/GetVolume|/logproto.Querier/Label|/logproto.Querier/Query|/logproto.Querier/QuerySample|/logproto.Querier/Series|/logproto.StreamData/GetStreamRates)\"})) * 1e3",
                            "format": "time_series",
                            "legendFormat": "{{ route }} 50th percentile",
                            "refId": "B"
                         },
                         {
                            "expr": "1e3 * sum(cluster_job_route:loki_request_duration_seconds_sum:sum_rate{cluster=~\"$cluster\", job=~\"($namespace)/ingester-zone.*\", route=~\"(/base.Ruler/Rules|/indexgatewaypb.IndexGateway/GetChunkRef|/indexgatewaypb.IndexGateway/GetSeries|/indexgatewaypb.IndexGateway/GetShards|/indexgatewaypb.IndexGateway/GetStats|/indexgatewaypb.IndexGateway/GetVolume|/indexgatewaypb.IndexGateway/LabelNamesForMetricName|/indexgatewaypb.IndexGateway/LabelValuesForMetricName|/indexgatewaypb.IndexGateway/QueryIndex|/logproto.BloomGateway/FilterChunkRefs|/logproto.Pattern/Query|/logproto.Querier/GetChunkIDs|/logproto.Querier/GetDetectedLabels|/logproto.Querier/GetStats|/logproto.Querier/GetVolume|/logproto.Querier/Label|/logproto.Querier/Query|/logproto.Querier/QuerySample|/logproto.Querier/Series|/logproto.StreamData/GetStreamRates)\"}) by (route)  / sum(cluster_job_route:loki_request_duration_seconds_count:sum_rate{cluster=~\"$cluster\", job=~\"($namespace)/ingester-zone.*\", route=~\"(/base.Ruler/Rules|/indexgatewaypb.IndexGateway/GetChunkRef|/indexgatewaypb.IndexGateway/GetSeries|/indexgatewaypb.IndexGateway/GetShards|/indexgatewaypb.IndexGateway/GetStats|/indexgatewaypb.IndexGateway/GetVolume|/indexgatewaypb.IndexGateway/LabelNamesForMetricName|/indexgatewaypb.IndexGateway/LabelValuesForMetricName|/indexgatewaypb.IndexGateway/QueryIndex|/logproto.BloomGateway/FilterChunkRefs|/logproto.Pattern/Query|/logproto.Querier/GetChunkIDs|/logproto.Querier/GetDetectedLabels|/logproto.Querier/GetStats|/logproto.Querier/GetVolume|/logproto.Querier/Label|/logproto.Querier/Query|/logproto.Querier/QuerySample|/logproto.Querier/Series|/logproto.StreamData/GetStreamRates)\"}) by (route) ",
                            "format": "time_series",
                            "legendFormat": "{{ route }} Average",
                            "refId": "C"
                         }
                      ],
                      "title": "Latency",
                      "type": "timeseries",
                      "yaxes": [
                         {
                            "format": "ms",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": 0,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": false
                         }
                      ]
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "ms"
                         },
                         "overrides": [ ]
                      },
                      "id": 12,
                      "links": [ ],
                      "nullPointMode": "null as zero",
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "histogram_quantile(0.99, sum(rate(loki_request_duration_seconds_bucket{cluster=~\"$cluster\", job=~\"($namespace)/ingester-zone.*\", route=~\"(/base.Ruler/Rules|/indexgatewaypb.IndexGateway/GetChunkRef|/indexgatewaypb.IndexGateway/GetSeries|/indexgatewaypb.IndexGateway/GetShards|/indexgatewaypb.IndexGateway/GetStats|/indexgatewaypb.IndexGateway/GetVolume|/indexgatewaypb.IndexGateway/LabelNamesForMetricName|/indexgatewaypb.IndexGateway/LabelValuesForMetricName|/indexgatewaypb.IndexGateway/QueryIndex|/logproto.BloomGateway/FilterChunkRefs|/logproto.Pattern/Query|/logproto.Querier/GetChunkIDs|/logproto.Querier/GetDetectedLabels|/logproto.Querier/GetStats|/logproto.Querier/GetVolume|/logproto.Querier/Label|/logproto.Querier/Query|/logproto.Querier/QuerySample|/logproto.Querier/Series|/logproto.StreamData/GetStreamRates)\"}[$__rate_interval])) by (le,pod)) * 1e3",
                            "format": "time_series",
                            "interval": "1m",
                            "intervalFactor": 2,
                            "legendFormat": "__auto",
                            "refId": "A",
                            "step": 10
                         }
                      ],
                      "title": "Per Pod Latency (p99)",
                      "type": "timeseries"
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "Ingester - Zone Aware",
                "titleSize": "h6"
             },
             {
                "collapse": false,
                "height": "250px",
                "panels": [
                   {
                      "aliasColors": {
                         "1xx": "#EAB839",
                         "2xx": "#7EB26D",
                         "3xx": "#6ED0E0",
                         "4xx": "#EF843C",
                         "5xx": "#E24D42",
                         "OK": "#7EB26D",
                         "cancel": "#A9A9A9",
                         "error": "#E24D42",
                         "success": "#7EB26D"
                      },
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 100,
                               "lineWidth": 0,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "normal"
                               }
                            },
                            "min": 0,
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "1xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#EAB839",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "2xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "3xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#6ED0E0",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "4xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#EF843C",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "5xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E24D42",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "OK"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "cancel"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#A9A9A9",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "error"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E24D42",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "success"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            }
                         ]
                      },
                      "fill": 10,
                      "id": 13,
                      "linewidth": 0,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "stack": true,
                      "targets": [
                         {
                            "expr": "sum by (status) (\n  label_replace(label_replace(rate(loki_request_duration_seconds_count{cluster=~\"$cluster\",job=~\"($namespace)/index-gateway\", route=~\"(/base.Ruler/Rules|/indexgatewaypb.IndexGateway/GetChunkRef|/indexgatewaypb.IndexGateway/GetSeries|/indexgatewaypb.IndexGateway/GetShards|/indexgatewaypb.IndexGateway/GetStats|/indexgatewaypb.IndexGateway/GetVolume|/indexgatewaypb.IndexGateway/LabelNamesForMetricName|/indexgatewaypb.IndexGateway/LabelValuesForMetricName|/indexgatewaypb.IndexGateway/QueryIndex|/logproto.BloomGateway/FilterChunkRefs|/logproto.Pattern/Query|/logproto.Querier/GetChunkIDs|/logproto.Querier/GetDetectedLabels|/logproto.Querier/GetStats|/logproto.Querier/GetVolume|/logproto.Querier/Label|/logproto.Querier/Query|/logproto.Querier/QuerySample|/logproto.Querier/Series|/logproto.StreamData/GetStreamRates)\"}[$__rate_interval]),\n  \"status\", \"${1}xx\", \"status_code\", \"([0-9])..\"),\n  \"status\", \"${1}\", \"status_code\", \"([a-zA-Z]+)\"))\n",
                            "format": "time_series",
                            "legendFormat": "{{status}}",
                            "refId": "A"
                         }
                      ],
                      "title": "QPS",
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "ms"
                         },
                         "overrides": [ ]
                      },
                      "id": 14,
                      "links": [ ],
                      "nullPointMode": "null as zero",
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "histogram_quantile(0.99, sum by (le,route) (cluster_job_route:loki_request_duration_seconds_bucket:sum_rate{cluster=~\"$cluster\", job=~\"($namespace)/bloom-gateway\", route=~\"(/base.Ruler/Rules|/indexgatewaypb.IndexGateway/GetChunkRef|/indexgatewaypb.IndexGateway/GetSeries|/indexgatewaypb.IndexGateway/GetShards|/indexgatewaypb.IndexGateway/GetStats|/indexgatewaypb.IndexGateway/GetVolume|/indexgatewaypb.IndexGateway/LabelNamesForMetricName|/indexgatewaypb.IndexGateway/LabelValuesForMetricName|/indexgatewaypb.IndexGateway/QueryIndex|/logproto.BloomGateway/FilterChunkRefs|/logproto.Pattern/Query|/logproto.Querier/GetChunkIDs|/logproto.Querier/GetDetectedLabels|/logproto.Querier/GetStats|/logproto.Querier/GetVolume|/logproto.Querier/Label|/logproto.Querier/Query|/logproto.Querier/QuerySample|/logproto.Querier/Series|/logproto.StreamData/GetStreamRates)\"})) * 1e3",
                            "format": "time_series",
                            "legendFormat": "{{ route }} 99th percentile",
                            "refId": "A"
                         },
                         {
                            "expr": "histogram_quantile(0.50, sum by (le,route) (cluster_job_route:loki_request_duration_seconds_bucket:sum_rate{cluster=~\"$cluster\", job=~\"($namespace)/bloom-gateway\", route=~\"(/base.Ruler/Rules|/indexgatewaypb.IndexGateway/GetChunkRef|/indexgatewaypb.IndexGateway/GetSeries|/indexgatewaypb.IndexGateway/GetShards|/indexgatewaypb.IndexGateway/GetStats|/indexgatewaypb.IndexGateway/GetVolume|/indexgatewaypb.IndexGateway/LabelNamesForMetricName|/indexgatewaypb.IndexGateway/LabelValuesForMetricName|/indexgatewaypb.IndexGateway/QueryIndex|/logproto.BloomGateway/FilterChunkRefs|/logproto.Pattern/Query|/logproto.Querier/GetChunkIDs|/logproto.Querier/GetDetectedLabels|/logproto.Querier/GetStats|/logproto.Querier/GetVolume|/logproto.Querier/Label|/logproto.Querier/Query|/logproto.Querier/QuerySample|/logproto.Querier/Series|/logproto.StreamData/GetStreamRates)\"})) * 1e3",
                            "format": "time_series",
                            "legendFormat": "{{ route }} 50th percentile",
                            "refId": "B"
                         },
                         {
                            "expr": "1e3 * sum(cluster_job_route:loki_request_duration_seconds_sum:sum_rate{cluster=~\"$cluster\", job=~\"($namespace)/bloom-gateway\", route=~\"(/base.Ruler/Rules|/indexgatewaypb.IndexGateway/GetChunkRef|/indexgatewaypb.IndexGateway/GetSeries|/indexgatewaypb.IndexGateway/GetShards|/indexgatewaypb.IndexGateway/GetStats|/indexgatewaypb.IndexGateway/GetVolume|/indexgatewaypb.IndexGateway/LabelNamesForMetricName|/indexgatewaypb.IndexGateway/LabelValuesForMetricName|/indexgatewaypb.IndexGateway/QueryIndex|/logproto.BloomGateway/FilterChunkRefs|/logproto.Pattern/Query|/logproto.Querier/GetChunkIDs|/logproto.Querier/GetDetectedLabels|/logproto.Querier/GetStats|/logproto.Querier/GetVolume|/logproto.Querier/Label|/logproto.Querier/Query|/logproto.Querier/QuerySample|/logproto.Querier/Series|/logproto.StreamData/GetStreamRates)\"}) by (route)  / sum(cluster_job_route:loki_request_duration_seconds_count:sum_rate{cluster=~\"$cluster\", job=~\"($namespace)/bloom-gateway\", route=~\"(/base.Ruler/Rules|/indexgatewaypb.IndexGateway/GetChunkRef|/indexgatewaypb.IndexGateway/GetSeries|/indexgatewaypb.IndexGateway/GetShards|/indexgatewaypb.IndexGateway/GetStats|/indexgatewaypb.IndexGateway/GetVolume|/indexgatewaypb.IndexGateway/LabelNamesForMetricName|/indexgatewaypb.IndexGateway/LabelValuesForMetricName|/indexgatewaypb.IndexGateway/QueryIndex|/logproto.BloomGateway/FilterChunkRefs|/logproto.Pattern/Query|/logproto.Querier/GetChunkIDs|/logproto.Querier/GetDetectedLabels|/logproto.Querier/GetStats|/logproto.Querier/GetVolume|/logproto.Querier/Label|/logproto.Querier/Query|/logproto.Querier/QuerySample|/logproto.Querier/Series|/logproto.StreamData/GetStreamRates)\"}) by (route) ",
                            "format": "time_series",
                            "legendFormat": "{{ route }} Average",
                            "refId": "C"
                         }
                      ],
                      "title": "Latency",
                      "type": "timeseries",
                      "yaxes": [
                         {
                            "format": "ms",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": 0,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": false
                         }
                      ]
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "ms"
                         },
                         "overrides": [ ]
                      },
                      "id": 15,
                      "links": [ ],
                      "nullPointMode": "null as zero",
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "histogram_quantile(0.99, sum(rate(loki_request_duration_seconds_bucket{cluster=~\"$cluster\", job=~\"($namespace)/index-gateway\", route=~\"(/base.Ruler/Rules|/indexgatewaypb.IndexGateway/GetChunkRef|/indexgatewaypb.IndexGateway/GetSeries|/indexgatewaypb.IndexGateway/GetShards|/indexgatewaypb.IndexGateway/GetStats|/indexgatewaypb.IndexGateway/GetVolume|/indexgatewaypb.IndexGateway/LabelNamesForMetricName|/indexgatewaypb.IndexGateway/LabelValuesForMetricName|/indexgatewaypb.IndexGateway/QueryIndex|/logproto.BloomGateway/FilterChunkRefs|/logproto.Pattern/Query|/logproto.Querier/GetChunkIDs|/logproto.Querier/GetDetectedLabels|/logproto.Querier/GetStats|/logproto.Querier/GetVolume|/logproto.Querier/Label|/logproto.Querier/Query|/logproto.Querier/QuerySample|/logproto.Querier/Series|/logproto.StreamData/GetStreamRates)\"}[$__rate_interval])) by (le,pod)) * 1e3",
                            "format": "time_series",
                            "interval": "1m",
                            "intervalFactor": 2,
                            "legendFormat": "__auto",
                            "refId": "A",
                            "step": 10
                         }
                      ],
                      "title": "Per Pod Latency (p99)",
                      "type": "timeseries"
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "Index Gateway",
                "titleSize": "h6"
             },
             {
                "collapse": false,
                "height": "250px",
                "panels": [
                   {
                      "aliasColors": {
                         "1xx": "#EAB839",
                         "2xx": "#7EB26D",
                         "3xx": "#6ED0E0",
                         "4xx": "#EF843C",
                         "5xx": "#E24D42",
                         "OK": "#7EB26D",
                         "cancel": "#A9A9A9",
                         "error": "#E24D42",
                         "success": "#7EB26D"
                      },
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 100,
                               "lineWidth": 0,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "normal"
                               }
                            },
                            "min": 0,
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "1xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#EAB839",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "2xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "3xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#6ED0E0",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "4xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#EF843C",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "5xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E24D42",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "OK"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "cancel"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#A9A9A9",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "error"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E24D42",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "success"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            }
                         ]
                      },
                      "fill": 10,
                      "id": 16,
                      "linewidth": 0,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "stack": true,
                      "targets": [
                         {
                            "expr": "sum by (status) (\n  label_replace(label_replace(rate(loki_request_duration_seconds_count{cluster=~\"$cluster\",job=~\"($namespace)/bloom-gateway\", route=~\"(/base.Ruler/Rules|/indexgatewaypb.IndexGateway/GetChunkRef|/indexgatewaypb.IndexGateway/GetSeries|/indexgatewaypb.IndexGateway/GetShards|/indexgatewaypb.IndexGateway/GetStats|/indexgatewaypb.IndexGateway/GetVolume|/indexgatewaypb.IndexGateway/LabelNamesForMetricName|/indexgatewaypb.IndexGateway/LabelValuesForMetricName|/indexgatewaypb.IndexGateway/QueryIndex|/logproto.BloomGateway/FilterChunkRefs|/logproto.Pattern/Query|/logproto.Querier/GetChunkIDs|/logproto.Querier/GetDetectedLabels|/logproto.Querier/GetStats|/logproto.Querier/GetVolume|/logproto.Querier/Label|/logproto.Querier/Query|/logproto.Querier/QuerySample|/logproto.Querier/Series|/logproto.StreamData/GetStreamRates)\"}[$__rate_interval]),\n  \"status\", \"${1}xx\", \"status_code\", \"([0-9])..\"),\n  \"status\", \"${1}\", \"status_code\", \"([a-zA-Z]+)\"))\n",
                            "format": "time_series",
                            "legendFormat": "{{status}}",
                            "refId": "A"
                         }
                      ],
                      "title": "QPS",
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "ms"
                         },
                         "overrides": [ ]
                      },
                      "id": 17,
                      "links": [ ],
                      "nullPointMode": "null as zero",
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "histogram_quantile(0.99, sum by (le,route) (cluster_job_route:loki_request_duration_seconds_bucket:sum_rate{cluster=~\"$cluster\", job=~\"($namespace)/bloom-gateway\", route=~\"(/base.Ruler/Rules|/indexgatewaypb.IndexGateway/GetChunkRef|/indexgatewaypb.IndexGateway/GetSeries|/indexgatewaypb.IndexGateway/GetShards|/indexgatewaypb.IndexGateway/GetStats|/indexgatewaypb.IndexGateway/GetVolume|/indexgatewaypb.IndexGateway/LabelNamesForMetricName|/indexgatewaypb.IndexGateway/LabelValuesForMetricName|/indexgatewaypb.IndexGateway/QueryIndex|/logproto.BloomGateway/FilterChunkRefs|/logproto.Pattern/Query|/logproto.Querier/GetChunkIDs|/logproto.Querier/GetDetectedLabels|/logproto.Querier/GetStats|/logproto.Querier/GetVolume|/logproto.Querier/Label|/logproto.Querier/Query|/logproto.Querier/QuerySample|/logproto.Querier/Series|/logproto.StreamData/GetStreamRates)\"})) * 1e3",
                            "format": "time_series",
                            "legendFormat": "{{ route }} 99th percentile",
                            "refId": "A"
                         },
                         {
                            "expr": "histogram_quantile(0.50, sum by (le,route) (cluster_job_route:loki_request_duration_seconds_bucket:sum_rate{cluster=~\"$cluster\", job=~\"($namespace)/bloom-gateway\", route=~\"(/base.Ruler/Rules|/indexgatewaypb.IndexGateway/GetChunkRef|/indexgatewaypb.IndexGateway/GetSeries|/indexgatewaypb.IndexGateway/GetShards|/indexgatewaypb.IndexGateway/GetStats|/indexgatewaypb.IndexGateway/GetVolume|/indexgatewaypb.IndexGateway/LabelNamesForMetricName|/indexgatewaypb.IndexGateway/LabelValuesForMetricName|/indexgatewaypb.IndexGateway/QueryIndex|/logproto.BloomGateway/FilterChunkRefs|/logproto.Pattern/Query|/logproto.Querier/GetChunkIDs|/logproto.Querier/GetDetectedLabels|/logproto.Querier/GetStats|/logproto.Querier/GetVolume|/logproto.Querier/Label|/logproto.Querier/Query|/logproto.Querier/QuerySample|/logproto.Querier/Series|/logproto.StreamData/GetStreamRates)\"})) * 1e3",
                            "format": "time_series",
                            "legendFormat": "{{ route }} 50th percentile",
                            "refId": "B"
                         },
                         {
                            "expr": "1e3 * sum(cluster_job_route:loki_request_duration_seconds_sum:sum_rate{cluster=~\"$cluster\", job=~\"($namespace)/bloom-gateway\", route=~\"(/base.Ruler/Rules|/indexgatewaypb.IndexGateway/GetChunkRef|/indexgatewaypb.IndexGateway/GetSeries|/indexgatewaypb.IndexGateway/GetShards|/indexgatewaypb.IndexGateway/GetStats|/indexgatewaypb.IndexGateway/GetVolume|/indexgatewaypb.IndexGateway/LabelNamesForMetricName|/indexgatewaypb.IndexGateway/LabelValuesForMetricName|/indexgatewaypb.IndexGateway/QueryIndex|/logproto.BloomGateway/FilterChunkRefs|/logproto.Pattern/Query|/logproto.Querier/GetChunkIDs|/logproto.Querier/GetDetectedLabels|/logproto.Querier/GetStats|/logproto.Querier/GetVolume|/logproto.Querier/Label|/logproto.Querier/Query|/logproto.Querier/QuerySample|/logproto.Querier/Series|/logproto.StreamData/GetStreamRates)\"}) by (route)  / sum(cluster_job_route:loki_request_duration_seconds_count:sum_rate{cluster=~\"$cluster\", job=~\"($namespace)/bloom-gateway\", route=~\"(/base.Ruler/Rules|/indexgatewaypb.IndexGateway/GetChunkRef|/indexgatewaypb.IndexGateway/GetSeries|/indexgatewaypb.IndexGateway/GetShards|/indexgatewaypb.IndexGateway/GetStats|/indexgatewaypb.IndexGateway/GetVolume|/indexgatewaypb.IndexGateway/LabelNamesForMetricName|/indexgatewaypb.IndexGateway/LabelValuesForMetricName|/indexgatewaypb.IndexGateway/QueryIndex|/logproto.BloomGateway/FilterChunkRefs|/logproto.Pattern/Query|/logproto.Querier/GetChunkIDs|/logproto.Querier/GetDetectedLabels|/logproto.Querier/GetStats|/logproto.Querier/GetVolume|/logproto.Querier/Label|/logproto.Querier/Query|/logproto.Querier/QuerySample|/logproto.Querier/Series|/logproto.StreamData/GetStreamRates)\"}) by (route) ",
                            "format": "time_series",
                            "legendFormat": "{{ route }} Average",
                            "refId": "C"
                         }
                      ],
                      "title": "Latency",
                      "type": "timeseries",
                      "yaxes": [
                         {
                            "format": "ms",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": 0,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": false
                         }
                      ]
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "ms"
                         },
                         "overrides": [ ]
                      },
                      "id": 18,
                      "links": [ ],
                      "nullPointMode": "null as zero",
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "histogram_quantile(0.99, sum(rate(loki_request_duration_seconds_bucket{cluster=~\"$cluster\", job=~\"($namespace)/bloom-gateway\", route=~\"(/base.Ruler/Rules|/indexgatewaypb.IndexGateway/GetChunkRef|/indexgatewaypb.IndexGateway/GetSeries|/indexgatewaypb.IndexGateway/GetShards|/indexgatewaypb.IndexGateway/GetStats|/indexgatewaypb.IndexGateway/GetVolume|/indexgatewaypb.IndexGateway/LabelNamesForMetricName|/indexgatewaypb.IndexGateway/LabelValuesForMetricName|/indexgatewaypb.IndexGateway/QueryIndex|/logproto.BloomGateway/FilterChunkRefs|/logproto.Pattern/Query|/logproto.Querier/GetChunkIDs|/logproto.Querier/GetDetectedLabels|/logproto.Querier/GetStats|/logproto.Querier/GetVolume|/logproto.Querier/Label|/logproto.Querier/Query|/logproto.Querier/QuerySample|/logproto.Querier/Series|/logproto.StreamData/GetStreamRates)\"}[$__rate_interval])) by (le,pod)) * 1e3",
                            "format": "time_series",
                            "interval": "1m",
                            "intervalFactor": 2,
                            "legendFormat": "__auto",
                            "refId": "A",
                            "step": 10
                         }
                      ],
                      "title": "Per Pod Latency (p99)",
                      "type": "timeseries"
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "Bloom Gateway",
                "titleSize": "h6"
             },
             {
                "collapse": false,
                "height": "250px",
                "panels": [
                   {
                      "aliasColors": {
                         "1xx": "#EAB839",
                         "2xx": "#7EB26D",
                         "3xx": "#6ED0E0",
                         "4xx": "#EF843C",
                         "5xx": "#E24D42",
                         "OK": "#7EB26D",
                         "cancel": "#A9A9A9",
                         "error": "#E24D42",
                         "success": "#7EB26D"
                      },
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 100,
                               "lineWidth": 0,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "normal"
                               }
                            },
                            "min": 0,
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "1xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#EAB839",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "2xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "3xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#6ED0E0",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "4xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#EF843C",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "5xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E24D42",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "OK"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "cancel"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#A9A9A9",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "error"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E24D42",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "success"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            }
                         ]
                      },
                      "fill": 10,
                      "id": 19,
                      "linewidth": 0,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "stack": true,
                      "targets": [
                         {
                            "expr": "sum by (status) (\n  label_replace(label_replace(rate(loki_index_request_duration_seconds_count{cluster=~\"$cluster\",job=~\"($namespace)/querier\", operation!=\"index_chunk\"}[$__rate_interval]),\n  \"status\", \"${1}xx\", \"status_code\", \"([0-9])..\"),\n  \"status\", \"${1}\", \"status_code\", \"([a-zA-Z]+)\"))\n",
                            "format": "time_series",
                            "legendFormat": "{{status}}",
                            "refId": "A"
                         }
                      ],
                      "title": "QPS",
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "ms"
                         },
                         "overrides": [ ]
                      },
                      "id": 20,
                      "links": [ ],
                      "nullPointMode": "null as zero",
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "histogram_quantile(0.99, sum(rate(loki_index_request_duration_seconds_bucket{cluster=~\"$cluster\",job=~\"($namespace)/querier\", operation!=\"index_chunk\"}[$__rate_interval])) by (le)) * 1e3",
                            "format": "time_series",
                            "legendFormat": "99th Percentile",
                            "refId": "A"
                         },
                         {
                            "expr": "histogram_quantile(0.50, sum(rate(loki_index_request_duration_seconds_bucket{cluster=~\"$cluster\",job=~\"($namespace)/querier\", operation!=\"index_chunk\"}[$__rate_interval])) by (le)) * 1e3",
                            "format": "time_series",
                            "legendFormat": "50th Percentile",
                            "refId": "B"
                         },
                         {
                            "expr": "sum(rate(loki_index_request_duration_seconds_sum{cluster=~\"$cluster\",job=~\"($namespace)/querier\", operation!=\"index_chunk\"}[$__rate_interval])) * 1e3 / sum(rate(loki_index_request_duration_seconds_count{cluster=~\"$cluster\",job=~\"($namespace)/querier\", operation!=\"index_chunk\"}[$__rate_interval]))",
                            "format": "time_series",
                            "legendFormat": "Average",
                            "refId": "C"
                         }
                      ],
                      "title": "Latency",
                      "type": "timeseries",
                      "yaxes": [
                         {
                            "format": "ms",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": 0,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": false
                         }
                      ]
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "ms"
                         },
                         "overrides": [ ]
                      },
                      "id": 21,
                      "links": [ ],
                      "nullPointMode": "null as zero",
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "histogram_quantile(0.99, sum(rate(loki_index_request_duration_seconds_bucket{cluster=~\"$cluster\",job=~\"($namespace)/querier\", operation!=\"index_chunk\"}[$__rate_interval])) by (le,pod)) * 1e3",
                            "format": "time_series",
                            "interval": "1m",
                            "intervalFactor": 2,
                            "legendFormat": "__auto",
                            "refId": "A",
                            "step": 10
                         }
                      ],
                      "title": "Per Pod Latency (p99)",
                      "type": "timeseries"
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "TSBD Index",
                "titleSize": "h6"
             },
             {
                "collapse": false,
                "height": "250px",
                "panels": [
                   {
                      "aliasColors": {
                         "1xx": "#EAB839",
                         "2xx": "#7EB26D",
                         "3xx": "#6ED0E0",
                         "4xx": "#EF843C",
                         "5xx": "#E24D42",
                         "OK": "#7EB26D",
                         "cancel": "#A9A9A9",
                         "error": "#E24D42",
                         "success": "#7EB26D"
                      },
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 100,
                               "lineWidth": 0,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "normal"
                               }
                            },
                            "min": 0,
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "1xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#EAB839",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "2xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "3xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#6ED0E0",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "4xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#EF843C",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "5xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E24D42",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "OK"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "cancel"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#A9A9A9",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "error"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E24D42",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "success"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            }
                         ]
                      },
                      "fill": 10,
                      "id": 22,
                      "linewidth": 0,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "stack": true,
                      "targets": [
                         {
                            "expr": "sum by (status) (\n  label_replace(label_replace(rate(loki_boltdb_shipper_request_duration_seconds_count{cluster=~\"$cluster\",job=~\"($namespace)/(querier|index-gateway)\", operation=\"Shipper.Query\"}[$__rate_interval]),\n  \"status\", \"${1}xx\", \"status_code\", \"([0-9])..\"),\n  \"status\", \"${1}\", \"status_code\", \"([a-zA-Z]+)\"))\n",
                            "format": "time_series",
                            "legendFormat": "{{status}}",
                            "refId": "A"
                         }
                      ],
                      "title": "QPS",
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "ms"
                         },
                         "overrides": [ ]
                      },
                      "id": 23,
                      "links": [ ],
                      "nullPointMode": "null as zero",
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "histogram_quantile(0.99, sum(rate(loki_boltdb_shipper_request_duration_seconds_bucket{cluster=~\"$cluster\",job=~\"($namespace)/(querier|index-gateway)\", operation=\"Shipper.Query\"}[$__rate_interval])) by (le)) * 1e3",
                            "format": "time_series",
                            "legendFormat": "99th Percentile",
                            "refId": "A"
                         },
                         {
                            "expr": "histogram_quantile(0.50, sum(rate(loki_boltdb_shipper_request_duration_seconds_bucket{cluster=~\"$cluster\",job=~\"($namespace)/(querier|index-gateway)\", operation=\"Shipper.Query\"}[$__rate_interval])) by (le)) * 1e3",
                            "format": "time_series",
                            "legendFormat": "50th Percentile",
                            "refId": "B"
                         },
                         {
                            "expr": "sum(rate(loki_boltdb_shipper_request_duration_seconds_sum{cluster=~\"$cluster\",job=~\"($namespace)/(querier|index-gateway)\", operation=\"Shipper.Query\"}[$__rate_interval])) * 1e3 / sum(rate(loki_boltdb_shipper_request_duration_seconds_count{cluster=~\"$cluster\",job=~\"($namespace)/(querier|index-gateway)\", operation=\"Shipper.Query\"}[$__rate_interval]))",
                            "format": "time_series",
                            "legendFormat": "Average",
                            "refId": "C"
                         }
                      ],
                      "title": "Latency",
                      "type": "timeseries",
                      "yaxes": [
                         {
                            "format": "ms",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": 0,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": false
                         }
                      ]
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "ms"
                         },
                         "overrides": [ ]
                      },
                      "id": 24,
                      "links": [ ],
                      "nullPointMode": "null as zero",
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "histogram_quantile(0.99, sum(rate(loki_boltdb_shipper_request_duration_seconds_bucket{cluster=~\"$cluster\",job=~\"($namespace)/(querier|index-gateway)\", operation=\"Shipper.Query\"}[$__rate_interval])) by (le,pod)) * 1e3",
                            "format": "time_series",
                            "interval": "1m",
                            "intervalFactor": 2,
                            "legendFormat": "__auto",
                            "refId": "A",
                            "step": 10
                         }
                      ],
                      "title": "Per Pod Latency (p99)",
                      "type": "timeseries"
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "BoltDB Index",
                "titleSize": "h6"
             }
          ],
          "schemaVersion": 14,
          "style": "dark",
          "tags": [
             "loki"
          ],
          "templating": {
             "list": [
                {
                   "current": {
                      "text": "default",
                      "value": "default"
                   },
                   "hide": 0,
                   "label": "Data source",
                   "name": "datasource",
                   "options": [ ],
                   "query": "prometheus",
                   "refresh": 1,
                   "regex": "",
                   "type": "datasource"
                },
                {
                   "allValue": null,
                   "current": {
                      "text": "prod",
                      "value": "prod"
                   },
                   "datasource": "$datasource",
                   "hide": 0,
                   "includeAll": false,
                   "label": "cluster",
                   "multi": false,
                   "name": "cluster",
                   "options": [ ],
                   "query": "label_values(loki_build_info, cluster)",
                   "refresh": 1,
                   "regex": "",
                   "sort": 2,
                   "tagValuesQuery": "",
                   "tags": [ ],
                   "tagsQuery": "",
                   "type": "query",
                   "useTags": false
                },
                {
                   "allValue": null,
                   "current": {
                      "text": "prod",
                      "value": "prod"
                   },
                   "datasource": "$datasource",
                   "hide": 0,
                   "includeAll": false,
                   "label": "namespace",
                   "multi": false,
                   "name": "namespace",
                   "options": [ ],
                   "query": "label_values(loki_build_info{cluster=~\"$cluster\"}, namespace)",
                   "refresh": 1,
                   "regex": "",
                   "sort": 2,
                   "tagValuesQuery": "",
                   "tags": [ ],
                   "tagsQuery": "",
                   "type": "query",
                   "useTags": false
                }
             ]
          },
          "time": {
             "from": "now-1h",
             "to": "now"
          },
          "timepicker": {
             "refresh_intervals": [
                "5s",
                "10s",
                "30s",
                "1m",
                "5m",
                "15m",
                "30m",
                "1h",
                "2h",
                "1d"
             ],
             "time_options": [
                "5m",
                "15m",
                "1h",
                "6h",
                "12h",
                "24h",
                "2d",
                "7d",
                "30d"
             ]
          },
          "timezone": "utc",
          "title": "Loki / Reads",
          "uid": "reads",
          "version": 0
       }
kind: ConfigMap
metadata:
  annotations:
    grafana_dashboard_folder: /dashboards/Loki Mixin
  labels:
    grafana_dashboard: "1"
  name: loki-reads.json
  namespace: monitoring-system
---
apiVersion: v1
data:
  loki-retention.json: |-
    {
          "annotations": {
             "list": [ ]
          },
          "editable": true,
          "gnetId": null,
          "graphTooltip": 0,
          "hideControls": false,
          "links": [
             {
                "asDropdown": true,
                "icon": "external link",
                "includeVars": true,
                "keepTime": true,
                "tags": [
                   "loki"
                ],
                "targetBlank": false,
                "title": "Loki Dashboards",
                "type": "dashboards"
             }
          ],
          "refresh": "10s",
          "rows": [
             {
                "collapse": false,
                "height": "250px",
                "panels": [
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "request"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#FFC000",
                                        "mode": "fixed"
                                     }
                                  },
                                  {
                                     "id": "custom.fillOpacity",
                                     "value": 0
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "limit"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E02F44",
                                        "mode": "fixed"
                                     }
                                  },
                                  {
                                     "id": "custom.fillOpacity",
                                     "value": 0
                                  }
                               ]
                            }
                         ]
                      },
                      "id": 1,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "sum by(pod) (rate(container_cpu_usage_seconds_total{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"compactor\"}[$__rate_interval]))",
                            "format": "time_series",
                            "legendFormat": "{{pod}}",
                            "legendLink": null
                         },
                         {
                            "expr": "min(kube_pod_container_resource_requests{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"compactor\", resource=\"cpu\"} > 0)",
                            "format": "time_series",
                            "legendFormat": "request",
                            "legendLink": null
                         },
                         {
                            "expr": "min(container_spec_cpu_quota{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"compactor\"} / container_spec_cpu_period{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"compactor\"})",
                            "format": "time_series",
                            "legendFormat": "limit",
                            "legendLink": null
                         }
                      ],
                      "title": "CPU",
                      "tooltip": {
                         "sort": 2
                      },
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "bytes"
                         },
                         "overrides": [
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "request"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#FFC000",
                                        "mode": "fixed"
                                     }
                                  },
                                  {
                                     "id": "custom.fillOpacity",
                                     "value": 0
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "limit"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E02F44",
                                        "mode": "fixed"
                                     }
                                  },
                                  {
                                     "id": "custom.fillOpacity",
                                     "value": 0
                                  }
                               ]
                            }
                         ]
                      },
                      "id": 2,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "max by(pod) (container_memory_working_set_bytes{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"compactor\"})",
                            "format": "time_series",
                            "legendFormat": "{{pod}}",
                            "legendLink": null
                         },
                         {
                            "expr": "min(kube_pod_container_resource_requests{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"compactor\", resource=\"memory\"} > 0)",
                            "format": "time_series",
                            "legendFormat": "request",
                            "legendLink": null
                         },
                         {
                            "expr": "min(container_spec_memory_limit_bytes{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"compactor\"} > 0)",
                            "format": "time_series",
                            "legendFormat": "limit",
                            "legendLink": null
                         }
                      ],
                      "title": "Memory (workingset)",
                      "tooltip": {
                         "sort": 2
                      },
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "bytes"
                         },
                         "overrides": [ ]
                      },
                      "id": 3,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "sum by(pod) (go_memstats_heap_inuse_bytes{cluster=~\"$cluster\", job=~\"($namespace)/compactor\"})",
                            "format": "time_series",
                            "legendFormat": "{{pod}}",
                            "legendLink": null
                         }
                      ],
                      "title": "Memory (go heap inuse)",
                      "tooltip": {
                         "sort": 2
                      },
                      "type": "timeseries"
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "Resource Usage",
                "titleSize": "h6"
             },
             {
                "collapse": false,
                "height": "250px",
                "panels": [
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "color": {
                               "fixedColor": "blue",
                               "mode": "fixed"
                            },
                            "custom": { },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [
                                  {
                                     "color": "green",
                                     "value": null
                                  }
                               ]
                            },
                            "unit": "dateTimeFromNow"
                         }
                      },
                      "fill": 1,
                      "id": 4,
                      "legend": {
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "show": true,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "links": [ ],
                      "nullPointMode": "null as zero",
                      "options": {
                         "colorMode": "value",
                         "graphMode": "area",
                         "justifyMode": "auto",
                         "orientation": "auto",
                         "reduceOptions": {
                            "calcs": [
                               "lastNotNull"
                            ],
                            "fields": "",
                            "values": false
                         },
                         "text": { },
                         "textMode": "auto"
                      },
                      "percentage": false,
                      "pointradius": 5,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "span": 6,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "loki_boltdb_shipper_compact_tables_operation_last_successful_run_timestamp_seconds{cluster=~\"$cluster\", namespace=~\"$namespace\"} * 1e3",
                            "format": "time_series",
                            "instant": true,
                            "refId": "A"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeShift": null,
                      "title": "Last Compact Tables Operation Success",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "stat",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": 0,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": false
                         }
                      ]
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "s"
                         },
                         "overrides": [ ]
                      },
                      "id": 5,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 6,
                      "targets": [
                         {
                            "expr": "loki_boltdb_shipper_compact_tables_operation_duration_seconds{cluster=~\"$cluster\", namespace=~\"$namespace\"}",
                            "format": "time_series",
                            "legendFormat": "duration",
                            "legendLink": null
                         }
                      ],
                      "title": "Compact Tables Operations Duration",
                      "type": "timeseries"
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "Compaction",
                "titleSize": "h6"
             },
             {
                "collapse": false,
                "height": "250px",
                "panels": [
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [ ]
                      },
                      "id": 6,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 6,
                      "targets": [
                         {
                            "expr": "sum(increase(loki_compactor_skipped_compacting_locked_table_total{cluster=~\"$cluster\", namespace=~\"$namespace\"}[$__range]))",
                            "format": "time_series",
                            "legendFormat": "{{table_name}}",
                            "legendLink": null
                         }
                      ],
                      "title": "Number of times Tables were skipped during Compaction",
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [ ]
                      },
                      "id": 7,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 6,
                      "targets": [
                         {
                            "expr": "sum by (status)(rate(loki_boltdb_shipper_compact_tables_operation_total{cluster=~\"$cluster\", namespace=~\"$namespace\"}[$__rate_interval]))",
                            "format": "time_series",
                            "legendFormat": "{{success}}",
                            "legendLink": null
                         }
                      ],
                      "title": "Compact Tables Operations Per Status",
                      "type": "timeseries"
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "",
                "titleSize": "h6"
             },
             {
                "collapse": false,
                "height": "250px",
                "panels": [
                   {
                      "aliasColors": { },
                      "bars": false,
                      "dashLength": 10,
                      "dashes": false,
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "color": {
                               "fixedColor": "blue",
                               "mode": "fixed"
                            },
                            "custom": { },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [
                                  {
                                     "color": "green",
                                     "value": null
                                  }
                               ]
                            },
                            "unit": "dateTimeFromNow"
                         }
                      },
                      "fill": 1,
                      "id": 8,
                      "legend": {
                         "avg": false,
                         "current": false,
                         "max": false,
                         "min": false,
                         "show": true,
                         "total": false,
                         "values": false
                      },
                      "lines": true,
                      "linewidth": 1,
                      "links": [ ],
                      "nullPointMode": "null as zero",
                      "options": {
                         "colorMode": "value",
                         "graphMode": "area",
                         "justifyMode": "auto",
                         "orientation": "auto",
                         "reduceOptions": {
                            "calcs": [
                               "lastNotNull"
                            ],
                            "fields": "",
                            "values": false
                         },
                         "text": { },
                         "textMode": "auto"
                      },
                      "percentage": false,
                      "pointradius": 5,
                      "points": false,
                      "renderer": "flot",
                      "seriesOverrides": [ ],
                      "spaceLength": 10,
                      "span": 4,
                      "stack": false,
                      "steppedLine": false,
                      "targets": [
                         {
                            "expr": "loki_compactor_apply_retention_last_successful_run_timestamp_seconds{cluster=~\"$cluster\", namespace=~\"$namespace\"} * 1e3",
                            "format": "time_series",
                            "instant": true,
                            "refId": "A"
                         }
                      ],
                      "thresholds": [ ],
                      "timeFrom": null,
                      "timeShift": null,
                      "title": "Last Mark Operation Success",
                      "tooltip": {
                         "shared": true,
                         "sort": 2,
                         "value_type": "individual"
                      },
                      "type": "stat",
                      "xaxis": {
                         "buckets": null,
                         "mode": "time",
                         "name": null,
                         "show": true,
                         "values": [ ]
                      },
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": 0,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": false
                         }
                      ]
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "s"
                         },
                         "overrides": [ ]
                      },
                      "id": 9,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "loki_compactor_apply_retention_operation_duration_seconds{cluster=~\"$cluster\", namespace=~\"$namespace\"}",
                            "format": "time_series",
                            "legendFormat": "duration",
                            "legendLink": null
                         }
                      ],
                      "title": "Mark Operations Duration",
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [ ]
                      },
                      "id": 10,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "sum by (status)(rate(loki_compactor_apply_retention_operation_total{cluster=~\"$cluster\", namespace=~\"$namespace\"}[$__rate_interval]))",
                            "format": "time_series",
                            "legendFormat": "{{success}}",
                            "legendLink": null
                         }
                      ],
                      "title": "Mark Operations Per Status",
                      "type": "timeseries"
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "Retention",
                "titleSize": "h6"
             },
             {
                "collapse": false,
                "height": "250px",
                "panels": [
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 100,
                               "lineWidth": 0,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "normal"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [ ]
                      },
                      "id": 11,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "count by(action)(loki_boltdb_shipper_retention_marker_table_processed_total{cluster=~\"$cluster\", namespace=~\"$namespace\"})",
                            "format": "time_series",
                            "legendFormat": "{{action}}",
                            "legendLink": null
                         }
                      ],
                      "title": "Processed Tables Per Action",
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 100,
                               "lineWidth": 0,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "normal"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [ ]
                      },
                      "id": 12,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "count by(table,action)(loki_boltdb_shipper_retention_marker_table_processed_total{cluster=~\"$cluster\", namespace=~\"$namespace\" , action=~\"modified|deleted\"})",
                            "format": "time_series",
                            "legendFormat": "{{table}}-{{action}}",
                            "legendLink": null
                         }
                      ],
                      "title": "Modified Tables",
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 100,
                               "lineWidth": 0,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "normal"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [ ]
                      },
                      "id": 13,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "sum by (table)(rate(loki_boltdb_shipper_retention_marker_count_total{cluster=~\"$cluster\", namespace=~\"$namespace\"}[$__rate_interval])) >0",
                            "format": "time_series",
                            "legendFormat": "{{table}}",
                            "legendLink": null
                         }
                      ],
                      "title": "Marks Creation Rate Per Table",
                      "type": "timeseries"
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "Per Table Marker",
                "titleSize": "h6"
             },
             {
                "collapse": false,
                "height": "250px",
                "panels": [
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [ ]
                      },
                      "format": "short",
                      "id": 14,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 6,
                      "targets": [
                         {
                            "expr": "sum (increase(loki_boltdb_shipper_retention_marker_count_total{cluster=~\"$cluster\", namespace=~\"$namespace\"}[24h]))",
                            "format": "time_series",
                            "instant": true,
                            "refId": "A"
                         }
                      ],
                      "thresholds": "70,80",
                      "title": "Marked Chunks (24h)",
                      "type": "singlestat"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [ ]
                      },
                      "id": 15,
                      "links": [ ],
                      "nullPointMode": "null as zero",
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 6,
                      "targets": [
                         {
                            "expr": "histogram_quantile(0.99, sum(rate(loki_boltdb_shipper_retention_marker_table_processed_duration_seconds_bucket{cluster=~\"$cluster\", namespace=~\"$namespace\"}[$__rate_interval])) by (le)) * 1e3",
                            "format": "time_series",
                            "legendFormat": "99th Percentile",
                            "refId": "A"
                         },
                         {
                            "expr": "histogram_quantile(0.50, sum(rate(loki_boltdb_shipper_retention_marker_table_processed_duration_seconds_bucket{cluster=~\"$cluster\", namespace=~\"$namespace\"}[$__rate_interval])) by (le)) * 1e3",
                            "format": "time_series",
                            "legendFormat": "50th Percentile",
                            "refId": "B"
                         },
                         {
                            "expr": "sum(rate(loki_boltdb_shipper_retention_marker_table_processed_duration_seconds_sum{cluster=~\"$cluster\", namespace=~\"$namespace\"}[$__rate_interval])) * 1e3 / sum(rate(loki_boltdb_shipper_retention_marker_table_processed_duration_seconds_count{cluster=~\"$cluster\", namespace=~\"$namespace\"}[$__rate_interval]))",
                            "format": "time_series",
                            "legendFormat": "Average",
                            "refId": "C"
                         }
                      ],
                      "title": "Mark Table Latency",
                      "type": "timeseries",
                      "yaxes": [
                         {
                            "format": "ms",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": 0,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": false
                         }
                      ]
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "",
                "titleSize": "h6"
             },
             {
                "collapse": false,
                "height": "250px",
                "panels": [
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [ ]
                      },
                      "format": "short",
                      "id": 16,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 6,
                      "targets": [
                         {
                            "expr": "sum (increase(loki_boltdb_shipper_retention_sweeper_chunk_deleted_duration_seconds_count{cluster=~\"$cluster\", namespace=~\"$namespace\"}[24h]))",
                            "format": "time_series",
                            "instant": true,
                            "refId": "A"
                         }
                      ],
                      "thresholds": "70,80",
                      "title": "Delete Chunks (24h)",
                      "type": "singlestat"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [ ]
                      },
                      "id": 17,
                      "links": [ ],
                      "nullPointMode": "null as zero",
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 6,
                      "targets": [
                         {
                            "expr": "histogram_quantile(0.99, sum(rate(loki_boltdb_shipper_retention_sweeper_chunk_deleted_duration_seconds_bucket{cluster=~\"$cluster\", namespace=~\"$namespace\"}[$__rate_interval])) by (le)) * 1e3",
                            "format": "time_series",
                            "legendFormat": "99th Percentile",
                            "refId": "A"
                         },
                         {
                            "expr": "histogram_quantile(0.50, sum(rate(loki_boltdb_shipper_retention_sweeper_chunk_deleted_duration_seconds_bucket{cluster=~\"$cluster\", namespace=~\"$namespace\"}[$__rate_interval])) by (le)) * 1e3",
                            "format": "time_series",
                            "legendFormat": "50th Percentile",
                            "refId": "B"
                         },
                         {
                            "expr": "sum(rate(loki_boltdb_shipper_retention_sweeper_chunk_deleted_duration_seconds_sum{cluster=~\"$cluster\", namespace=~\"$namespace\"}[$__rate_interval])) * 1e3 / sum(rate(loki_boltdb_shipper_retention_sweeper_chunk_deleted_duration_seconds_count{cluster=~\"$cluster\", namespace=~\"$namespace\"}[$__rate_interval]))",
                            "format": "time_series",
                            "legendFormat": "Average",
                            "refId": "C"
                         }
                      ],
                      "title": "Delete Latency",
                      "type": "timeseries",
                      "yaxes": [
                         {
                            "format": "ms",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": 0,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": false
                         }
                      ]
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "Sweeper",
                "titleSize": "h6"
             },
             {
                "collapse": false,
                "height": "250px",
                "panels": [
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "s"
                         },
                         "overrides": [ ]
                      },
                      "id": 18,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "time() - (loki_boltdb_shipper_retention_sweeper_marker_file_processing_current_time{cluster=~\"$cluster\", namespace=~\"$namespace\"} > 0)",
                            "format": "time_series",
                            "legendFormat": "lag",
                            "legendLink": null
                         }
                      ],
                      "title": "Sweeper Lag",
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [ ]
                      },
                      "id": 19,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "sum(loki_boltdb_shipper_retention_sweeper_marker_files_current{cluster=~\"$cluster\", namespace=~\"$namespace\"})",
                            "format": "time_series",
                            "legendFormat": "count",
                            "legendLink": null
                         }
                      ],
                      "title": "Marks Files to Process",
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [ ]
                      },
                      "id": 20,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "sum by (status)(rate(loki_boltdb_shipper_retention_sweeper_chunk_deleted_duration_seconds_count{cluster=~\"$cluster\", namespace=~\"$namespace\"}[$__rate_interval]))",
                            "format": "time_series",
                            "legendFormat": "{{status}}",
                            "legendLink": null
                         }
                      ],
                      "title": "Delete Rate Per Status",
                      "type": "timeseries"
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "",
                "titleSize": "h6"
             },
             {
                "collapse": false,
                "height": "250px",
                "panels": [
                   {
                      "datasource": "$loki_datasource",
                      "id": 21,
                      "span": 12,
                      "targets": [
                         {
                            "expr": "{cluster=~\"$cluster\", job=~\"($namespace)/compactor\"}",
                            "refId": "A"
                         }
                      ],
                      "title": "Compactor Logs",
                      "type": "logs"
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "Logs",
                "titleSize": "h6"
             }
          ],
          "schemaVersion": 14,
          "style": "dark",
          "tags": [
             "loki"
          ],
          "templating": {
             "list": [
                {
                   "current": {
                      "text": "default",
                      "value": "default"
                   },
                   "hide": 0,
                   "label": "Data source",
                   "name": "datasource",
                   "options": [ ],
                   "query": "prometheus",
                   "refresh": 1,
                   "regex": "",
                   "type": "datasource"
                },
                {
                   "allValue": null,
                   "current": {
                      "text": "prod",
                      "value": "prod"
                   },
                   "datasource": "$datasource",
                   "hide": 0,
                   "includeAll": false,
                   "label": "cluster",
                   "multi": false,
                   "name": "cluster",
                   "options": [ ],
                   "query": "label_values(loki_build_info, cluster)",
                   "refresh": 1,
                   "regex": "",
                   "sort": 2,
                   "tagValuesQuery": "",
                   "tags": [ ],
                   "tagsQuery": "",
                   "type": "query",
                   "useTags": false
                },
                {
                   "allValue": null,
                   "current": {
                      "text": "prod",
                      "value": "prod"
                   },
                   "datasource": "$datasource",
                   "hide": 0,
                   "includeAll": false,
                   "label": "namespace",
                   "multi": false,
                   "name": "namespace",
                   "options": [ ],
                   "query": "label_values(loki_build_info{cluster=~\"$cluster\"}, namespace)",
                   "refresh": 1,
                   "regex": "",
                   "sort": 2,
                   "tagValuesQuery": "",
                   "tags": [ ],
                   "tagsQuery": "",
                   "type": "query",
                   "useTags": false
                },
                {
                   "hide": 0,
                   "label": null,
                   "name": "loki_datasource",
                   "options": [ ],
                   "query": "loki",
                   "refresh": 1,
                   "regex": "",
                   "type": "datasource"
                }
             ]
          },
          "time": {
             "from": "now-1h",
             "to": "now"
          },
          "timepicker": {
             "refresh_intervals": [
                "5s",
                "10s",
                "30s",
                "1m",
                "5m",
                "15m",
                "30m",
                "1h",
                "2h",
                "1d"
             ],
             "time_options": [
                "5m",
                "15m",
                "1h",
                "6h",
                "12h",
                "24h",
                "2d",
                "7d",
                "30d"
             ]
          },
          "timezone": "utc",
          "title": "Loki / Retention",
          "uid": "retention",
          "version": 0
       }
kind: ConfigMap
metadata:
  annotations:
    grafana_dashboard_folder: /dashboards/Loki Mixin
  labels:
    grafana_dashboard: "1"
  name: loki-retention.json
  namespace: monitoring-system
---
apiVersion: v1
data:
  loki-writes-resources.json: |-
    {
          "annotations": {
             "list": [ ]
          },
          "editable": true,
          "gnetId": null,
          "graphTooltip": 0,
          "hideControls": false,
          "links": [
             {
                "asDropdown": true,
                "icon": "external link",
                "includeVars": true,
                "keepTime": true,
                "tags": [
                   "loki"
                ],
                "targetBlank": false,
                "title": "Loki Dashboards",
                "type": "dashboards"
             }
          ],
          "refresh": "10s",
          "rows": [
             {
                "collapse": false,
                "height": "250px",
                "panels": [
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "request"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#FFC000",
                                        "mode": "fixed"
                                     }
                                  },
                                  {
                                     "id": "custom.fillOpacity",
                                     "value": 0
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "limit"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E02F44",
                                        "mode": "fixed"
                                     }
                                  },
                                  {
                                     "id": "custom.fillOpacity",
                                     "value": 0
                                  }
                               ]
                            }
                         ]
                      },
                      "id": 1,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "sum by(pod) (rate(container_cpu_usage_seconds_total{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"distributor\"}[$__rate_interval]))",
                            "format": "time_series",
                            "legendFormat": "{{pod}}",
                            "legendLink": null
                         },
                         {
                            "expr": "min(kube_pod_container_resource_requests{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"distributor\", resource=\"cpu\"} > 0)",
                            "format": "time_series",
                            "legendFormat": "request",
                            "legendLink": null
                         },
                         {
                            "expr": "min(container_spec_cpu_quota{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"distributor\"} / container_spec_cpu_period{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"distributor\"})",
                            "format": "time_series",
                            "legendFormat": "limit",
                            "legendLink": null
                         }
                      ],
                      "title": "CPU",
                      "tooltip": {
                         "sort": 2
                      },
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "bytes"
                         },
                         "overrides": [
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "request"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#FFC000",
                                        "mode": "fixed"
                                     }
                                  },
                                  {
                                     "id": "custom.fillOpacity",
                                     "value": 0
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "limit"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E02F44",
                                        "mode": "fixed"
                                     }
                                  },
                                  {
                                     "id": "custom.fillOpacity",
                                     "value": 0
                                  }
                               ]
                            }
                         ]
                      },
                      "id": 2,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "max by(pod) (container_memory_working_set_bytes{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"distributor\"})",
                            "format": "time_series",
                            "legendFormat": "{{pod}}",
                            "legendLink": null
                         },
                         {
                            "expr": "min(kube_pod_container_resource_requests{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"distributor\", resource=\"memory\"} > 0)",
                            "format": "time_series",
                            "legendFormat": "request",
                            "legendLink": null
                         },
                         {
                            "expr": "min(container_spec_memory_limit_bytes{cluster=~\"$cluster\", namespace=~\"$namespace\", container=~\"distributor\"} > 0)",
                            "format": "time_series",
                            "legendFormat": "limit",
                            "legendLink": null
                         }
                      ],
                      "title": "Memory (workingset)",
                      "tooltip": {
                         "sort": 2
                      },
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "bytes"
                         },
                         "overrides": [ ]
                      },
                      "id": 3,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 4,
                      "targets": [
                         {
                            "expr": "sum by(pod) (go_memstats_heap_inuse_bytes{cluster=~\"$cluster\", job=~\"($namespace)/distributor\"})",
                            "format": "time_series",
                            "legendFormat": "{{pod}}",
                            "legendLink": null
                         }
                      ],
                      "title": "Memory (go heap inuse)",
                      "tooltip": {
                         "sort": 2
                      },
                      "type": "timeseries"
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "Distributor",
                "titleSize": "h6"
             },
             {
                "collapse": false,
                "collapsed": false,
                "panels": [
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [ ]
                      },
                      "gridPos": { },
                      "id": 4,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "targets": [
                         {
                            "expr": "sum by(pod) (loki_ingester_memory_streams{cluster=~\"$cluster\", job=~\"($namespace)/ingester.*\"})",
                            "format": "time_series",
                            "legendFormat": "{{pod}}",
                            "legendLink": null
                         }
                      ],
                      "title": "In-memory streams",
                      "tooltip": {
                         "sort": 2
                      },
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "request"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#FFC000",
                                        "mode": "fixed"
                                     }
                                  },
                                  {
                                     "id": "custom.fillOpacity",
                                     "value": 0
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "limit"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E02F44",
                                        "mode": "fixed"
                                     }
                                  },
                                  {
                                     "id": "custom.fillOpacity",
                                     "value": 0
                                  }
                               ]
                            }
                         ]
                      },
                      "gridPos": { },
                      "id": 5,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "targets": [
                         {
                            "expr": "sum by(pod) (rate(container_cpu_usage_seconds_total{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"ingester\"}[$__rate_interval]))",
                            "format": "time_series",
                            "legendFormat": "{{pod}}",
                            "legendLink": null
                         },
                         {
                            "expr": "min(kube_pod_container_resource_requests{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"ingester\", resource=\"cpu\"} > 0)",
                            "format": "time_series",
                            "legendFormat": "request",
                            "legendLink": null
                         },
                         {
                            "expr": "min(container_spec_cpu_quota{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"ingester\"} / container_spec_cpu_period{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"ingester\"})",
                            "format": "time_series",
                            "legendFormat": "limit",
                            "legendLink": null
                         }
                      ],
                      "title": "CPU",
                      "tooltip": {
                         "sort": 2
                      },
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "bytes"
                         },
                         "overrides": [
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "request"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#FFC000",
                                        "mode": "fixed"
                                     }
                                  },
                                  {
                                     "id": "custom.fillOpacity",
                                     "value": 0
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "limit"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E02F44",
                                        "mode": "fixed"
                                     }
                                  },
                                  {
                                     "id": "custom.fillOpacity",
                                     "value": 0
                                  }
                               ]
                            }
                         ]
                      },
                      "gridPos": { },
                      "id": 6,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "targets": [
                         {
                            "expr": "max by(pod) (container_memory_working_set_bytes{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"ingester\"})",
                            "format": "time_series",
                            "legendFormat": "{{pod}}",
                            "legendLink": null
                         },
                         {
                            "expr": "min(kube_pod_container_resource_requests{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"ingester\", resource=\"memory\"} > 0)",
                            "format": "time_series",
                            "legendFormat": "request",
                            "legendLink": null
                         },
                         {
                            "expr": "min(container_spec_memory_limit_bytes{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"ingester\"} > 0)",
                            "format": "time_series",
                            "legendFormat": "limit",
                            "legendLink": null
                         }
                      ],
                      "title": "Memory (workingset)",
                      "tooltip": {
                         "sort": 2
                      },
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "bytes"
                         },
                         "overrides": [ ]
                      },
                      "gridPos": { },
                      "id": 7,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "targets": [
                         {
                            "expr": "sum by(pod) (go_memstats_heap_inuse_bytes{cluster=~\"$cluster\", job=~\"($namespace)/ingester.*\"})",
                            "format": "time_series",
                            "legendFormat": "{{pod}}",
                            "legendLink": null
                         }
                      ],
                      "title": "Memory (go heap inuse)",
                      "tooltip": {
                         "sort": 2
                      },
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 100,
                               "lineWidth": 0,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "normal"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "Bps"
                         },
                         "overrides": [ ]
                      },
                      "gridPos": { },
                      "id": 8,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "targets": [
                         {
                            "expr": "sum by(instance, pod, device) (rate(node_disk_written_bytes_total[$__rate_interval])) + ignoring(pod) group_right() (label_replace(count by(instance, pod, device) (container_fs_writes_bytes_total{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"ingester\", device!~\".*sda.*\"}), \"device\", \"$1\", \"device\", \"/dev/(.*)\") * 0)\n",
                            "format": "time_series",
                            "legendFormat": "{{pod}} - {{device}}",
                            "legendLink": null
                         }
                      ],
                      "title": "Disk Writes",
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 100,
                               "lineWidth": 0,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "normal"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "Bps"
                         },
                         "overrides": [ ]
                      },
                      "gridPos": { },
                      "id": 9,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "targets": [
                         {
                            "expr": "sum by(instance, pod, device) (rate(node_disk_read_bytes_total[$__rate_interval])) + ignoring(pod) group_right() (label_replace(count by(instance, pod, device) (container_fs_writes_bytes_total{cluster=~\"$cluster\", namespace=~\"$namespace\", container=\"ingester\", device!~\".*sda.*\"}), \"device\", \"$1\", \"device\", \"/dev/(.*)\") * 0)\n",
                            "format": "time_series",
                            "legendFormat": "{{pod}} - {{device}}",
                            "legendLink": null
                         }
                      ],
                      "title": "Disk Reads",
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "percentunit"
                         },
                         "overrides": [ ]
                      },
                      "gridPos": { },
                      "id": 10,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "targets": [
                         {
                            "expr": "max by(persistentvolumeclaim) (kubelet_volume_stats_used_bytes{cluster=~\"$cluster\", namespace=~\"$namespace\"} / kubelet_volume_stats_capacity_bytes{cluster=~\"$cluster\", namespace=~\"$namespace\"}) and count by(persistentvolumeclaim) (kube_persistentvolumeclaim_labels{cluster=~\"$cluster\", namespace=~\"$namespace\",label_name=~\"ingester.*.*\"})",
                            "format": "time_series",
                            "legendFormat": "{{persistentvolumeclaim}}",
                            "legendLink": null
                         }
                      ],
                      "title": "Disk Space Utilization",
                      "type": "timeseries"
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "Ingester",
                "titleSize": "h6",
                "type": "row"
             }
          ],
          "schemaVersion": 14,
          "style": "dark",
          "tags": [
             "loki"
          ],
          "templating": {
             "list": [
                {
                   "current": {
                      "text": "default",
                      "value": "default"
                   },
                   "hide": 0,
                   "label": "Data source",
                   "name": "datasource",
                   "options": [ ],
                   "query": "prometheus",
                   "refresh": 1,
                   "regex": "",
                   "type": "datasource"
                },
                {
                   "allValue": null,
                   "current": {
                      "text": "prod",
                      "value": "prod"
                   },
                   "datasource": "$datasource",
                   "hide": 0,
                   "includeAll": false,
                   "label": "cluster",
                   "multi": false,
                   "name": "cluster",
                   "options": [ ],
                   "query": "label_values(loki_build_info, cluster)",
                   "refresh": 1,
                   "regex": "",
                   "sort": 2,
                   "tagValuesQuery": "",
                   "tags": [ ],
                   "tagsQuery": "",
                   "type": "query",
                   "useTags": false
                },
                {
                   "allValue": null,
                   "current": {
                      "text": "prod",
                      "value": "prod"
                   },
                   "datasource": "$datasource",
                   "hide": 0,
                   "includeAll": false,
                   "label": "namespace",
                   "multi": false,
                   "name": "namespace",
                   "options": [ ],
                   "query": "label_values(loki_build_info{cluster=~\"$cluster\"}, namespace)",
                   "refresh": 1,
                   "regex": "",
                   "sort": 2,
                   "tagValuesQuery": "",
                   "tags": [ ],
                   "tagsQuery": "",
                   "type": "query",
                   "useTags": false
                }
             ]
          },
          "time": {
             "from": "now-1h",
             "to": "now"
          },
          "timepicker": {
             "refresh_intervals": [
                "5s",
                "10s",
                "30s",
                "1m",
                "5m",
                "15m",
                "30m",
                "1h",
                "2h",
                "1d"
             ],
             "time_options": [
                "5m",
                "15m",
                "1h",
                "6h",
                "12h",
                "24h",
                "2d",
                "7d",
                "30d"
             ]
          },
          "timezone": "utc",
          "title": "Loki / Writes Resources",
          "uid": "writes-resources",
          "version": 0
       }
kind: ConfigMap
metadata:
  annotations:
    grafana_dashboard_folder: /dashboards/Loki Mixin
  labels:
    grafana_dashboard: "1"
  name: loki-writes-resources.json
  namespace: monitoring-system
---
apiVersion: v1
data:
  loki-writes.json: |-
    {
          "annotations": {
             "list": [ ]
          },
          "editable": true,
          "gnetId": null,
          "graphTooltip": 0,
          "hideControls": false,
          "links": [
             {
                "asDropdown": true,
                "icon": "external link",
                "includeVars": true,
                "keepTime": true,
                "tags": [
                   "loki"
                ],
                "targetBlank": false,
                "title": "Loki Dashboards",
                "type": "dashboards"
             }
          ],
          "refresh": "10s",
          "rows": [
             {
                "collapse": false,
                "height": "250px",
                "panels": [
                   {
                      "aliasColors": {
                         "1xx": "#EAB839",
                         "2xx": "#7EB26D",
                         "3xx": "#6ED0E0",
                         "4xx": "#EF843C",
                         "5xx": "#E24D42",
                         "OK": "#7EB26D",
                         "cancel": "#A9A9A9",
                         "error": "#E24D42",
                         "success": "#7EB26D"
                      },
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 100,
                               "lineWidth": 0,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "normal"
                               }
                            },
                            "min": 0,
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "1xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#EAB839",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "2xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "3xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#6ED0E0",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "4xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#EF843C",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "5xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E24D42",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "OK"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "cancel"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#A9A9A9",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "error"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E24D42",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "success"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            }
                         ]
                      },
                      "fill": 10,
                      "id": 1,
                      "linewidth": 0,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 6,
                      "stack": true,
                      "targets": [
                         {
                            "expr": "sum by (status) (\n  label_replace(label_replace(rate(loki_request_duration_seconds_count{cluster=~\"$cluster\",job=~\"($namespace)/distributor\", route=~\"api_prom_push|loki_api_v1_push|/httpgrpc.HTTP/Handle\"}[$__rate_interval]),\n  \"status\", \"${1}xx\", \"status_code\", \"([0-9])..\"),\n  \"status\", \"${1}\", \"status_code\", \"([a-zA-Z]+)\"))\n",
                            "format": "time_series",
                            "legendFormat": "{{status}}",
                            "refId": "A"
                         }
                      ],
                      "title": "QPS",
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "ms"
                         },
                         "overrides": [ ]
                      },
                      "id": 2,
                      "links": [ ],
                      "nullPointMode": "null as zero",
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 6,
                      "targets": [
                         {
                            "expr": "histogram_quantile(0.99, sum by (le) (cluster_job_route:loki_request_duration_seconds_bucket:sum_rate{cluster=~\"$cluster\", job=~\"($namespace)/distributor\", route=~\"api_prom_push|loki_api_v1_push|/httpgrpc.HTTP/Handle\"})) * 1e3",
                            "format": "time_series",
                            "legendFormat": "99th percentile",
                            "refId": "A"
                         },
                         {
                            "expr": "histogram_quantile(0.50, sum by (le) (cluster_job_route:loki_request_duration_seconds_bucket:sum_rate{cluster=~\"$cluster\", job=~\"($namespace)/distributor\", route=~\"api_prom_push|loki_api_v1_push|/httpgrpc.HTTP/Handle\"})) * 1e3",
                            "format": "time_series",
                            "legendFormat": "50th percentile",
                            "refId": "B"
                         },
                         {
                            "expr": "1e3 * sum(cluster_job_route:loki_request_duration_seconds_sum:sum_rate{cluster=~\"$cluster\", job=~\"($namespace)/distributor\", route=~\"api_prom_push|loki_api_v1_push|/httpgrpc.HTTP/Handle\"}) / sum(cluster_job_route:loki_request_duration_seconds_count:sum_rate{cluster=~\"$cluster\", job=~\"($namespace)/distributor\", route=~\"api_prom_push|loki_api_v1_push|/httpgrpc.HTTP/Handle\"})",
                            "format": "time_series",
                            "legendFormat": "Average",
                            "refId": "C"
                         }
                      ],
                      "title": "Latency",
                      "type": "timeseries",
                      "yaxes": [
                         {
                            "format": "ms",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": 0,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": false
                         }
                      ]
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "Distributor",
                "titleSize": "h6"
             },
             {
                "collapse": false,
                "height": "250px",
                "panels": [
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [ ]
                      },
                      "id": 3,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 6,
                      "targets": [
                         {
                            "expr": "sum (rate(loki_distributor_structured_metadata_bytes_received_total{cluster=~\"$cluster\",job=~\"($namespace)/distributor\",}[$__rate_interval])) / sum(rate(loki_distributor_bytes_received_total{cluster=~\"$cluster\",job=~\"($namespace)/distributor\",}[$__rate_interval]))",
                            "format": "time_series",
                            "legendFormat": "bytes",
                            "legendLink": null
                         }
                      ],
                      "title": "Per Total Received Bytes",
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [ ]
                      },
                      "id": 4,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 6,
                      "stack": true,
                      "targets": [
                         {
                            "expr": "sum by (tenant) (rate(loki_distributor_structured_metadata_bytes_received_total{cluster=~\"$cluster\",job=~\"($namespace)/distributor\",}[$__rate_interval])) / ignoring(tenant) group_left sum(rate(loki_distributor_structured_metadata_bytes_received_total{cluster=~\"$cluster\",job=~\"($namespace)/distributor\",}[$__rate_interval]))",
                            "format": "time_series",
                            "legendFormat": "{{tenant}}",
                            "legendLink": null
                         }
                      ],
                      "title": "Per Tenant",
                      "type": "timeseries",
                      "yaxes": [
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": 1,
                            "min": 0,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": 1,
                            "min": null,
                            "show": false
                         }
                      ]
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "Distributor - Structured Metadata",
                "titleSize": "h6"
             },
             {
                "collapse": false,
                "height": "250px",
                "panels": [
                   {
                      "aliasColors": {
                         "1xx": "#EAB839",
                         "2xx": "#7EB26D",
                         "3xx": "#6ED0E0",
                         "4xx": "#EF843C",
                         "5xx": "#E24D42",
                         "OK": "#7EB26D",
                         "cancel": "#A9A9A9",
                         "error": "#E24D42",
                         "success": "#7EB26D"
                      },
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 100,
                               "lineWidth": 0,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "normal"
                               }
                            },
                            "min": 0,
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "1xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#EAB839",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "2xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "3xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#6ED0E0",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "4xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#EF843C",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "5xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E24D42",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "OK"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "cancel"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#A9A9A9",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "error"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E24D42",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "success"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            }
                         ]
                      },
                      "fill": 10,
                      "id": 5,
                      "linewidth": 0,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 6,
                      "stack": true,
                      "targets": [
                         {
                            "expr": "sum by (status) (\n  label_replace(label_replace(rate(loki_request_duration_seconds_count{cluster=~\"$cluster\",job=~\"($namespace)/ingester-zone.*\", route=\"/logproto.Pusher/Push\"}[$__rate_interval]),\n  \"status\", \"${1}xx\", \"status_code\", \"([0-9])..\"),\n  \"status\", \"${1}\", \"status_code\", \"([a-zA-Z]+)\"))\n",
                            "format": "time_series",
                            "legendFormat": "{{status}}",
                            "refId": "A"
                         }
                      ],
                      "title": "QPS",
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "ms"
                         },
                         "overrides": [ ]
                      },
                      "id": 6,
                      "links": [ ],
                      "nullPointMode": "null as zero",
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 6,
                      "targets": [
                         {
                            "expr": "histogram_quantile(0.99, sum by (le) (cluster_job_route:loki_request_duration_seconds_bucket:sum_rate{cluster=~\"$cluster\", job=~\"($namespace)/ingester-zone.*\", route=\"/logproto.Pusher/Push\"})) * 1e3",
                            "format": "time_series",
                            "legendFormat": "99th percentile",
                            "refId": "A"
                         },
                         {
                            "expr": "histogram_quantile(0.50, sum by (le) (cluster_job_route:loki_request_duration_seconds_bucket:sum_rate{cluster=~\"$cluster\", job=~\"($namespace)/ingester-zone.*\", route=\"/logproto.Pusher/Push\"})) * 1e3",
                            "format": "time_series",
                            "legendFormat": "50th percentile",
                            "refId": "B"
                         },
                         {
                            "expr": "1e3 * sum(cluster_job_route:loki_request_duration_seconds_sum:sum_rate{cluster=~\"$cluster\", job=~\"($namespace)/ingester-zone.*\", route=\"/logproto.Pusher/Push\"}) / sum(cluster_job_route:loki_request_duration_seconds_count:sum_rate{cluster=~\"$cluster\", job=~\"($namespace)/ingester-zone.*\", route=\"/logproto.Pusher/Push\"})",
                            "format": "time_series",
                            "legendFormat": "Average",
                            "refId": "C"
                         }
                      ],
                      "title": "Latency",
                      "type": "timeseries",
                      "yaxes": [
                         {
                            "format": "ms",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": 0,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": false
                         }
                      ]
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "Ingester - Zone Aware",
                "titleSize": "h6"
             },
             {
                "collapse": false,
                "height": "250px",
                "panels": [
                   {
                      "aliasColors": {
                         "1xx": "#EAB839",
                         "2xx": "#7EB26D",
                         "3xx": "#6ED0E0",
                         "4xx": "#EF843C",
                         "5xx": "#E24D42",
                         "OK": "#7EB26D",
                         "cancel": "#A9A9A9",
                         "error": "#E24D42",
                         "success": "#7EB26D"
                      },
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 100,
                               "lineWidth": 0,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "normal"
                               }
                            },
                            "min": 0,
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "1xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#EAB839",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "2xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "3xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#6ED0E0",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "4xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#EF843C",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "5xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E24D42",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "OK"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "cancel"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#A9A9A9",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "error"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E24D42",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "success"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            }
                         ]
                      },
                      "fill": 10,
                      "id": 7,
                      "linewidth": 0,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 6,
                      "stack": true,
                      "targets": [
                         {
                            "expr": "sum by (status) (\n  label_replace(label_replace(rate(loki_request_duration_seconds_count{cluster=~\"$cluster\",job=~\"($namespace)/ingester\", route=\"/logproto.Pusher/Push\"}[$__rate_interval]),\n  \"status\", \"${1}xx\", \"status_code\", \"([0-9])..\"),\n  \"status\", \"${1}\", \"status_code\", \"([a-zA-Z]+)\"))\n",
                            "format": "time_series",
                            "legendFormat": "{{status}}",
                            "refId": "A"
                         }
                      ],
                      "title": "QPS",
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "ms"
                         },
                         "overrides": [ ]
                      },
                      "id": 8,
                      "links": [ ],
                      "nullPointMode": "null as zero",
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 6,
                      "targets": [
                         {
                            "expr": "histogram_quantile(0.99, sum by (le) (cluster_job_route:loki_request_duration_seconds_bucket:sum_rate{cluster=~\"$cluster\", job=~\"($namespace)/ingester\", route=\"/logproto.Pusher/Push\"})) * 1e3",
                            "format": "time_series",
                            "legendFormat": "99th percentile",
                            "refId": "A"
                         },
                         {
                            "expr": "histogram_quantile(0.50, sum by (le) (cluster_job_route:loki_request_duration_seconds_bucket:sum_rate{cluster=~\"$cluster\", job=~\"($namespace)/ingester\", route=\"/logproto.Pusher/Push\"})) * 1e3",
                            "format": "time_series",
                            "legendFormat": "50th percentile",
                            "refId": "B"
                         },
                         {
                            "expr": "1e3 * sum(cluster_job_route:loki_request_duration_seconds_sum:sum_rate{cluster=~\"$cluster\", job=~\"($namespace)/ingester\", route=\"/logproto.Pusher/Push\"}) / sum(cluster_job_route:loki_request_duration_seconds_count:sum_rate{cluster=~\"$cluster\", job=~\"($namespace)/ingester\", route=\"/logproto.Pusher/Push\"})",
                            "format": "time_series",
                            "legendFormat": "Average",
                            "refId": "C"
                         }
                      ],
                      "title": "Latency",
                      "type": "timeseries",
                      "yaxes": [
                         {
                            "format": "ms",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": 0,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": false
                         }
                      ]
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "Ingester",
                "titleSize": "h6"
             },
             {
                "collapse": false,
                "height": "250px",
                "panels": [
                   {
                      "aliasColors": {
                         "1xx": "#EAB839",
                         "2xx": "#7EB26D",
                         "3xx": "#6ED0E0",
                         "4xx": "#EF843C",
                         "5xx": "#E24D42",
                         "OK": "#7EB26D",
                         "cancel": "#A9A9A9",
                         "error": "#E24D42",
                         "success": "#7EB26D"
                      },
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 100,
                               "lineWidth": 0,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "normal"
                               }
                            },
                            "min": 0,
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "1xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#EAB839",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "2xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "3xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#6ED0E0",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "4xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#EF843C",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "5xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E24D42",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "OK"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "cancel"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#A9A9A9",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "error"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E24D42",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "success"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            }
                         ]
                      },
                      "fill": 10,
                      "id": 9,
                      "linewidth": 0,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 6,
                      "stack": true,
                      "targets": [
                         {
                            "expr": "sum by (status) (\n  label_replace(label_replace(rate(loki_index_request_duration_seconds_count{cluster=~\"$cluster\",job=~\"($namespace)/ingester.*\", operation=\"index_chunk\"}[$__rate_interval]),\n  \"status\", \"${1}xx\", \"status_code\", \"([0-9])..\"),\n  \"status\", \"${1}\", \"status_code\", \"([a-zA-Z]+)\"))\n",
                            "format": "time_series",
                            "legendFormat": "{{status}}",
                            "refId": "A"
                         }
                      ],
                      "title": "QPS",
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "ms"
                         },
                         "overrides": [ ]
                      },
                      "id": 10,
                      "links": [ ],
                      "nullPointMode": "null as zero",
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 6,
                      "targets": [
                         {
                            "expr": "histogram_quantile(0.99, sum(rate(loki_index_request_duration_seconds_bucket{cluster=~\"$cluster\",job=~\"($namespace)/ingester.*\", operation=\"index_chunk\"}[$__rate_interval])) by (le)) * 1e3",
                            "format": "time_series",
                            "legendFormat": "99th Percentile",
                            "refId": "A"
                         },
                         {
                            "expr": "histogram_quantile(0.50, sum(rate(loki_index_request_duration_seconds_bucket{cluster=~\"$cluster\",job=~\"($namespace)/ingester.*\", operation=\"index_chunk\"}[$__rate_interval])) by (le)) * 1e3",
                            "format": "time_series",
                            "legendFormat": "50th Percentile",
                            "refId": "B"
                         },
                         {
                            "expr": "sum(rate(loki_index_request_duration_seconds_sum{cluster=~\"$cluster\",job=~\"($namespace)/ingester.*\", operation=\"index_chunk\"}[$__rate_interval])) * 1e3 / sum(rate(loki_index_request_duration_seconds_count{cluster=~\"$cluster\",job=~\"($namespace)/ingester.*\", operation=\"index_chunk\"}[$__rate_interval]))",
                            "format": "time_series",
                            "legendFormat": "Average",
                            "refId": "C"
                         }
                      ],
                      "title": "Latency",
                      "type": "timeseries",
                      "yaxes": [
                         {
                            "format": "ms",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": 0,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": false
                         }
                      ]
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "Index",
                "titleSize": "h6"
             },
             {
                "collapse": false,
                "height": "250px",
                "panels": [
                   {
                      "aliasColors": {
                         "1xx": "#EAB839",
                         "2xx": "#7EB26D",
                         "3xx": "#6ED0E0",
                         "4xx": "#EF843C",
                         "5xx": "#E24D42",
                         "OK": "#7EB26D",
                         "cancel": "#A9A9A9",
                         "error": "#E24D42",
                         "success": "#7EB26D"
                      },
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 100,
                               "lineWidth": 0,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "normal"
                               }
                            },
                            "min": 0,
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "short"
                         },
                         "overrides": [
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "1xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#EAB839",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "2xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "3xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#6ED0E0",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "4xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#EF843C",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "5xx"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E24D42",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "OK"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "cancel"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#A9A9A9",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "error"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#E24D42",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            },
                            {
                               "matcher": {
                                  "id": "byName",
                                  "options": "success"
                               },
                               "properties": [
                                  {
                                     "id": "color",
                                     "value": {
                                        "fixedColor": "#7EB26D",
                                        "mode": "fixed"
                                     }
                                  }
                               ]
                            }
                         ]
                      },
                      "fill": 10,
                      "id": 11,
                      "linewidth": 0,
                      "links": [ ],
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 6,
                      "stack": true,
                      "targets": [
                         {
                            "expr": "sum by (status) (\n  label_replace(label_replace(rate(loki_boltdb_shipper_request_duration_seconds_count{cluster=~\"$cluster\",job=~\"($namespace)/ingester\", operation=\"WRITE\"}[$__rate_interval]),\n  \"status\", \"${1}xx\", \"status_code\", \"([0-9])..\"),\n  \"status\", \"${1}\", \"status_code\", \"([a-zA-Z]+)\"))\n",
                            "format": "time_series",
                            "legendFormat": "{{status}}",
                            "refId": "A"
                         }
                      ],
                      "title": "QPS",
                      "type": "timeseries"
                   },
                   {
                      "datasource": "$datasource",
                      "fieldConfig": {
                         "defaults": {
                            "custom": {
                               "drawStyle": "line",
                               "fillOpacity": 10,
                               "lineWidth": 1,
                               "pointSize": 5,
                               "showPoints": "never",
                               "spanNulls": false,
                               "stacking": {
                                  "group": "A",
                                  "mode": "none"
                               }
                            },
                            "thresholds": {
                               "mode": "absolute",
                               "steps": [ ]
                            },
                            "unit": "ms"
                         },
                         "overrides": [ ]
                      },
                      "id": 12,
                      "links": [ ],
                      "nullPointMode": "null as zero",
                      "options": {
                         "legend": {
                            "showLegend": true
                         },
                         "tooltip": {
                            "mode": "single",
                            "sort": "none"
                         }
                      },
                      "span": 6,
                      "targets": [
                         {
                            "expr": "histogram_quantile(0.99, sum(rate(loki_boltdb_shipper_request_duration_seconds_bucket{cluster=~\"$cluster\",job=~\"($namespace)/ingester\", operation=\"WRITE\"}[$__rate_interval])) by (le)) * 1e3",
                            "format": "time_series",
                            "legendFormat": "99th Percentile",
                            "refId": "A"
                         },
                         {
                            "expr": "histogram_quantile(0.50, sum(rate(loki_boltdb_shipper_request_duration_seconds_bucket{cluster=~\"$cluster\",job=~\"($namespace)/ingester\", operation=\"WRITE\"}[$__rate_interval])) by (le)) * 1e3",
                            "format": "time_series",
                            "legendFormat": "50th Percentile",
                            "refId": "B"
                         },
                         {
                            "expr": "sum(rate(loki_boltdb_shipper_request_duration_seconds_sum{cluster=~\"$cluster\",job=~\"($namespace)/ingester\", operation=\"WRITE\"}[$__rate_interval])) * 1e3 / sum(rate(loki_boltdb_shipper_request_duration_seconds_count{cluster=~\"$cluster\",job=~\"($namespace)/ingester\", operation=\"WRITE\"}[$__rate_interval]))",
                            "format": "time_series",
                            "legendFormat": "Average",
                            "refId": "C"
                         }
                      ],
                      "title": "Latency",
                      "type": "timeseries",
                      "yaxes": [
                         {
                            "format": "ms",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": 0,
                            "show": true
                         },
                         {
                            "format": "short",
                            "label": null,
                            "logBase": 1,
                            "max": null,
                            "min": null,
                            "show": false
                         }
                      ]
                   }
                ],
                "repeat": null,
                "repeatIteration": null,
                "repeatRowId": null,
                "showTitle": true,
                "title": "BoltDB Shipper",
                "titleSize": "h6"
             }
          ],
          "schemaVersion": 14,
          "style": "dark",
          "tags": [
             "loki"
          ],
          "templating": {
             "list": [
                {
                   "current": {
                      "text": "default",
                      "value": "default"
                   },
                   "hide": 0,
                   "label": "Data source",
                   "name": "datasource",
                   "options": [ ],
                   "query": "prometheus",
                   "refresh": 1,
                   "regex": "",
                   "type": "datasource"
                },
                {
                   "allValue": null,
                   "current": {
                      "text": "prod",
                      "value": "prod"
                   },
                   "datasource": "$datasource",
                   "hide": 0,
                   "includeAll": false,
                   "label": "cluster",
                   "multi": false,
                   "name": "cluster",
                   "options": [ ],
                   "query": "label_values(loki_build_info, cluster)",
                   "refresh": 1,
                   "regex": "",
                   "sort": 2,
                   "tagValuesQuery": "",
                   "tags": [ ],
                   "tagsQuery": "",
                   "type": "query",
                   "useTags": false
                },
                {
                   "allValue": null,
                   "current": {
                      "text": "prod",
                      "value": "prod"
                   },
                   "datasource": "$datasource",
                   "hide": 0,
                   "includeAll": false,
                   "label": "namespace",
                   "multi": false,
                   "name": "namespace",
                   "options": [ ],
                   "query": "label_values(loki_build_info{cluster=~\"$cluster\"}, namespace)",
                   "refresh": 1,
                   "regex": "",
                   "sort": 2,
                   "tagValuesQuery": "",
                   "tags": [ ],
                   "tagsQuery": "",
                   "type": "query",
                   "useTags": false
                }
             ]
          },
          "time": {
             "from": "now-1h",
             "to": "now"
          },
          "timepicker": {
             "refresh_intervals": [
                "5s",
                "10s",
                "30s",
                "1m",
                "5m",
                "15m",
                "30m",
                "1h",
                "2h",
                "1d"
             ],
             "time_options": [
                "5m",
                "15m",
                "1h",
                "6h",
                "12h",
                "24h",
                "2d",
                "7d",
                "30d"
             ]
          },
          "timezone": "utc",
          "title": "Loki / Writes",
          "uid": "writes",
          "version": 0
       }
kind: ConfigMap
metadata:
  annotations:
    grafana_dashboard_folder: /dashboards/Loki Mixin
  labels:
    grafana_dashboard: "1"
  name: loki-writes.json
  namespace: monitoring-system
---
apiVersion: monitoring.coreos.com/v1
kind: PrometheusRule
metadata:
  name: loki-mixin-alerts
  namespace: monitoring-system
spec:
  groups:
  - name: loki_alerts
    rules:
    - alert: LokiRequestErrors
      annotations:
        description: |
          {{ $labels.job }} {{ $labels.route }} is experiencing {{ printf "%.2f" $value }}% errors.
        summary: Loki request error rate is high.
      expr: |
        100 * sum(rate(loki_request_duration_seconds_count{status_code=~"5.."}[2m])) by (namespace, job, route)
          /
        sum(rate(loki_request_duration_seconds_count[2m])) by (namespace, job, route)
          > 10
      for: 15m
      labels:
        severity: critical
    - alert: LokiRequestPanics
      annotations:
        description: |
          {{ $labels.job }} is experiencing {{ printf "%.2f" $value }}% increase of panics.
        summary: Loki requests are causing code panics.
      expr: |
        sum(increase(loki_panic_total[10m])) by (namespace, job) > 0
      labels:
        severity: critical
    - alert: LokiRequestLatency
      annotations:
        description: |
          {{ $labels.job }} {{ $labels.route }} is experiencing {{ printf "%.2f" $value }}s 99th percentile latency.
        summary: Loki request error latency is high.
      expr: |
        cluster_namespace_job_route:loki_request_duration_seconds:99quantile{route!~"(?i).*tail.*|/schedulerpb.SchedulerForQuerier/QuerierLoop"} > 1
      for: 15m
      labels:
        severity: critical
    - alert: LokiTooManyCompactorsRunning
      annotations:
        description: |
          {{ $labels.cluster }} {{ $labels.namespace }} has had {{ printf "%.0f" $value }} compactors running for more than 5m. Only one compactor should run at a time.
        summary: Loki deployment is running more than one compactor.
      expr: |
        sum(loki_boltdb_shipper_compactor_running) by (namespace, cluster) > 1
      for: 5m
      labels:
        severity: warning
---
apiVersion: monitoring.coreos.com/v1
kind: PrometheusRule
metadata:
  name: loki-mixin-rules
  namespace: monitoring-system
spec:
  groups:
  - name: loki_rules
    rules:
    - expr: histogram_quantile(0.99, sum(rate(loki_request_duration_seconds_bucket[1m]))
        by (le, cluster, job))
      record: cluster_job:loki_request_duration_seconds:99quantile
    - expr: histogram_quantile(0.50, sum(rate(loki_request_duration_seconds_bucket[1m]))
        by (le, cluster, job))
      record: cluster_job:loki_request_duration_seconds:50quantile
    - expr: sum(rate(loki_request_duration_seconds_sum[1m])) by (cluster, job) / sum(rate(loki_request_duration_seconds_count[1m]))
        by (cluster, job)
      record: cluster_job:loki_request_duration_seconds:avg
    - expr: sum(rate(loki_request_duration_seconds_bucket[1m])) by (le, cluster, job)
      record: cluster_job:loki_request_duration_seconds_bucket:sum_rate
    - expr: sum(rate(loki_request_duration_seconds_sum[1m])) by (cluster, job)
      record: cluster_job:loki_request_duration_seconds_sum:sum_rate
    - expr: sum(rate(loki_request_duration_seconds_count[1m])) by (cluster, job)
      record: cluster_job:loki_request_duration_seconds_count:sum_rate
    - expr: histogram_quantile(0.99, sum(rate(loki_request_duration_seconds_bucket[1m]))
        by (le, cluster, job, route))
      record: cluster_job_route:loki_request_duration_seconds:99quantile
    - expr: histogram_quantile(0.50, sum(rate(loki_request_duration_seconds_bucket[1m]))
        by (le, cluster, job, route))
      record: cluster_job_route:loki_request_duration_seconds:50quantile
    - expr: sum(rate(loki_request_duration_seconds_sum[1m])) by (cluster, job, route)
        / sum(rate(loki_request_duration_seconds_count[1m])) by (cluster, job, route)
      record: cluster_job_route:loki_request_duration_seconds:avg
    - expr: sum(rate(loki_request_duration_seconds_bucket[1m])) by (le, cluster, job,
        route)
      record: cluster_job_route:loki_request_duration_seconds_bucket:sum_rate
    - expr: sum(rate(loki_request_duration_seconds_sum[1m])) by (cluster, job, route)
      record: cluster_job_route:loki_request_duration_seconds_sum:sum_rate
    - expr: sum(rate(loki_request_duration_seconds_count[1m])) by (cluster, job, route)
      record: cluster_job_route:loki_request_duration_seconds_count:sum_rate
    - expr: histogram_quantile(0.99, sum(rate(loki_request_duration_seconds_bucket[1m]))
        by (le, cluster, namespace, job, route))
      record: cluster_namespace_job_route:loki_request_duration_seconds:99quantile
    - expr: histogram_quantile(0.50, sum(rate(loki_request_duration_seconds_bucket[1m]))
        by (le, cluster, namespace, job, route))
      record: cluster_namespace_job_route:loki_request_duration_seconds:50quantile
    - expr: sum(rate(loki_request_duration_seconds_sum[1m])) by (cluster, namespace,
        job, route) / sum(rate(loki_request_duration_seconds_count[1m])) by (cluster,
        namespace, job, route)
      record: cluster_namespace_job_route:loki_request_duration_seconds:avg
    - expr: sum(rate(loki_request_duration_seconds_bucket[1m])) by (le, cluster, namespace,
        job, route)
      record: cluster_namespace_job_route:loki_request_duration_seconds_bucket:sum_rate
    - expr: sum(rate(loki_request_duration_seconds_sum[1m])) by (cluster, namespace,
        job, route)
      record: cluster_namespace_job_route:loki_request_duration_seconds_sum:sum_rate
    - expr: sum(rate(loki_request_duration_seconds_count[1m])) by (cluster, namespace,
        job, route)
      record: cluster_namespace_job_route:loki_request_duration_seconds_count:sum_rate
